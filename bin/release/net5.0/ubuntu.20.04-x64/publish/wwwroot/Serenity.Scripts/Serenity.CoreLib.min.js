!function(t){"use strict";function e(t,e){for(var n=0,i=t;n<i.length;n++){if(e(i[n]))return!0}return!1}function n(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return n;return-1}function i(t){return"[object Array]"===Object.prototype.toString.call(t)}function r(t,e){for(var n={},i=0,r=t;i<r.length;i++){var o=r[i],a=e(o)||"",l=n[a];l||(l=n[a]=[]),l.push(o)}return n}function o(t,e){for(var n=0,i=t;n<i.length;n++){var r=i[n];if(e(r))return r}}function a(t,e){return String.prototype.endsWith?t.endsWith(e):null!=e&&(!e.length||!(e.length>t.length)&&t.substr(t.length-e.length)==e)}function l(t){return null==t||0===t.length}function u(t){return null==g(t)}function c(t,e,n){if(void 0===n&&(n=" "),t.padStart)return t.padStart(e,n);for(t=t.toString();t.length<e;)t=n+t;return t}function d(t,e){return String.prototype.startsWith?t.startsWith(e):null!=e&&(!e.length||!(e.length>t.length)&&t.substr(0,e.length)===e)}var p=function(t){return t.replace(/\s*$/,"")};function h(t){
return null==t?"":t.replace(new RegExp("^\\s+|\\s+$","g"),"")}function f(t){return null==t||0===t.length?"":h(t)}function g(t){return 0===(t=h(t)).length?null:t}function m(t,e,n){return(t=t||"").split(e).join(n)}function y(t,e){for(var n=t.toString();n.length<e;)n="0"+n;return n}function v(t){var e=C.$table[t];return null==e&&(e=t||""),e}function b(t){return C.$table[t]}var C=function(){function t(t){this.key=t}return t.add=function(e,n){if(e){n=n||"";for(var i=0,r=Object.keys(e);i<r.length;i++){var o=r[i],a=n+o,l=e[o];"object"==typeof l?t.add(l,a+"."):t.$table[a]=l}}},t.prototype.get=function(){var e=t.$table[this.key];return null==e&&(e=this.key||""),e},t.prototype.toString=function(){var e=t.$table[this.key];return null==e&&(e=this.key||""),e},t.$table={},t.empty=new t(""),t.initializeTextClass=function(e,n){for(var i=Object.keys(e).slice(),r=0;r<i.length;r++){var o=i[r],a=e[o];if(a instanceof t){var l=a,s=n+o;t.$table[s]=l.key,e[o]=new t(s)}}},t.getDefault=function(e,n){
var i=t.$table[e];return null==i&&null==(i=n)&&(i=e||""),i},t}(),w=function(t,e){return(w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function _(t,e){function n(){this.constructor=t}w(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function S(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}function k(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function I(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,o=n.call(t),a=[];try{
for(;(void 0===e||e-- >0)&&!(i=o.next()).done;)a.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a}function x(t){return this instanceof x?(this.v=t,this):new x(t)}function T(t){return null!=t}t.__assign=function(){return t.__assign=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},t.__assign.apply(this,arguments)};var F=function(){var t=new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())};function P(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}function O(t,e,n){if(null!=e||null!=n)return P(P(O(t||{}),O(e||{})),O(n||{}));if(!t)return t;var i,r=Array.isArray(t)?[]:{};for(var o in t)i=t[o],r[o]="object"==typeof i?O(i):i;return r}var D,E="undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:null,A={}
;function N(t,e){for(var n=e.split("."),i=0;i<n.length;i++)if(null==(t=t[n[i]]))return null;return t}function B(t,e){var n;if(null==e){if(null!=(n=A[t])||null==E||"Object"===t)return n;e=E}return"function"!=typeof(n=N(e,t))?null:n}function V(t){return t.__typeName||t.name||(t.toString().match(/^\s*function\s*([^\s(]+)/)||[])[1]||"Object"}function M(t){var e=V(t),n=e.indexOf("["),i=e.lastIndexOf(".",n>=0?n:e.length);return i>0?e.substr(i+1):e}function R(t){if(null==t)throw new ht("Cannot get type of null");try{return t.constructor}catch(t){return Object}}function L(t,e){return t===e||e.prototype instanceof t||"function"==typeof t.__isAssignableFrom&&t.__isAssignableFrom(e)}function q(t,e){return null!=t&&("function"==typeof e.__isInstanceOfType?e.__isInstanceOfType(t):L(e,R(t)))}function G(t,e){return q(t,e)?t:null}function z(t,e){if(null==t)return t;if(q(t,e))return t;throw new mt("Cannot cast object to type "+V(e))}function H(t){if(t!==Object&&t.prototype&&!0!==t.__interface){
if(Object.getPrototypeOf)return Object.getPrototypeOf(t.prototype).constructor;var e=t.prototype;if(Object.prototype.hasOwnProperty.call(e,"constructor"))try{var n=e.constructor;return delete e.constructor,e.constructor}finally{e.constructor=n}return e.constructor}return null}function j(t,e,n){var i,r=[];if(n){var o=H(t);if(o)for(var a=j(o,e,!0),l=0;l<a.length;l++){var s=R(a[l]);r.push(a[l])}}var u=null===(i=t.__metadata)||void 0===i?void 0:i.attr;if(null!=u)for(l=0;l<u.length;l++){a=u[l];if(null==e||q(a,e)){s=R(a);for(var c=r.length-1;c>=0;c--)q(r[c],s)&&r.splice(c,1);r.push(a)}}return r}function U(t,e){var n,i=[],r=H(t);r&&(i=U(r,-2&e));var o=null===(n=t.__metadata)||void 0===n?void 0:n.members;if(null!=o)for(var a=0,l=o;a<l.length;a++){var s=l[a];e&s.type&&i.push(s)}return i}function W(t,e){var n,i=e.name,r=et(t);r.members=r.members||[];for(var o=0,a=r.members;o<a.length;o++){var l=a[o];if(l.name==i){n=l;break}}return n?(null!=e.type&&(n.type=e.type),
null!=e.attr&&(n.attr=nt(n.attr,e.attr)),null!=e.getter&&(n.getter=e.getter),null!=e.setter&&(n.setter=e.setter),n):(r.members.push(e),e)}function K(t){var e=[];if(t){var n=function(t,i){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&n(t[r],r);"function"==typeof t&&i.charAt(0).toUpperCase()===i.charAt(0)&&i.charAt(0).toLowerCase()!==i.charAt(0)&&e.push(t)};n(t,"")}else for(var i in A)Object.prototype.hasOwnProperty.call(A,i)&&e.push(A[i]);return e}function Q(t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&delete t[e]}function Y(t,e){if(!t)return e._targets,e;if(!e)return t._targets,t;var n=t._targets?t._targets:[null,t],i=e._targets?e._targets:[null,e];return X(n.concat(i))}function J(t,e,n){for(var i=0;i<t.length;i+=2)if(t[i]===e&&t[i+1]===n)return!0;return!1}!function(t){t.toString=function(t,e){var n,i=t;if(0!==e&&(null===(n=t.__metadata)||void 0===n?void 0:n.enumFlags)){var r=[];for(var o in i)i[o]&e?r.push(o):r.push(null==e?"":e.toString())
;return r.join(" | ")}for(var o in i)if(i[o]===e)return o;return null==e?"":e.toString()},t.getValues=function(t){var e=[],n=t;for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&"number"==typeof n[i]&&e.push(n[i]);return e}}(D||(D={}));var X=function(t){var e=function(){if(2===t.length)return t[1].apply(t[0],arguments);for(var e=t.slice(),n=0;n<e.length;n+=2)J(t,e[n],e[n+1])&&e[n+1].apply(e[n],arguments);return null};return e._targets=t,e},Z=function(t,e){if(!t||t===e)return null;if(!e)return t;var n,i=t._targets,r=null;e._targets?(r=e._targets[0],n=e._targets[1]):n=e;for(var o=0;o<i.length;o+=2)if(i[o]===r&&i[o+1]===n){if(2===i.length)return null;var a=i.slice();return a.splice(o,2),X(a)}return t},tt=function(t){return"function"!=typeof t&&null===t.__interface};function et(t){return Object.hasOwnProperty.call(t,"__metadata")||Object.defineProperty(t,"__metadata",{get:function(){return Object.prototype.hasOwnProperty.call(this,"__metadata$")?this.__metadata$:void 0},
set:function(t){this.__metadata$=t}}),t.__metadata||(t.__metadata=Object.create(null)),t.__metadata}function nt(t,e){return t&&e?(n=t.concat(e)).filter((function(t,e){return n.indexOf(t)===e})):(t||e||[]).slice();var n}function it(t){return null!=t&&null!=t.__interfaces&&t.__interfaces.indexOf(this)>=0}function rt(t,e,n){e&&e.length?(ut(t,e),A[e]=t):t.__typeName&&t.__typeName.length&&(A[t.__typeName]=t),null!=n&&n.length&&(t.__interfaces=nt(t.__interfaces,n))}function ot(t,e,n){rt(t,e,n),t.__interface=!1}function at(t,e){rt(t,e,void 0),t.__interface=null}function lt(t,e,n){rt(t,e,n),t.__interface=!0,t.__isAssignableFrom=it}function st(t,e){var n=et(t);n.attr=n.attr||[],n.attr.push(e)}function ut(t,e){Object.hasOwnProperty.call(t,"__typeName")||Object.defineProperty(t,"__typeName",{get:function(){return Object.prototype.hasOwnProperty.call(this,"__typeName$")?this.__typeName$:void 0},set:function(t){this.__typeName$=t}}),t.__typeName=e}var ct=function(){};function dt(t,e,n){
if(t)for(var i=0,r=Object.keys(t);i<r.length;i++){var o=r[i];if(!(o.charAt(0)<"A"||o.charAt(0)>"Z")&&(!(o.indexOf("$")>=0)&&"prototype"!==o&&Object.prototype.hasOwnProperty.call(t,o))){var a=t[o];if(!($.isArray(a)||t instanceof Date)){var l=typeof a;if("string"!==l&&"number"!==l){if(!a.__typeName&&("function"==typeof a&&"number"!==a.nodeType||void 0!==a.__interface)){if(!a.__interfaces&&a.prototype&&a.prototype.format&&"Formatter"===o.substr(-9)&&(void 0===a.__interface&&(a.__interface=!1),a.__interfaces=[ct]),void 0===a.__interface){var s=H(a);s&&!1===s.__interface&&(a.__interface=!1)}void 0!==a.__interface&&(ut(a,e+o),A[e+o]=a)}n>0&&dt(a,e+o+".",n-1)}}}}}lt(ct,"Serenity.ISlickFormatter");var pt=function(t){function e(e){var n=t.call(this,e)||this;return n.name="Exception",n}return _(e,t),e}(Error),ht=function(t){function e(e){var n=t.call(this,e||"Object is null.")||this;return n.name="NullReferenceException",n}return _(e,t),e}(pt),ft=function(t){function e(e,n){
var i=t.call(this,(n||"Value cannot be null.")+"\nParameter name: "+e)||this;return i.name="ArgumentNullException",i}return _(e,t),e}(pt),gt=function(t){function e(e,n){var i=t.call(this,(null!=n?n:"Value is out of range.")+(e?"\nParameter name: "+e:""))||this;return i.name="ArgumentNullException",i}return _(e,t),e}(pt),mt=function(t){function e(e){var n=t.call(this,e)||this;return n.name="InvalidCastException",n}return _(e,t),e}(pt),yt={timeOut:3e3,showDuration:250,hideDuration:500,extendedTimeOut:500,positionClass:"position-toast toast-top-full-width"};function vt(t){return _t(!0,t=P(P({},yt),t)),t}function bt(t,e,n){toastr.warning(t,e,vt(n))}function Ct(t,e,n){toastr.success(t,e,vt(n))}function wt(t,e,n){toastr.error(t,e,vt(n))}function _t(t,e){if("undefined"!=typeof toastr){var n=toastr.getContainer(e,t);if(n.length&&n.hasClass("position-toast")){var i=$(window.document.body).children(".ui-dialog:visible, .modal.in, .modal.show").last();if(i.length>0){var r=i.position()
;n.addClass("positioned-toast"),n.css({position:"absolute",top:r.top+28+"px",left:r.left+6+"px",width:i.width()-12+"px"})}else n.hasClass("positioned-toast")&&(n.removeClass("positioned-toast"),n.css({position:"",top:"",left:"",width:""}))}}}var St={applicationPath:"/",emailAllowOnlyAscii:!0,responsiveDialogs:!1,bootstrapMessages:!1,rootNamespaces:["Serenity"],notLoggedInHandler:null};if("undefined"!=typeof document){var kt=document.querySelector("link#ApplicationPath");null!=kt&&(St.applicationPath=kt.getAttribute("href"))}function It(t,e,n){$("<option/>").val(e).text(n).appendTo(t)}function xt(t,e){var n=t.attr("id");if(l(n))return $("#"+e);var i=$("#"+n+e);if(i.length>0)return i;if((i=$("#"+n+"_"+e)).length>0)return i;for(;;){var r=n.lastIndexOf("_");if(r<=0)return $("#"+e);if(n=n.substr(0,r),(i=$("#"+n+"_"+e)).length>0)return i}}function Tt(t){switch(t){case"&":return"&amp;";case">":return"&gt;";case"<":return"&lt;";case"'":return"&apos;";case'"':return"&quot;"}return t}
var Ft,Pt,Ot=/[><&'"]/g;function Dt(t){var e=null==t?"":t.toString();return Ot.test(e)?e.replace(Ot,Tt):e}function Et(t){switch(t){case"&":return"&amp;";case">":return"&gt;";case"<":return"&lt;"}return t}function $t(t){var e=null==t?"":t.toString();return new RegExp("[><&]","g").test(e)?e.replace(new RegExp("[><&]","g"),Et):e}function At(){return $("<div/>").appendTo(document.body)}function Nt(t){return t?d(t,"fa-")?"fa "+t:d(t,"glyphicon-")?"glyphicon "+t:t:null}function Bt(t,e,n){var i=P({modal:!0,width:"40%",maxWidth:450,minWidth:180,resizable:!1,open:function(){t.onOpen&&t.onOpen.call(this)},close:function(){$(this).dialog("destroy"),t.onClose&&t.onClose.call(this,t.result)}},t);return i.dialogClass="s-MessageDialog"+(n?" "+n:""),t.buttons&&(i.buttons=t.buttons.map((function(e){var n=jt(e);return n.click=function(n){t.result=e.result,$(this).dialog("close"),e.click&&e.click.call(this,n)},n}))),$("<div>"+e+"</div>").dialog(i)}function Vt(){
return null!=Ft?Ft:Ft=!!($.fn.modal&&$.fn.modal.Constructor&&$.fn.modal.Constructor.VERSION&&"3"==($.fn.modal.Constructor.VERSION+"").charAt(0))}function Mt(){return null!=Pt?Pt:Pt=!("undefined"==typeof bootstrap||bootstrap.Modal&&bootstrap.Modal.VERSION&&"4"==(!bootstrap.Modal.VERSION+"").charAt(0))}"undefined"!=typeof $&&$.fn&&$.fn.button&&$.ui&&$.ui.button&&$.fn.button.noConflict&&($.fn.btn=$.fn.button.noConflict());var Rt,Lt,qt={AlertTitle:"Alert",InformationTitle:"Information",WarningTitle:"Warning",ConfirmationTitle:"Confirm",OkButton:"OK",YesButton:"Yes",NoButton:"No",CancelButton:"Cancel",CloseButton:"Close"};function Gt(t){var e;return null!==(e=b("Dialogs."+t))&&void 0!==e?e:qt[t]}function zt(t,e,n){var i='<button type="button" class="'+(Mt()?"btn-":"")+'close" data-'+(Mt()?"bs-":"")+'dismiss="modal" aria-label="'+Gt("CloseButton")+'">'+(Mt()?"":'<span aria-hidden="true">&times;</span>')+"</button>"
;return'<div class="modal '+n+'" tabindex="-1" role="dialog">\n<div class="modal-dialog" role="document">\n    <div class="modal-content">\n        <div class="modal-header">\n            '+(Vt()?i:"")+'<h5 class="modal-title">'+t+"</h5>"+(Vt()?"":i)+'\n        </div>\n        <div class="modal-body">'+e+'</div>\n        <div class="modal-footer"></div>\n    </div>\n</div>\n</div>'}function Ht(t){var e=null==t.htmlEncode||t.htmlEncode?$t(t.text):t.text,n=Nt(t.icon);return null!=n&&(e='<i class="'+n+"><i>"+(e?" "+e:"")),'<button class="btn '+(t.cssClass?t.cssClass:"")+'"'+(t.hint?' title="'+Dt(t.hint)+'"':"")+">"+e+"</button>"}function jt(t){var e=null==t.htmlEncode||t.htmlEncode?$t(t.text):t.text,n=Nt(t.icon);return null!=n&&(e='<i class="'+n+"><i> "),{text:e,attr:t.cssClass?{class:t.cssClass}:void 0,click:t.click}}function Ut(t,e,n){var i=zt(t.title,e,"s-MessageModal"+(n?" "+n:"")),r=$(i).eq(0).appendTo(document.body);t.onOpen&&r.one("shown.bs.modal",t.onOpen),
r.one("hidden.bs.modal",(function(e){try{t.onClose&&t.onClose(t.result)}finally{r.remove()}}));var o=r.find(".modal-footer");function a(e){var n=this;return $(Ht(e)).appendTo(o).click((function(i){t.result=e.result,r.modal("hide"),e.click&&e.click.call(n,i)}))}if(t.buttons)for(var l=0,s=t.buttons;l<s.length;l++){a(s[l])}r.modal({backdrop:!1,show:!Mt()}),Mt()&&r.modal("show")}function Wt(){return null==Rt&&(Rt=!("undefined"!=typeof $&&($.ui&&$.ui.dialog||$.fn&&$.fn.modal))),Rt}function Kt(t){return!!(!$.ui||!$.ui.dialog||St.bootstrapMessages||t&&t.bootstrap)}function Qt(t,e){var n=null==e||null==e.htmlEncode||e.htmlEncode;return n&&(t=$t(t)),'<div class="message"'+(null==e||null==e.preWrap&&n||e.preWrap?' style="white-space: pre-wrap">':">")+t+"</div>"}function Yt(t,e){var n,i,r;if(Wt())window.alert(t);else{var o=Kt(e);null==(e=P({htmlEncode:!0,okButton:Gt("OkButton"),title:Gt("AlertTitle")},e)).buttons&&(e.buttons=[],(null==e.okButton||e.okButton)&&e.buttons.push({
text:"boolean"==typeof e.okButton?Gt("OkButton"):e.okButton,cssClass:null!==(n=e.okButtonClass)&&void 0!==n?n:o?"btn-danger":void 0,result:"ok"})),t=Qt(t,e),o?Ut(e,t,null!==(i=e.modalClass)&&void 0!==i?i:"s-AlertModal"):Bt(e,t,null!==(r=e.dialogClass)&&void 0!==r?r:"s-AlertDialog")}}function Jt(t,e,n){var i,r,o;if(Wt())window.confirm(t)&&e&&e();else{var a=Kt(n);null==(n=P({htmlEncode:!0,yesButton:Gt("YesButton"),noButton:Gt("NoButton"),title:Gt("ConfirmationTitle")},n)).buttons&&(n.buttons=[],(null==n.yesButton||n.yesButton)&&n.buttons.push({text:"boolean"==typeof n.yesButton?Gt("YesButton"):n.yesButton,cssClass:null!==(i=n.yesButtonClass)&&void 0!==i?i:a?"btn-primary":void 0,result:"yes",click:e}),(null==n.noButton||n.noButton)&&n.buttons.push({text:"boolean"==typeof n.noButton?Gt("NoButton"):n.noButton,cssClass:a?Mt()?"btn-danger":"btn-default":void 0,result:"no",click:n.onNo}),n.cancelButton&&n.buttons.push({text:"boolean"==typeof n.cancelButton?Gt("CancelButton"):n.cancelButton,
cssClass:a?Mt()?"btn-secondary":"btn-default":void 0,result:"cancel",click:n.onCancel})),t=Qt(t,n),a?Ut(n,t,null!==(r=n.modalClass)&&void 0!==r?r:"s-ConfirmModal"):Bt(n,t,null!==(o=n.dialogClass)&&void 0!==o?o:"s-ConfirmDialog")}}function Xt(t){if(Wt())window.alert(t.html);else if(Kt(t))Ut({title:Gt("AlertTitle"),modalClass:"modal-lg",onOpen:function(){(e=$(this).find("iframe").css({border:"none",width:"100%",height:"100%"})[0].contentDocument).open(),e.write(i.html),e.close()}},'<div style="overflow: hidden"><iframe></iframe></div>',"s-IFrameModal");else{var e,n=$('<div style="overflow: hidden"><iframe></iframe></div>'),i=P({autoOpen:!0,modal:!0,width:"60%",height:"400",title:Gt("AlertTitle"),open:function(){(e=n.find("iframe").css({border:"none",width:"100%",height:"100%"})[0].contentDocument).open(),e.write(i.html),e.close()},close:function(){e.open(),e.write(""),e.close(),n.dialog("destroy").html("")}},t);n.dialog(i)}}function Zt(t,e){
if(t.hasClass("s-Panel")&&!t.hasClass("hidden")){var n=$.Event(e);if(n.type="panelbeforeclose",n.target=t[0],t.trigger(n),!n.isDefaultPrevented()){t.addClass("hidden");var i="panel-hidden-"+(t.data("paneluniquename")||(new Date).getTime());$("."+i).removeClass(i).removeClass("panel-hidden"),$(window).triggerHandler("resize"),$(".require-layout:visible").triggerHandler("layout"),(e=$.Event(e)).type="panelclose",e.target=t[0],t.trigger(e)}}}!function(t){t.showServiceError=function(t){var e;null==t?e="??ERROR??":null==(e=t.Message)&&(e=t.Code),Yt(e)},t.runtimeErrorHandler=function(t,e,n,i,r){try{var o=(window.location.host||"").toLowerCase();if(o.indexOf("localhost")<0&&o.indexOf("127.0.0.1")<0)return;if(!window.toastr)return;var a=JSON.stringify(r||{});t="<p></p><p>Message: "+$t(t)+"</p><p>File: "+$t(e)+", Line: "+n+", Column: "+i+("{}"!=a?"</p><p>Error: ":"")+"</p>",window.setTimeout((function(){try{wt(t,"SCRIPT ERROR! See browser console (F12) for details.",{escapeHtml:!1,timeOut:15e3
})}catch(t){}}))}catch(t){}}}(Lt||(Lt={}));var te=0;function ee(t){te>0||($.blockUI?$.blockUI(t):$('<div class="blockUI blockOverlay" style="z-index: 2000; border: none; margin: 0px; padding: 0px; width: 100%; height: 100%; top: 0px; left: 0px; opacity: 0; cursor: wait; position: fixed;"></div>').appendTo(document.body)),te++}function ne(t){(t=P({baseZ:2e3,message:"",overlayCSS:{opacity:"0.0",zIndex:2e3,cursor:"wait"},fadeOut:0},t)).useTimeout?window.setTimeout((function(){ee(t)}),0):ee(t)}function ie(){te>1?te--:(te--,$.unblockUI?$.unblockUI({fadeOut:0}):$(document.body).children(".blockUI.blockOverlay").remove())}function re(t){if($.cookie)return $.cookie(t);t+="=";for(var e=document.cookie.split(/;\s*/),n=e.length-1;n>=0;n--)if(!e[n].indexOf(t))return e[n].replace(t,"")}function oe(t){var e=t.service;return e&&e.length&&"~"!=e.charAt(0)&&"/"!=e.charAt(0)&&e.indexOf("://")<0&&(e=se("~/services/")+e),(t=P({dataType:"json",contentType:"application/json",type:"POST",cache:!1,blockUI:!0,
url:e,data:JSON.stringify(t.request),success:function(e,n,i){try{!e.Error&&t.onSuccess&&t.onSuccess(e)}finally{t.blockUI&&ie(),t.onCleanup&&t.onCleanup()}},error:function(e,n,i){try{if(403===e.status){var r=null;try{r=e.getResponseHeader("Location")}catch(t){r=null}if(r)return void(window.top.location.href=r)}if((e.getResponseHeader("content-type")||"").toLowerCase().indexOf("application/json")>=0){var o=$.parseJSON(e.responseText);if(o&&o.Error)return l=o,void(null!=St.notLoggedInHandler&&l&&l.Error&&"NotLoggedIn"==l.Error.Code&&St.notLoggedInHandler(t,l)||(null==t.onError?Lt.showServiceError(l.Error):t.onError(l)))}var a=e.responseText;a?Xt({html:a}):e.status?500==e.status?Yt("HTTP 500: Connection refused! Check browser console for details."):Yt("HTTP "+e.status+" error! Check browser console for details."):"abort"!=e.statusText&&Yt("An unknown AJAX connection error occurred! Check browser console for details.")}finally{t.blockUI&&ie(),t.onCleanup&&t.onCleanup()}var l}
},t)).blockUI&&ne(null),$.ajax(t)}function ae(t,e,n){null==t.EqualityFilter&&(t.EqualityFilter={}),t.EqualityFilter[e]=n}function le(t){var e=$("<form/>").attr("method","POST").attr("action",t.url?se(t.url):se("~/services/"+t.service)).appendTo(document.body);t.target&&e.attr("target",t.target);var n=$("<div/>").appendTo(e);$("<input/>").attr("type","hidden").attr("name","request").val($.toJSON(t.request)).appendTo(n);var i=re("CSRF-TOKEN");i&&$("<input/>").attr("type","hidden").attr("name","__RequestVerificationToken").appendTo(n).val(i),$("<input/>").attr("type","submit").appendTo(n),e.submit(),window.setTimeout((function(){e.remove()}),0)}function se(t){return t&&"~/"===t.substr(0,2)?St.applicationPath+t.substr(2):t}"undefined"!=typeof $&&$.ajaxSetup&&$.ajaxSetup({beforeSend:function(t,e){if(!e||!e.crossDomain){var n=re("CSRF-TOKEN");n&&t.setRequestHeader("X-CSRF-TOKEN",n)}}});var ue={decimalSeparator:".",groupSeparator:",",decimalDigits:2,negativeSign:"-",positiveSign:"+",
percentSymbol:"%",currencySymbol:"$",dateSeparator:"/",dateOrder:"mdy",dateFormat:"MM/dd/yyyy",dateTimeFormat:"MM/dd/yyyy HH:mm:ss",amDesignator:"AM",pmDesignator:"PM",timeSeparator:":",firstDayOfWeek:0,dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],minimizedDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],shortMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],stringCompare:function(t,e){return t<e?-1:t>e?1:0}};function ce(t){for(var e={},n=0;n<t.length;n++)e[t.charAt(n)]=n+1;return function(t,n){if((t=t||"")==(n=n||""))return 0;for(var i=0,r=Math.min(t.length,n.length);i<r;i++){var o=t.charAt(i),a=n.charAt(i);if(o!==a){var l=e[o],s=e[a];if(null!=l&&null!=s)return l<s?-1:1;var u=o.localeCompare(a);if(0!=u)return u}}
return t.localeCompare(n)}}var de={decimalSeparator:".",groupSeparator:",",dateSeparator:"/",dateOrder:"dmy",dateFormat:"dd/MM/yyyy",dateTimeFormat:"dd/MM/yyyy HH:mm:ss",stringCompare:ce("AaBbCcÇçFfGgĞğHhIıİiJjKkLlMmNnOoÖöPpRrSsŞşTtUuÜüVvYyZz")};!function(){var t;for(t in ue)void 0===de[t]&&Object.prototype.hasOwnProperty.call(ue,t)&&(de[t]=ue[t]);if("undefined"!=typeof $&&null!=(t=g((document.querySelector("script#ScriptCulture")||{}).innerHTML))){var e=$.parseJSON(t);for(t in null!=e.DecimalSeparator&&(de.decimalSeparator=e.DecimalSeparator),null!=e.GroupSeparator&&e.GroupSeparator!=de.decimalSeparator?de.groupSeparator=e.GroupSeparator:de.groupSeparator==de.decimalSeparator&&(de.groupSeparator="."==de.decimalSeparator?",":"."),delete e.groupSeparator,delete e.decimal,e)void 0===de[t]&&Object.prototype.hasOwnProperty.call(e,t)&&(de[t.charAt(0).toLowerCase()+t.substr(1)]=e[t])}}();var pe=de.stringCompare;function he(t,e,n,i){var r=null,o=t.indexOf(e);o>0&&(r=t.substr(o),
t=t.substr(0,o));var a=d(t,i);a&&(t=t.substr(1));var l=3;if(t.length<l)return(a?i:"")+(r?t+r:t);for(var s=t.length,u="",c=!1;!c;){var p=l,h=s-p;if(h<0&&(l+=h,p+=h,h=0,c=!0),!p)break;var f=t.substr(h,p);u=u.length?f+n+u:f,s-=p}return a&&(u="-"+u),r?u+r:u}var fe=/\{\{|\}\}|\{[^\}\{]+\}/g;function ge(t,e,n,i){return t.replace(fe,(function(t){if("{{"===t||"}}"===t)return t.charAt(0);var r=parseInt(t.substr(1),10),o=n[r+i];if(null==o)return"";var a=R(o);if(a==Number||a==Date){var l=null,s=t.indexOf(":");return s>0&&(l=t.substring(s+1,t.length-1)),function(t,e,n){return"number"==typeof t?Ce(t,e,n):"[object Date]"===Object.prototype.toString.call(t)?Ie(t,e,n):t.format(e)}(o,l,e)}return o.toString()}))}function me(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return ge(t,de,arguments,1)}function ye(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return ge(t,e,arguments,2)}var ve=function(t,e,n){var i=Math.pow(10,e||0),r=(t*=i)>0|-(t<0);if(t%1==.5*r){
var o=Math.floor(t);return(o+(n?r>0:o%2*r))/i}return Math.round(t)/i},be=function(t){return null!=t?t>0?Math.floor(t):Math.ceil(t):null};function Ce(t,e,n,i){var r,o,a,l,s,u;if(null==t)return"";var d="string"!=typeof n?null!=n?n:de:{decimalSeparator:n,groupSeparator:null!=i?i:","==n?".":","};if(isNaN(t))return null!==(r=d.nanSymbol)&&void 0!==r?r:de.nanSymbol;if(null==e||0==e.length||"i"==e)return t.toString();var p=null!==(o=d.decimalSeparator)&&void 0!==o?o:de.decimalSeparator;i=null!==(a=null!=i?i:d.groupSeparator)&&void 0!==a?a:de.groupSeparator;var h=null!==(l=d.negativeSign)&&void 0!==l?l:de.negativeSign,f="",g=-1;e.length>1&&(g=parseInt(e.substr(1),10));var m=e.charAt(0);switch(m){case"d":case"D":f=parseInt(Math.abs(t)).toString(),-1!=g&&(f=c(f,g,"0")),t<0&&(f=h+f);break;case"x":case"X":f=parseInt(Math.abs(t)).toString(16),"X"==m&&(f=f.toUpperCase()),-1!=g&&(f=c(f,g,"0"));break;case"e":case"E":f=-1==g?t.toExponential():t.toExponential(g),"E"==m&&(f=f.toUpperCase());break
;case"f":case"F":case"n":case"N":if(-1==g&&(g=null!==(s=d.decimalDigits)&&void 0!==s?s:de.decimalDigits),f=t.toFixed(g).toString(),g&&"."!=p){var y=f.indexOf(".");f=f.substr(0,y)+p+f.substr(y+1)}"n"!=m&&"N"!=m||(f=he(f,p,i,h));break;case"c":case"C":case"p":case"P":if(-1==g&&(g=null!==(u=d.decimalDigits)&&void 0!==u?u:de.decimalDigits),"p"!==m&&"P"!=m||(t*=100),f=Math.abs(t).toFixed(g).toString(),g&&"."!=p){y=f.indexOf(".");f=f.substr(0,y)+p+f.substr(y+1)}f=ye("0",d,f=he(f,p,i,h));break;default:for(var v="",b="",C="",w=!1,_=!1,S=0;S<e.length;S++){if("'"!=(k=e.charAt(S))){if(!_)if("\\"==k){var k=e.charAt(S+1)||"";S++}else if("#"==k||","==k||"."==k||"0"==k){w=!0,b+=k;continue}w?C+=k:v+=k}else _=!_}var I="";if((e=b).indexOf(".")>-1){var x=p,T=e.substring(e.lastIndexOf(".")+1);t=function(t,e){var n=Math.pow(10,e||0),i=(Math.round(t*n)/n).toString();if(e>0){var r=i.indexOf(".");for(-1==r?(i+=".",r=0):r=i.length-(r+1);r<e;)i+="0",r++}return parseFloat(i)}(t,T.length)
;var F=new String((t%1).toFixed(T.length));F=F.substring(F.lastIndexOf(".")+1);for(var P=0;P<T.length;P++)if("#"!=T.charAt(P)||"0"==F.charAt(P)){if("#"==T.charAt(P)&&"0"==F.charAt(P)){if(F.substring(P).match("[1-9]")){x+=F.charAt(P);continue}break}"0"==T.charAt(P)?x+=F.charAt(P):x+=T.charAt(P)}else x+=F.charAt(P);I+=x}else t=Math.round(t);var O=Math.floor(t);t<0&&(O=Math.ceil(t));var D="";D=-1==e.indexOf(".")?e:e.substring(0,e.indexOf("."));var E="";if(0!=O||"#"!=D.substr(D.length-1)){var $=new String(Math.abs(O)),A=9999;-1!=D.lastIndexOf(",")&&(A=D.length-D.lastIndexOf(",")-1);for(var N=0,B=$.length-1;B>-1;B--)E=$.charAt(B)+E,++N==A&&0!=B&&(E=i+E,N=0);if(D.length>E.length){var V=D.indexOf("0");if(-1!=V)for(var M=D.length-V,R=D.length-E.length-1;E.length<M;){var L=D.charAt(R);","==L&&(L=i),E=L+E,R--}}}return E||-1===D.indexOf("0",D.length-1)||(E="0"),I=E+I,t<0&&(I=h+I),I.lastIndexOf(p)==I.length-1&&(I=I.substring(0,I.length-1)),v+I+C}return f}function we(t){t=h(t.toString())
;var e=de.groupSeparator;return t&&t.length&&t.indexOf(e)>0&&(t=t.replace(new RegExp("(\\b\\d{1,3})\\"+e+"(?=\\d{3}(\\D|$))","g"),"$1")),/^[-\+]?\d+$/.test(t)?parseInt(t,10):NaN}function _e(t){if(null==t)return null;if(0==(t=h(t.toString())).length)return null;var e=de.groupSeparator;return t&&t.length&&t.indexOf(e)>0&&(t=t.replace(new RegExp("(\\b\\d{1,3})\\"+e+"(?=\\d{3}(\\D|$))","g"),"$1")),new RegExp("^\\s*([-\\+])?(\\d*)\\"+de.decimalSeparator+"?(\\d*)\\s*$").test(t)?parseFloat(t.toString().replace(de.decimalSeparator,".")):NaN}function Se(t){if(null==t)return null;if("number"==typeof t)return t;if(null==(t=$.trim(t))||!t.length)return null;if(t.length>=15||!/^-?\d+$/.test(t))return t;var e=parseInt(t,10);return isNaN(e)?t:e}var ke=/'.*?[^\\]'|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|\//g;function Ie(t,e,n){var i,r,o,a,l,s,u,d,p,h,f,g,m,y;if(!t)return"";if("string"==typeof t){var v=Ae(t,null==n?null:n.dateOrder);if(!v)return t;y=v}else y=t
;if("i"==e)return y.toString();if("id"==e)return y.toDateString();if("it"==e)return y.toTimeString();if(null==n&&(n=de),null==e||"d"==e)e=null!==(i=n.dateFormat)&&void 0!==i?i:de.dateFormat;else if(1==e.length)switch(e){case"g":e=(null!==(r=n.dateTimeFormat)&&void 0!==r?r:de.dateTimeFormat).replace(":ss","");break;case"G":e=null!==(o=n.dateTimeFormat)&&void 0!==o?o:de.dateTimeFormat;break;case"s":e="yyyy-MM-ddTHH:mm:ss";break;case"d":e=null!==(a=n.dateFormat)&&void 0!==a?a:de.dateFormat;case"t":e=n.dateTimeFormat&&n.dateFormat?n.dateTimeFormat.replace(n.dateFormat+" ",""):"HH:mm";break;case"u":case"U":e="u"==e?"yyyy-MM-ddTHH:mm:ss.fffZ":null!==(l=n.dateTimeFormat)&&void 0!==l?l:de.dateTimeFormat,y=new Date(y.getUTCFullYear(),y.getUTCMonth(),y.getUTCDate(),y.getUTCHours(),y.getUTCMinutes(),y.getUTCSeconds(),y.getUTCMilliseconds())}"%"==e.charAt(0)&&(e=e.substr(1));var b=ke,C=[];for(b.lastIndex=0;;){var w=b.lastIndex,_=b.exec(e);if(C.push(e.slice(w,_?_.index:e.length)),!_)break
;var S=_[0],k=S;switch(S){case"/":k=null!==(s=n.dateSeparator)&&void 0!==s?s:de.dateSeparator;break;case"dddd":k=(null!==(u=n.dayNames)&&void 0!==u?u:de.dayNames)[y.getDay()];break;case"ddd":k=(null!==(d=n.shortDayNames)&&void 0!==d?d:de.shortDayNames)[y.getDay()];break;case"dd":k=c(y.getDate().toString(),2,"0");break;case"d":k=y.getDate();break;case"MMMM":k=(null!==(p=n.monthNames)&&void 0!==p?p:de.monthNames)[y.getMonth()];break;case"MMM":k=(null!==(h=n.shortMonthNames)&&void 0!==h?h:de.shortMonthNames)[y.getMonth()];break;case"MM":k=c(y.getMonth()+1,2,"0");break;case"M":k=y.getMonth()+1;break;case"yyyy":k=c(y.getFullYear(),4,"0");break;case"yy":k=c(y.getFullYear()%100,2,"0");break;case"y":k=y.getFullYear()%100;break;case"h":case"hh":(k=y.getHours()%12)?"hh"==S&&(k=c(k,2,"0")):k="12";break;case"HH":k=c(y.getHours(),2,"0");break;case"H":k=y.getHours();break;case"mm":k=c(y.getMinutes(),2,"0");break;case"m":k=y.getMinutes();break;case"ss":k=c(y.getSeconds().toString(),2,"0");break
;case"s":k=y.getSeconds();break;case"t":case"tt":k=y.getHours()<12?null!==(f=n.amDesignator)&&void 0!==f?f:de.amDesignator:null!==(g=n.pmDesignator)&&void 0!==g?g:de.pmDesignator,"t"==S&&(k=k.charAt(0));break;case"fff":k=c(y.getMilliseconds(),3,"0");break;case"ff":k=c(y.getMilliseconds(),3).substr(0,2);break;case"f":k=c(y.getMilliseconds(),3).charAt(0);break;case"z":case"Z":k=((k=y.getTimezoneOffset()/60)>=0?"-":"+")+Math.floor(Math.abs(k));break;case"zz":case"zzz":k=((k=y.getTimezoneOffset()/60)>=0?"-":"+")+Math.floor(c(Math.abs(k),2,"0")),"zzz"==S&&(k+=(null!==(m=n.timeSeparator)&&void 0!==m?m:de.timeSeparator)+Math.abs(c(y.getTimezoneOffset()%60,2,"0")));break;default:"'"==k.charAt(0)&&(k=k.substr(1,k.length-2).replace(/\\'/g,"'"))}C.push(k)}return C.join("")}function xe(t){if(null==t)return"";var e=function(t){return(t<10?"0":"")+t
},n=t.getUTCFullYear()+"-"+e(t.getUTCMonth()+1)+"-"+e(t.getUTCDate())+"T"+e(t.getUTCHours())+":"+e(t.getUTCMinutes()),i=Number(t.getUTCSeconds()+"."+(t.getUTCMilliseconds()<100?"0":"")+e(t.getUTCMilliseconds()));return n+=":"+e(i)+"Z"}var Te,Fe,Pe,Oe=/(\d{4,})(?:-(\d{1,2})(?:-(\d{1,2})(?:[T ](\d{1,2}):(\d{1,2})(?::(\d{1,2})(?:\.(\d+))?)?(?:(Z)|([+-])(\d{1,2})(?::(\d{1,2}))?)?)?)?)?/;function De(t){if(!t||!t.length)return null;if("string"!=typeof(t+="")||0===t.length)return null;var e=t.match(Oe);return null==e?null:new Date(t+(10==t.length?"T00:00:00":""))}function Ee(t){var e,n,i=h(t);if(i.length<4||i.length>5)return NaN;if(":"==i.charAt(1))e=we(i.substr(0,1)),n=we(i.substr(2,2));else{if(":"!=i.charAt(2))return NaN;e=we(i.substr(0,2)),n=we(i.substr(3,2))}return isNaN(e)||isNaN(n)||e<0||e>23||n<0||n>59?NaN:60*e+n}function $e(t){var e,n=h(t);if(!n)return NaN;var i=n.split(".");if(0==i.length||i.length>2)return NaN;if(1==i.length)return e=we(i[0]),isNaN(e)?Ee(i[0]):24*e*60;e=we(i[0])
;var r=Ee(i[1]);return isNaN(e)||isNaN(r)?NaN:24*e*60+r}function Ae(t,e){if(!t||!t.length)return null;if(t.length>=10&&"-"===t.charAt(4)&&"-"===t.charAt(7)&&(10===t.length||t.length>10&&"T"===t.charAt(10))){var n=De(t);return null!=n&&n}if((t=h(t)).indexOf(" ")>0&&t.indexOf(":")>t.indexOf(" ")+1){var i=Ae(t.substr(0,t.indexOf(" ")));return!!i&&De(Ie(i,"yyyy-MM-dd")+"T"+h(t.substr(t.indexOf(" 1"))))}var r,o,a,l,s;if(!(o=Ne(t)))return!1;if(3==o.length){switch(e=e||de.dateOrder){case"dmy":a=parseInt(o[0],10),l=parseInt(o[1],10)-1,s=parseInt(o[2],10);break;case"ymd":a=parseInt(o[2],10),l=parseInt(o[1],10)-1,s=parseInt(o[0],10);break;case"mdy":default:a=parseInt(o[1],10),l=parseInt(o[0],10)-1,s=parseInt(o[2],10)}if(isNaN(a)||isNaN(l)||isNaN(s)||a<1||a>31||l<0||l>11||s>9999||s<0)return!1;if(s<100){var u=(new Date).getFullYear();s+=u-u%100+(s<=u%100+10?0:-100)}try{if(r=new Date(s,l,a),isNaN(r.getFullYear()))return!1}catch(t){return!1}}else if(1==o.length)try{if(r=new Date(o[0]),
isNaN(r.getFullYear()))return!1}catch(t){return!1}return r}function Ne(t){if((t=h(t)).length)return t.indexOf("/")>=0?t.split("/"):t.indexOf(".")>=0?t.split("."):t.indexOf("-")>=0?t.split("-"):t.indexOf("\\")>=0?t.split("\\"):[t]}function Be(t){return Te.ensure("RemoteData."+t)}function Ve(t){var e="Lookup."+t;if(!Te.canLoad(e)){var n='No lookup with key "'+t+'" is registered. Please make sure you have a [LookupScript("'+t+'")] attribute in server side code on top of a row / custom lookup and  its key is exactly the same.';throw wt(n),new Error(n)}return Te.ensure("Lookup."+t)}function Me(t){return Te.ensureAsync("Lookup."+t)}function Re(t){Te.reload("Lookup."+t)}function Le(t){return Te.ensure("Columns."+t)}function qe(t){return Te.ensure("Form."+t)}function Ge(t){return Te.ensure("Template."+t)}function ze(t){return Te.canLoad(t)}function He(t,e,n){var i,r,o,a,l;function s(){var u=Date.now()-a;u<e&&u>=0?i=setTimeout(s,e-u):(i=null,n||(l=t.apply(o,r),o=r=null))}null==e&&(e=100)
;var u=function(){o=this,r=arguments,a=Date.now();var u=n&&!i;return i||(i=setTimeout(s,e)),u&&(l=t.apply(o,r),o=r=null),l};return u.clear=function(){i&&(clearTimeout(i),i=null)},u.flush=function(){i&&(l=t.apply(o,r),o=r=null,clearTimeout(i),i=null)},u}!function(t){var e={},n={};function i(t){$(document.body).triggerHandler("scriptdatachange",[t])}function r(t,n){return{async:n,cache:!0,type:"GET",url:se("~/DynJS.axd/")+t+".js?"+e[t],data:null,dataType:"text",converters:{"text script":function(t){return t}},success:function(t,e,n){$.globalEval(t)},error:function(e,n,i){var r=d(t,"Lookup.")
;if(403==e.status&&r)wt('<p>Access denied while trying to load the lookup: "<b>'+t.substr(7)+'</b>". Please check if current user has required permissions for this lookup.</p> <p><em>Lookups use the ReadPermission of their row by default. You may override that for the lookup like [LookupScript("Some.Lookup", Permission = "?")] to grant all authenticated users to read it (or use "*" for public).</em></p><p><em>Note that this might be a security risk if the lookup contains sensitive data, so it could be better to set a separate permission for lookups, like "MyModule:Lookups".</em></p>',null,{timeOut:1e4,escapeHtml:!1});else{wt("An error occurred while trying to load "+(r?' the lookup: "'+t.substr(7):' dynamic script: "'+t)+'"!. Please check the error message displayed in the dialog below for more info.');var o=e.responseText;o?Xt({html:o
}):e.status?500==e.status?Yt("HTTP 500: Connection refused! Check browser console for details."):Yt("HTTP "+e.status+" error! Check browser console for details."):Yt("An unknown connection error occurred! Check browser console for details.")}}}}function o(t){if(null==e[t])throw new Error(me("Script data {0} is not found in registered script list!",t));$.ajax(r(t,!1))}function a(t){return Promise.resolve().then((function(){if(null==e[t])throw new Error(me("Script data {0} is not found in registered script list!",t));return function(t){return Promise.resolve().then((function(){return ne(null),Promise.resolve($.ajax(r(t,!0)).always((function(){ie()})))}),null)}(t)}),null)}t.bindToChange=function(t,e,n){$(document.body).bind("scriptdatachange."+e,(function(e,i){i==t&&n()}))},t.triggerChange=i,t.unbindFromChange=function(t){$(document.body).unbind("scriptdatachange."+t)},t.ensure=function(t){var e=n[t];if(null==e&&o(t),null==(e=n[t]))throw new Error(me("Can't load script data: {0}!",t))
;return e},t.ensureAsync=function(t){return Promise.resolve().then((function(){var e=n[t];return null!=e?Promise.resolve(e):a(t).then((function(){if(null==(e=n[t]))throw new Error(me("Can't load script data: {0}!",t));return e}),null)}),null)},t.reload=function(t){if(null==e[t])throw new Error(me("Script data {0} is not found in registered script list!",t));return e[t]=(new Date).getTime().toString(),o(t),n[t]},t.reloadAsync=function(t){return Promise.resolve().then((function(){if(null==e[t])throw new Error(me("Script data {0} is not found in registered script list!",t));return e[t]=(new Date).getTime().toString(),a(t).then((function(){return n[t]}),null)}),null)},t.canLoad=function(t){return null!=n[t]||null!=e[t]},t.setRegisteredScripts=function(t){e={};var n=(new Date).getTime();for(var i in t)e[i]=t[i]||n},t.set=function(t,e){n[t]=e,i(t)}}(Te||(Te={})),function(t){function e(e){if(null==e)return!1;if("*"==e)return!0;if(""==e||"?"==e)return t.isLoggedIn;var n=t.userDefinition
;if(n&&n.IsAdmin)return!0;if(n&&n.Permissions){var i=n.Permissions;if(i[e])return!0;for(var r=0,o=e.split("|");r<o.length;r++){var a=o[r];if(a){var l=a.split("&");if(l.length){for(var s=!1,u=0,c=l;u<c.length;u++){if(!i[c[u]]){s=!0;break}}if(!s)return!0}}}}return!1}t.hasPermission=e,t.validatePermission=function(t){if(!e(t))throw wt(v("Authorization.AccessDenied")),new Error(v("Authorization.AccessDenied"))}}(Fe||(Fe={})),Object.defineProperty(Fe,"userDefinition",{get:function(){return Be("UserData")}}),Object.defineProperty(Fe,"isLoggedIn",{get:function(){var t=Fe.userDefinition;return t&&!!t.Username}}),Object.defineProperty(Fe,"username",{get:function(){var t=Fe.userDefinition;return t?t.Username:null}}),function(t){var e,n=0,i=0,r={};function o(){null==e&&i>0&&(e=window.setTimeout(l,100))}function a(){null!=e&&(window.clearTimeout(e),e=null)}function l(){for(var t in r){var e=r[t];try{var n=e.element();if(!n)continue;var i=n.offsetWidth,l=n.offsetHeight;try{
if((e.width&&e.storedWidth!==i||e.height&&e.storedHeight!==l||!e.width&&!e.height&&(!i!=!e.storedWidth||!l!=!e.storedHeight))&&i>0&&l>0)try{e.handler()}finally{i=n.offsetWidth,l=n.offsetHeight}}finally{e.storedWidth=i,e.storedHeight=l}}catch(t){console.log(t)}}a(),o()}function s(t){var e=r[t];if(e){var n=e.element();n&&(e.storedWidth=n.offsetWidth,e.storedHeight=n.offsetHeight)}}function u(t,e,a,l){if(null==e)throw"Layout handler can't be null!";return r[++n]={element:t,handler:e,width:!1!==a,height:!1!==l},i++,s(n),o(),n}t.store=s,t.trigger=function(t){var e=r[t];e&&(s(t),e.storedWidth>=0&&e.storedHeight>=0&&e.handler(),s(t))},t.onSizeChange=u,t.onWidthChange=function(t,e){return u(t,e,!0,!1)},t.onHeightChange=function(t,e){return u(t,e,!1,!0)},t.onShown=function(t,e){return u(t,e,!1,!1)},t.off=function(t){return r[t]?(delete r[t],--i<=0&&a(),0):0}}(Pe||(Pe={}));var je,Ue,We,Ke=function(){function t(t,e){this.items=[],this.itemById={},t=t||{},this.textFormatter=t.textFormatter,
this.idField=t.idField,this.parentIdField=t.parentIdField,this.textField=t.textField,this.textFormatter=t.textFormatter,null!=e&&this.update(e)}return t.prototype.update=function(t){if(this.items=[],this.itemById={},t)for(var e=0,n=t;e<n.length;e++){var i=n[e];this.items.push(i)}var r=this.idField;if(r)for(var o=0,a=this.items;o<a.length;o++){var l=a[o],s=l[r];null!=s&&(this.itemById[s]=l)}},t.prototype.get_idField=function(){return this.idField},t.prototype.get_parentIdField=function(){return this.parentIdField},t.prototype.get_textField=function(){return this.textField},t.prototype.get_textFormatter=function(){return this.textFormatter},t.prototype.get_itemById=function(){return this.itemById},t.prototype.get_items=function(){return this.items},t}();if("undefined"!=typeof $&&$.validator&&$.validator.methods&&$.validator.addMethod){$.validator.addMethod("customValidate",(function(t,e){var n=this.optional(e);if(null==e||n)return n;var i=$._data(e,"events");if(!i)return!0
;var r=i.customValidate;if(null==r||0===r.length)return!0;for(var o=$(e),a=0;a<r.length;a++)if($.isFunction(r[a].handler)){var l=r[a].handler(o);if(null!=l)return o.data("customValidationMessage",l),!1}return!0}),(function(t,e){return $(e).data("customValidationMessage")})),$.validator.addMethod("dateQ",(function(t,e){var n=this.optional(e);if(n)return n;var i=Ae(t);if(!i)return!1;var r=new Date(i);return r.setHours(0,0,0,0),r.getTime()===i.getTime()})),$.validator.addMethod("dateTimeQ",(function(t,e){var n=this.optional(e);return n||!!Ae(t)})),$.validator.addMethod("hourAndMin",(function(t,e){return this.optional(e)||!isNaN(Ee(t))})),$.validator.addMethod("dayHourAndMin",(function(t,e){return this.optional(e)||!isNaN($e(t))})),$.validator.addMethod("decimalQ",(function(t,e){return this.optional(e)||!isNaN(_e(t))})),$.validator.addMethod("integerQ",(function(t,e){return this.optional(e)||!isNaN(we(t))}));var Qe=$.validator.methods.email,Ye=null
;$.validator.addMethod("email",(function(t,e){
return St.emailAllowOnlyAscii?Qe.call(this,t,e):(null==Ye&&(Ye=new RegExp("^((([a-z]|\\d|[!#\\$%&'\\*\\+\\-\\/=\\?\\^_`{\\|}~]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+(\\.([a-z]|\\d|[!#\\$%&'\\*\\+\\-\\/=\\?\\^_`{\\|}~]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+)*)|((\\x22)((((\\x20|\\x09)*(\\x0d\\x0a))?(\\x20|\\x09)+)?(([\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x7f]|\\x21|[\\x23-\\x5b]|[\\x5d-\\x7e]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(\\\\([\\x01-\\x09\\x0b\\x0c\\x0d-\\x7f]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]))))*(((\\x20|\\x09)*(\\x0d\\x0a))?(\\x20|\\x09)+)?(\\x22)))@((([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.)+(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))$","i")),
Ye.test(t))}));var Je=function(t,e){var n=b("Validation."+e);n?$.validator.messages[t]=n:$.validator.messages[t]||($.validator.messages[t]=e+"?")};Je("required","Required"),Je("email","Email"),Je("minlength","MinLength"),Je("maxlength","MaxLength"),Je("digits","Digits"),Je("range","Range"),Je("xss","Xss"),Je("dateQ","DateInvalid"),Je("decimalQ","Decimal"),Je("integerQ","Integer"),Je("url","Url")}function Xe(t,e){return Vt()?t.attr("data-original-title",e||"").tooltip("fixTitle"):t.attr("title",e||"").tooltip("_fixTitle"),t}function Ze(t){var e=t.dataset.vxHighlight;return e?document.getElementById(e):t.classList.contains("select2-offscreen")&&t.id?document.getElementById("s2id_"+t.id):void 0}function tn(){return{errorClass:"error",ignore:":hidden, .no-validate",ignoreTitle:!0,normalizer:function(t){return $.trim(t)},highlight:function(t,e,n){if("radio"===t.type)this.findByName(t.name).addClass(e).removeClass(n);else{null!=e&&e.length&&t.classList.add(e),
null!=n&&n.length&&t.classList.remove(n);var i=Ze(t);i&&i.classList&&(null!=e&&e.length&&i.classList.add(e),null!=n&&n.length&&i.classList.remove(n))}},unhighlight:function(t,e,n){if("radio"===t.type)this.findByName(t.name).removeClass(e).addClass(n);else{null!=e&&e.length&&t.classList.remove(e),null!=n&&n.length&&t.classList.add(n);var i=Ze(t);i&&i.classList&&(null!=e&&e.length&&i.classList.remove(e),null!=n&&n.length&&i.classList.add(n))}},showErrors:function(){if($.fn.tooltip){var t,e,n,i,r;for(t=0;this.errorList[t];t++)i=null!=(r=Ze((n=this.errorList[t]).element))?$(r):$(n.element),0!=t?Xe(i,"").tooltip("hide"):Xe(i,n.message).tooltip("show");for(t=0,e=this.validElements();e[t];t++)Xe(i=null!=(r=Ze(n.element))?$(r):$(n.element),"").tooltip("hide")}$.validator.prototype.defaultShowErrors.call(this)}}}function en(t,e,n){if(!t.length)return t;if(null==n)throw new pt("rule is null!");return t.addClass("customValidate").bind("customValidate."+e,n),t}function nn(t,e){je.call(this,t,e),
this.errorsFor(t).each((function(t,n){var i=$(n);i.parent(".vx").length&&(i.attr("title",i.text()),e&&i.hasClass("error")&&i.removeClass("checked"))}))}function rn(){var t=$.validator;t=t.prototype,je=t.showLabel,t.showLabel=nn,t.oldfocusInvalid=t.focusInvalid,t.focusInvalid=function(){this.settings.abortHandler&&this.settings.abortHandler(this),this.oldfocusInvalid.call(this)},t.oldstopRequest=t.focusInvalid,t.stopRequest=function(t,e){var n=this.formSubmitted;this.oldfocusInvalid.call(this,[t,e]),!e&&0==this.pendingRequest&&n&&this.settings.abortHandler&&this.settings.abortHandler(this)},t.resetAll=function(){this.submitted={},this.prepareForm(),this.hideErrors(),this.elements().removeClass(this.settings.errorClass)}}function on(t){t.settings.abortHandler=null,t.settings.submitHandler=function(){return!1}}function an(t){var e=tn();return delete e.showErrors,P(P(e,{meta:"v",errorPlacement:function(t,e){var n=null,i=e.attr("data-vx-id");if(i&&(n=(n=$("#"+i)).length?n[0]:null),
null==n)if((n=e.parents("div.field")).length){var r=$("div.vx",n[0]);r.length&&(n=r[0])}else n=e.parent();t.appendTo(n)},submitHandler:function(){return!1},invalidHandler:function(t,e){if(wt(v("Validation.InvalidFormMessage")),$(e.errorList.map((function(t){return t.element}))).closest(".category.collapsed").children(".category-title").each((function(t,e){return $(e).click(),!0})),e.errorList.length){var n=e.errorList[0].element;if(n){var i=$(n).closest(".tab-pane");if(!i.hasClass("active")&&i.parent().hasClass("tab-content")){var r=i.attr("id");r&&$('a[href="#'+r+'"]').click()}if($.fn.tooltip){var o,a=Ze(n);o=a?$(a):$(n),$.fn.tooltip&&o.tooltip({title:e.errorList[0].message,trigger:"manual"}).tooltip("show"),window.setTimeout((function(){o.tooltip(Vt()?"destroy":"dispose")}),1500)}}}},success:function(t){t.addClass("checked")}}),t)}function ln(t){var e=0;return t.parent().children().not(t).each((function(t,n){var i=$(n);i.is(":visible")&&(e+=i.outerHeight(!0))})),
e=t.parent().height()-e,"border-box"!==t.css("box-sizing")&&(e-=t.outerHeight(!0)-t.height()),e}function sn(t){var e=ln(t),n=Math.round(e)+"px";t.css("height")!=n&&t.css("height",n)}function un(){var t=navigator.userAgent.indexOf("Mobi")>=0||window.matchMedia&&window.matchMedia("(max-width: 767px)").matches;"undefined"!=typeof document&&document.documentElement&&(document.documentElement.classList.contains("mobile-device")?t||document.documentElement.classList.remove("mobile-device"):t&&document.documentElement.classList.add("mobile-device"))}$.validator?rn():$((function(){$.validator&&rn()})),function(t){var e,n=0,i=0,r=0,o=0;function a(i,r,o){if(t.enabled&&!(n>0)){i=(i=(i=i||"").replace(/^#/,""))?"#"+i:"";var a,l,s=window.location.href.replace(/#$/,"").replace(/#.*$/,"")+i;if(s!=window.location.href){if(r&&null!=e&&((a=e)==(l=s)||a==l+"#"||l==a+"#"))return o&&h(),e=null,void window.history.back();o&&h(),e=window.location.href,window.location.hash=i}}}function l(t,e){a(t,e,!0)}
function s(e,n){if(t.enabled){var i=window.location.hash||"";"#"==i.charAt(0)&&(i=i.substr(1,i.length-1));var r=i.split("/+/");r.length>1&&(e&&e.length?(r[r.length-1]=e,e=r.join("/+/")):(r.splice(r.length-1,1),e=r.join("/+/"))),l(e,n)}}function u(){return $(".ui-dialog-content:visible, .ui-dialog.panel-hidden>.ui-dialog-content, .s-Panel").toArray().sort((function(t,e){return($(t).data("qrouterorder")||0)-($(e).data("qrouterorder")||0)}))}function c(t,e,n){var i,r=[],o=t.hasClass(".ui-dialog-content")||t.hasClass(".s-Panel"),a=o?t:t.closest(".ui-dialog-content, .s-Panel"),c=n();if(a.length){for(var p=u(),h=p.indexOf(a[0]),f=0;f<=h;f++){var g=$(p[f]).data("qroute");g&&g.length&&r.push(g)}if(!o)if(i=a.attr("id"))i+="_",(m=t.attr("id"))&&d(m,i)&&(c=m.substr(i.length)+"@"+c)}else{var m;!(m=t.attr("id"))||t.hasClass("route-handler")&&$(".route-handler").first().attr("id")==m||(c=m+"@"+c)}r.push(c),e.data("qroute",c),l(r.join("/+/")),
e.bind("dialogclose.qrouter panelclose.qrouter",(function(t){e.data("qroute",null),e.unbind(".qrouter");var n=e.data("qprhash"),i=$(t.target).closest(".s-MessageDialog").length>0||t&&t.originalEvent&&("keydown"==t.originalEvent.type&&27==t.originalEvent.keyCode||$(t.originalEvent.target).hasClass("ui-dialog-titlebar-close")||$(t.originalEvent.target).hasClass("panel-titlebar-close"));null!=n?l(n,i):s("",i)}))}function p(e){var i;if(t.enabled){n++;try{"#"==(e=null!==(i=null!=e?e:window.location.hash)&&void 0!==i?i:"").charAt(0)&&(e=e.substr(1,e.length-1));for(var r=u(),o=e.split("/+/"),a=r.map((function(t){return $(t).data("qroute")})),l=0;l<r.length&&l<o.length&&a[l]==o[l];)l++;for(var s=l;s<r.length;s++){var c=$(r[s]);c.hasClass("ui-dialog-content")?c.dialog("close"):c.hasClass("s-Panel")&&Zt(c)}for(s=l;s<o.length;s++){var d,p=o[s],h=p.split("@");if(2==h.length){var f=s>0?$(r[s-1]):$([]);if(f.length){var g=f.attr("id");g&&(d=$("#"+g+"_"+h[0])).length&&(p=h[1])}
d&&d.length||(d=$("#"+h[0])).length&&(p=h[1])}d&&d.length||(d=s>0?$(r[s-1]):$(".route-handler").first()),d.triggerHandler("handleroute",{handled:!1,route:p,parts:o,index:s})}}finally{n--}}}function h(){r++,o=(new Date).getTime()}t.enabled=!0,t.navigate=a,t.replace=l,t.replaceLast=s,t.dialog=function(e,n,i){t.enabled&&n.on("dialogopen.qrouter panelopen.qrouter",(function(t){c(e,n,i)}))},t.resolve=p,window.addEventListener("hashchange",(function(t,e){if(r>0){if(!((new Date).getTime()-o>1e3))return void r--;r=0}p()}),!1);var f=1;"undefined"!=typeof document&&"undefined"!=typeof $&&$.fn&&$(document).on("dialogopen panelopen",".ui-dialog-content, .s-Panel",(function(e,n){if(t.enabled){var r=$(e.target);if(r.data("qrouterorder",f++),!r.data("qroute")){r.data("qprhash",window.location.hash);var o=$(u).not(r).last();o.length||(o=$("html")),c(o,r,(function(){return"!"+(++i).toString(36)}))}}}))}(Ue||(Ue={})),function(t){t.executeOnceWhenShown=function(t,e){var n=t&&t[0]
;if(n)if(n.offsetWidth>0&&n.offsetHeight>0)e();else var i=Pe.onShown((function(){return n}),(function(){Pe.off(i),e()}))},t.executeEverytimeWhenShown=function(t,e,n){var i=t&&t[0];i&&(n&&i.offsetWidth>0&&i.offsetHeight>0&&e(),Pe.onShown((function(){return i}),(function(){e()})))}}(We||(We={}));var cn="undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:null;function dn(t){We.executeEverytimeWhenShown(t,(function(){t.triggerHandler("layout")}),!0)}function pn(t){t.hasClass("ui-dialog")||(t=t.closest(".ui-dialog")),t.position({at:"center center",of:window});var e=t.position();e.left<0&&t.css("left","0px"),e.top<0&&t.css("top","0px")}un(),$((function(){if(cn&&St.rootNamespaces)for(var t=0,e=St.rootNamespaces;t<e.length;t++){var n=e[t],i=N(cn,n);null!=i&&dt(i,n+".",3)}cn&&$(cn).bind("resize",(function(){un()}))}));var hn={__proto__:null,any:e,count:function(t,e){for(var n=0,i=0,r=t;i<r.length;i++){e(r[i])&&n++}return n},first:function(t,e){
for(var n=0,i=t;n<i.length;n++){var r=i[n];if(e(r))return r}throw new Error("first:No element satisfies the condition.!")},indexOf:n,insert:function(t,e,n){if(t.insert)t.insert(e,n);else{if("[object Array]"!==Object.prototype.toString.call(t))throw new Error("Object does not support insert!");t.splice(e,0,n)}},isArray:i,single:function(t,e){for(var n,i=!1,r=0,o=t;r<o.length;r++){var a=o[r];if(e(a)){if(i)throw new Error("single:sequence contains more than one element.");i=!0,n=a}}if(!i)throw new Error("single:No element satisfies the condition.");return n},toGrouping:r,groupBy:function(t,e){for(var n,i={byKey:Object.create(null),inOrder:[]},r=0;r<t.length;r++){var o=t[r],a=null!==(n=e(o))&&void 0!==n?n:"",l=i.byKey[a];void 0===l?(l={order:i.inOrder.length,key:a,items:[o],start:r},i.byKey[a]=l,i.inOrder.push(l)):l.items.push(o)}return i},tryFirst:o,get Authorization(){return Fe},blockUI:ne,blockUndo:ie,Config:St,debounce:He,isBS3:Vt,isBS5Plus:Mt,bsModalMarkup:zt,dialogButtonToBS:Ht,
dialogButtonToUI:jt,alert:Yt,confirm:Jt,iframeDialog:Xt,information:function(t,e,n){if(Wt())return window.alert(t),void(e&&e());Jt(t,e,P({title:Gt("InformationTitle"),dialogClass:"s-InformationDialog",modalClass:"s-InformationModal",yesButton:Gt("OkButton"),yesButtonClass:"btn-info",noButton:!1},n))},success:function(t,e,n){if(Wt())return window.alert(t),void(e&&e());Jt(t,e,P({title:Gt("SuccessTitle"),dialogClass:"s-SuccessDialog",modalClass:"s-SuccessModal",yesButton:Gt("OkButton"),yesButtonClass:"btn-success",noButton:!1},n))},warning:function(t,e){Yt(t,P({title:Gt("WarningTitle"),dialogClass:"s-WarningDialog",modalClass:"s-WarningModal",okButtonClass:"btn-warning"},e))},closePanel:Zt,get ErrorHandling(){return Lt},Invariant:ue,compareStringFactory:ce,Culture:de,turkishLocaleToUpper:function(t){return t?t.replace(/i/g,"İ").replace(/ı/g,"I").toUpperCase():t},turkishLocaleCompare:pe,format:me,localeFormat:ye,round:ve,trunc:be,formatNumber:Ce,parseInteger:we,parseDecimal:_e,toId:Se,
formatDate:Ie,formatDayHourAndMin:function(t){if(0===t)return"0";if(!t)return"";var e=Math.floor(t/24/60),n="";e>0&&(n+=e.toString());var i=y(Math.floor(t%1440/60),2)+":"+y(t%60,2);return"00:00"!=i&&(e>0&&(n+="."),n+=i),n},formatISODateTimeUTC:xe,parseISODateTime:De,parseHourAndMin:Ee,parseDayHourAndMin:$e,parseDate:Ae,splitDateString:Ne,addOption:It,addEmptyOption:function(t){It(t,"",v("Controls.SelectEditor.EmptyItemText"))},clearOptions:function(t){t.html("")},findElementWithRelativeId:xt,attrEncode:Dt,htmlEncode:$t,jsRender:function(t,e){if(!t||t.indexOf("{{")<0)return t;if(!$.templates||!$.views)throw new pt("Please make sure that jsrender.js is included in the page!");e=e||{};var n=$.templates(t);return $.views.converters({text:v},n),n.render(e)},log:function(t){"undefined"!=typeof console&&console.log&&console.log(t)},newBodyDiv:At,outerHtml:function(t){return $("<i/>").append(t.eq(0).clone()).html()},get LayoutTimer(){return Pe},text:v,dbText:function(t){return function(e){
return v("Db."+t+"."+e)}},prefixedText:function(t){return function(e,n){if(null!=e&&!d(e,"`")){var i=b(e);if(null!=i)return i}if(null!=e&&d(e,"`")&&(e=e.substr(1)),!l(t)){var r=b("function"==typeof n?n(t):t+n);if(null!=r)return r}return e}},tryGetText:b,dbTryText:function(t){return function(e){return v("Db."+t+"."+e)}},proxyTexts:function t(e,n,i){if("undefined"!=typeof window&&window.Proxy)return new window.Proxy(e,{get:function(r,o){var a=i[o];if(null!=a){if("number"==typeof a)return v(n+o);var l=e[o];return null!=l||(e[o]=l=t({},n+o+".",a)),l}},ownKeys:function(t){return Object.keys(i)}});for(var r=0,o=Object.keys(i);r<o.length;r++){var a=o[r];"number"==typeof i[a]?Object.defineProperty(e,a,{get:function(){return v(n+a)}}):e[a]=t({},n+a+".",i[a])}return e},LT:C,Lookup:Ke,defaultNotifyOptions:yt,notifyWarning:bt,notifySuccess:Ct,notifyInfo:function(t,e,n){toastr.info(t,e,vt(n))},notifyError:wt,positionToastContainer:_t,get ScriptData(){return Te},getRemoteData:Be,
getRemoteDataAsync:function(t){return Te.ensureAsync("RemoteData."+t)},getLookup:Ve,getLookupAsync:Me,reloadLookup:Re,reloadLookupAsync:function(t){return Te.reloadAsync("Lookup."+t)},getColumns:Le,getColumnsAsync:function(t){return Te.ensureAsync("Columns."+t)},getForm:qe,getFormAsync:function(t){return Te.ensureAsync("Form."+t)},getTemplate:Ge,getTemplateAsync:function(t){return Te.ensureAsync("Template."+t)},canLoadScriptData:ze,getCookie:re,serviceCall:oe,serviceRequest:function(t,e,n,i){return oe(P({service:t,request:e,onSuccess:n},i))},setEquality:ae,parseQueryString:function(t){for(var e={},n=(void 0===t?location.search.substring(1,location.search.length):t||"").split("&"),i=0;i<n.length;i++){var r=n[i].split("="),o=decodeURIComponent(r[0]);e[o]=r.length>=2?decodeURIComponent(r[1]):o}return e},postToService:le,postToUrl:function(t){var e=$("<form/>").attr("method","POST").attr("action",se(t.url)).appendTo(document.body);t.target&&e.attr("target",t.target)
;var n=$("<div/>").appendTo(e);if(null!=t.params)for(var i in t.params)$("<input/>").attr("type","hidden").attr("name",i).val(t.params[i]).appendTo(n);var r=re("CSRF-TOKEN");r&&$("<input/>").attr("type","hidden").attr("name","__RequestVerificationToken").appendTo(n).val(r),$("<input/>").attr("type","submit").appendTo(n),e.submit(),window.setTimeout((function(){e.remove()}),0)},resolveUrl:se,endsWith:a,isEmptyOrNull:l,isTrimmedEmpty:u,padLeft:c,startsWith:d,toSingleLine:function(t){return m(m(f(t),"\r\n"," "),"\n"," ").trim()},trimEnd:p,trimStart:function(t){return t.replace(/^\s*/,"")},trim:h,trimToEmpty:f,trimToNull:g,replaceAll:m,zeroPad:y,coalesce:function(t,e){return null!=t?t:e},isValue:T,today:F,extend:P,deepClone:O,getNested:N,getType:B,getTypeFullName:V,getTypeName:M,getInstanceType:R,isAssignableFrom:L,isInstanceOfType:q,safeCast:G,cast:z,getBaseType:H,getAttributes:j,getMembers:U,addTypeMember:W,getTypes:K,clearKeys:Q,delegateCombine:Y,get Enum(){return D},delegateRemove:Z,
isEnum:tt,initFormType:function(t,e){for(var n=0;n<e.length-1;n+=2)!function(e,n){Object.defineProperty(t.prototype,e,{get:function(){return this.w(e,n)},enumerable:!0,configurable:!0})}(e[n],e[n+1])},prop:function(t,e,n,i){n=n||"get_"+e,i=i||"set_"+e,Object.defineProperty(t.prototype,e,{get:function(){return this[n]()},set:function(t){return this[i](t)},configurable:!0,enumerable:!0})},registerClass:ot,registerEnum:at,registerInterface:lt,addAttribute:st,setTypeName:ut,ISlickFormatter:ct,initializeTypes:dt,Exception:pt,NullReferenceException:ht,ArgumentNullException:ft,ArgumentOutOfRangeException:gt,InvalidCastException:mt,validatorAbortHandler:on,validateOptions:an,getHighlightTarget:Ze,baseValidateOptions:tn,validateForm:function(t,e){return t.validate(P(tn(),e))},addValidationRule:en,removeValidationRule:function(t,e){return t.unbind("customValidate."+e),t},autoFullHeight:function(t){t.css("height","100%"),dn(t)},initFullHeightGridPage:function(t){
$("body").addClass("full-height-page"),t.addClass("responsive-height");var e=function(){var e=t.parent().hasClass("page-content")||t.parent().is("section.content");e&&t.css("height","1px").css("overflow","hidden"),sn(t),e&&t.css("overflow",""),t.triggerHandler("layout")};$("body").hasClass("has-layout-event")?$("body").bind("layout",e):window.Metronic?window.Metronic.addResizeHandler(e):$(window).resize(e),e(),t.one("remove",(function(){$(window).off("layout",e),$("body").off("layout",e)})),void 0!==Ue&&Ue.resolve&&Ue.resolve()},layoutFillHeightValue:ln,layoutFillHeight:sn,setMobileDeviceMode:un,triggerLayoutOnShow:dn,centerDialog:pn,get Router(){return Ue}};function fn(t){return function(e){return ot(e,"Serenity."+t+"Attribute")}}var gn=function(){function t(t){this.value=t}return t=S([fn("EnumKey")],t)}(),mn=function(){function t(t){this.displayName=t}return t=S([fn("DisplayName")],t)}(),yn=function(){function t(t){this.category=t}return t=S([fn("Category")],t)}(),vn=function(){
function t(t){this.value=t}return t=S([fn("ColumnsKey")],t)}(),bn=function(){function t(t){this.cssClass=t}return t=S([fn("CssClass")],t)}(),Cn=function(){function t(t){this.value=t}return t=S([fn("DefaultValue")],t)}(),wn=function(){function t(t){this.value=t}return t=S([fn("DialogType")],t)}(),_n=function(){function t(){}return t=S([fn("Editor")],t)}(),Sn=function(){function t(t,e){this.key=t,this.value=e}return t=S([fn("EditorOption")],t)}(),kn=function(){function t(t){this.editorType=t}return t.prototype.setParams=function(t){},t}();ot(kn,"Serenity.EditorTypeAttributeBase");var In,xn=function(t){function e(e){return t.call(this,e)||this}return _(e,t),e=S([fn("EditorType")],e)}(kn),Tn=function(){function t(t){this.value=t}return t=S([fn("Element")],t)}(),Fn=function(){function t(t){this.value=t}return t=S([fn("EntityType")],t)}(),Pn=function(){function t(t){void 0===t&&(t=!0),this.value=t}return t=S([fn("Filterable")],t)}(),On=function(){function t(t){void 0===t&&(t=!0),this.value=t
}return t=S([fn("Flexify")],t)}(),Dn=function(){function t(t){this.value=t}return t=S([fn("FormKey")],t)}(),En=function(){function t(t){this.origin=t}return t=S([fn("GeneratedCode")],t)}(),$n=function(){function t(){}return t=S([fn("Hidden")],t)}(),An=function(){function t(t){this.hint=t}return t=S([fn("Hint")],t)}(),Nn=function(){function t(t){this.value=t}return t=S([fn("IdProperty")],t)}(),Bn=function(){function t(t){void 0===t&&(t=!0),this.value=t}return t=S([fn("Insertable")],t)}(),Vn=function(){function t(t){this.value=t}return t=S([fn("IsActiveProperty")],t)}(),Mn=function(){function t(t){this.value=t}return t=S([fn("ItemName")],t)}(),Rn=function(){function t(t){this.value=t}return t=S([fn("LocalTextPrefix")],t)}(),Ln=function(){function t(t){void 0===t&&(t=!0),this.value=t}return t=S([fn("Maximizable")],t)}(),qn=function(){function t(t){this.maxLength=t}return t=S([fn("MaxLength")],t)}(),Gn=function(){function t(t){this.value=t}return t=S([fn("NameProperty")],t)
}(),zn=function(){function t(){}return t=S([fn("OneWay")],t)}(),Hn=function(){function t(){}return t=S([fn("Option")],t)}(),jn=function(){function t(t){this.value=t}return t=S([fn("OptionsType")],t)}(),Un=function(){function t(t){void 0===t&&(t=!0),this.value=t}return t=S([fn("Panel")],t)}(),Wn=function(){function t(t){this.value=t}return t=S([fn("Placeholder")],t)}(),Kn=function(){function t(t){void 0===t&&(t=!0),this.value=t}return t=S([fn("ReadOnly")],t)}(),Qn=function(){function t(t){void 0===t&&(t=!0),this.isRequired=t}return t=S([fn("Required")],t)}(),Yn=function(){function t(t){void 0===t&&(t=!0),this.value=t}return t=S([fn("Resizable")],t)}(),Jn=function(){function t(t){void 0===t&&(t=!0),this.value=t}return t=S([fn("Responsive")],t)}(),Xn=function(){function t(t){this.value=t}return t=S([fn("Service")],t)}(),Zn=function(){function t(t){void 0===t&&(t=!0),this.value=t}return t=S([fn("Updatable")],t)}();!function(t){function e(t,e){return function(n){
"string"==typeof t?ot(n,t,e):ot(n,null,t)}}function n(t,e,n){at(t,n),e&&st(t,new gn(e))}var i;t.registerClass=e,t.registerInterface=function(t,e){return function(n){"string"==typeof t?lt(n,t,e):lt(n,null,t)}},t.registerEditor=function(t,n){return e(t,n)},t.registerEnum=n,t.registerEnumType=function(t,e,i){n(t,null!=i?i:e,e)},t.registerFormatter=function(t,n){return void 0===t&&(t=[ct]),void 0===n&&(n=[ct]),e(t,n)},t.enumKey=function(t){return function(e){st(e,new gn(t))}},function(t){t[t.Disabled=-1]="Disabled",t[t.None=0]="None",t[t.Sum=1]="Sum",t[t.Avg=2]="Avg",t[t.Min=3]="Min",t[t.Max=4]="Max"}(i||(i={})),n(i,"Serenity.SummaryType"),t.option=function(){return function(t,e){var n=d(e,"get_")||d(e,"set_"),i=n?e.substr(4):e;W(t.constructor,{name:i,attr:[new Hn],type:n?16:4,getter:n?"get_"+i:null,setter:n?"set_"+i:null})}},t.dialogType=function(t){return function(e){st(e,new wn(t))}},t.editor=function(t){return function(e){var n=new _n;void 0!==t&&(n.key=t),st(e,n)}},
t.element=function(t){return function(e){st(e,new Tn(t))}},t.filterable=function(t){return void 0===t&&(t=!0),function(e){st(e,new Pn(t))}},t.flexify=function(t){return void 0===t&&(t=!0),function(e){st(e,new On(t))}},t.itemName=function(t){return function(e){st(e,new Mn(t))}},t.maximizable=function(t){return void 0===t&&(t=!0),function(e){st(e,new Ln(t))}},t.optionsType=function(t){return function(e){st(e,new jn(t))}},t.panel=function(t){return void 0===t&&(t=!0),function(e){st(e,new Un(t))}},t.resizable=function(t){return void 0===t&&(t=!0),function(e){st(e,new Yn(t))}},t.responsive=function(t){return void 0===t&&(t=!0),function(e){st(e,new Jn(t))}},t.service=function(t){return function(e){st(e,new Xn(t))}}}(In||(In={}));var ti,ei,ni=function(){function t(){}return t=S([In.registerInterface()],t)}(),ii=function(){function t(){}return t=S([In.registerInterface()],t)}(),ri=function(){function t(){}return t=S([In.registerInterface("Serenity.IDialog")],t)}(),oi=function(){function t(){}
return t=S([In.registerInterface("Serenity.IEditDialog")],t)}(),ai=function(){function t(){}return t=S([In.registerInterface()],t)}(),li=function(){function t(){}return t=S([In.registerInterface("Serenity.IReadOnly")],t)}(),si=function(){function t(){}return t=S([In.registerInterface()],t)}(),ui=function(){function t(){}return t=S([In.registerInterface()],t)}(),ci=function(){function t(){}return t=S([In.registerInterface("Serenity.IValidateRequired")],t)}();function di(t){return[t]}!function(t){var e=t;function n(t,n,i){return e.isEmpty(t)?i:e.isEmpty(i)?t:[t,n,i]}t.isEmpty=function(t){return null==t||0===t.length||1===t.length&&"string"==typeof t[0]&&0===t[0].length},t.join=n,t.paren=function(t){return e.isEmpty(t)?t:["()",t]},t.and=function(t,e){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];var o=n(t,"and",e);if(i)for(var a=0,l=i;a<l.length;a++){var s=l[a];o=n(o,"and",s)}return o},t.or=function(t,e){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r]
;var o=n(t,"or",e);if(i)for(var a=0,l=i;a<l.length;a++){var s=l[a];o=n(o,"or",s)}return o}}(di||(di={})),function(t){function e(t){if(l(t))return t;if("ID"===t)return"id";for(var e=!1,n=0,i=0;i<t.length;i++){if(!(t.charCodeAt(i)>=65&&t.charCodeAt(i)<=90)){e=!0;break}n++}return!e&&1!==t.length||0===n?t:n>1?t.substr(0,n-1).toLowerCase()+t.substr(n-1):1===t.length?t.toLowerCase():t.substr(0,1).toLowerCase()+t.substr(1)}t.getPropertyValue=function(t,n){var i=t,r=i["get_"+n];if(void 0!==r)return r.apply(t);var o=e(n);return void 0!==(r=i["get_"+o])?r.apply(t):i[o]},t.setPropertyValue=function(t,n,i){var r=t,o=r["set_"+n];if(void 0===o){var a=e(n);void 0===(o=r["set_"+a])?r[a]=i:o.apply(t,[i])}else o.apply(t,[i])},t.makeCamelCase=e}(ti||(ti={})),function(t){function e(t){var e=B(t);if(null!=e&&L(ri,e))return e;for(var n=0,i=St.rootNamespaces;n<i.length;n++){if(null!=(e=B(i[n]+"."+t))&&L(ri,e))return e}return null}var n={};function i(t){if(null==n[t]){var i=t,r=e(i)
;return null!=r||a(t,"Dialog")||(r=e(i=t+"Dialog")),null==r?null:(n[t]=r,r)}return n[t]}t.tryGet=i,t.get=function(t){var e=i(t);if(null==e){var n=t+" dialog class is not found! Make sure there is a dialog class with this name, it is under your project root namespace, and your namespace parts start with capital letters, e.g. MyProject.Pascal.Cased namespace. If you got this error from an editor with InplaceAdd option check that lookup key and dialog type name matches (case sensitive, excluding Dialog suffix). You need to change lookup key or specify DialogType property in LookupEditor attribute if that's not the case.";throw wt(n,"",null),new pt(n)}return e}}(ei||(ei={}));var pi,hi,fi,gi="undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:null;!function(t){function e(t,e){var n="editor";if(a(t,n)){var i=t.substr(0,t.length-n.length);l(i)||null==pi[i]&&(pi[i]=pi[t])}}t.get=function(t){var n;if(l(t))throw new ft("key");!function(){
if(null!=pi)return;pi={};for(var t=0,n=K();t<n.length;t++){var i=n[t],r=V(i).toLowerCase();pi[r]=i;var o=j(i,_n,!1);if(null!=o&&o.length>0){var a=o[0].key;l(a)||(pi[a.toLowerCase()]=i)}for(var s=0,u=St.rootNamespaces;s<u.length;s++){var c=u[s];if(d(r,c.toLowerCase()+".")){var p=r.substr(c.length+1).toLowerCase();null==pi[p]&&(pi[p]=i)}}}!function(){for(var t=Object.keys(pi),n=0,i=t;n<i.length;n++){var r=i[n];e(r,pi[r])}}()}();var i=pi[t.toLowerCase()];if(null==i){var r=null!==(n=B(t))&&void 0!==n?n:B(t,gi);if(null!=r)return pi[t.toLowerCase()]=r,r;throw new pt(me("Can't find {0} editor type!",t))}return i},t.reset=function(){pi=null}}(hi||(hi={})),function(t){var e;t.tryGet=function(t){if(null==e){e={};for(var n=0,i=K();n<i.length;n++){var r=i[n];if(tt(r)){var o=V(r);e[o]=r;var a=j(r,gn,!1);null!=a&&a.length>0&&(e[a[0].value]=r);for(var l=0,s=St.rootNamespaces;l<s.length;l++){var u=s[l];d(o,u+".")&&(e[o.substr(u.length+1)]=r)}}}}return null==e[t]?null:e[t]},t.get=function(e){
var n=t.tryGet(e);if(null==n){var i=me("Can't find {0} enum type! If you have recently defined this enum type in server side code, make sure your project builds successfully and transform T4 templates. Also make sure that enum is under your project root namespace, and your namespace parts starts with capital letters, e.g.MyProject.Pascal.Cased namespace",e);throw wt(i,"",null),new pt(i)}return n}}(fi||(fi={}));var mi=function(){function t(t){this.idPrefix=t}return t.prototype.byId=function(t){return $("#"+this.idPrefix+t)},t.prototype.w=function(t,e){return $("#"+this.idPrefix+t).getWidget(e)},t}();function yi(){var t,e,n="undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:null;"undefined"==typeof React&&void 0!==n&&(null!=n.preact?(n.React=n.ReactDOM=n.preact,React.Fragment=null!==(t=React.Fragment)&&void 0!==t?t:"x-fragment"):null!=n.Nerv?(n.React=n.ReactDOM=n.Nerv,
React.Fragment=null!==(e=React.Fragment)&&void 0!==e?e:"x-fragment"):(n.React={Component:function(){},Fragment:"x-fragment",createElement:function(){return{_reactNotLoaded:!0}}},n.ReactDOM={render:function(){throw Error("To use React, it should be included before Serenity.CoreLib.js")}}))}yi();var vi=function(t){function e(e,i){var r=t.call(this,i)||this;if(r.element=e,r.options=i||{},r.widgetName=n.getWidgetName(R(r)),r.uniqueName=r.widgetName+(n.nextWidgetNumber++).toString(),e.data(r.widgetName))throw new pt(me("The element already has widget '{0}'!",r.widgetName));return e.on("remove."+r.widgetName,(function(t){t.bubbles||t.cancelable||r.destroy()})).data(r.widgetName,r),r.addCssClass(),r}var n;return _(e,t),n=e,e.prototype.destroy=function(){this.element&&(this.element.removeClass("s-"+M(R(this))),this.element.off("."+this.widgetName).off("."+this.uniqueName).removeData(this.widgetName),this.element=null)},e.prototype.addCssClass=function(){
this.element.addClass(this.getCssClass())},e.prototype.getCssClass=function(){var t=R(this),e=[],n=m(V(t),".","-");e.push(n);for(var i=0,r=St.rootNamespaces;i<r.length;i++){var o=r[i];if(d(n,o+"-")){e.push(n.substr(o.length+1));break}}return e.push(M(t)),e.filter((function(t,e,n){return n.indexOf(t)===e})).map((function(t){return"s-"+t})).join(" ")},e.getWidgetName=function(t){return m(V(t),".","_")},e.elementFor=function(t){var e=j(t,Tn,!0),n=e.length>0?e[0].value:"<input/>";return $(n)},e.prototype.addValidationRule=function(t,e){return en(this.element,t,e)},e.prototype.getGridField=function(){return this.element.closest(".field")},e.prototype.change=function(t){this.element.on("change."+this.uniqueName,t)},e.prototype.changeSelect2=function(t){this.element.on("change."+this.uniqueName,(function(e,n){!0!==n&&t(e)}))},e.create=function(t){var e;if(L(ri,t.type))e=new t.type(t.options),t.container&&e.element.appendTo(t.container),t.element&&t.element(e.element);else{
var i=n.elementFor(t.type);t.container&&i.appendTo(t.container),t.element&&t.element(i),e=new t.type(i,t.options)}return e.init(null),t.init&&t.init(e),e},e.prototype.initialize=function(){},e.prototype.init=function(t){return t&&t(this),this},e.nextWidgetNumber=0,e.__isWidgetType=!0,e=n=S([In.registerClass()],e)}(React.Component);"undefined"!=typeof $&&$.fn&&($.fn.tryGetWidget=function(t){var e;if(L(vi,t)){var n=vi.getWidgetName(t);if(null==(e=this.data(n))||L(t,R(e))||(e=null),null!=e)return e}var i=this.data();if(null==i)return null;for(var r=0,o=Object.keys(i);r<o.length;r++){if(null!=(e=i[o[r]])&&L(t,R(e)))return e}return null},$.fn.getWidget=function(t){if(null==this)throw new ft("element");if(0===this.length)throw new pt(me("Searching for widget of type '{0}' on a non-existent element! ({1})",V(t),this.selector));var e=this.tryGetWidget(t);if(null==e){
var n=me("Element has no widget of type '{0}'! If you have recently changed editor type of a property in a form class, or changed data type in row (which also changes editor type) your script side Form definition might be out of date. Make sure your project builds successfully and transform T4 templates",V(t));throw wt(n,"",null),new pt(n)}return e});var bi,Ci,wi=function(t){function e(e,n){var i=t.call(this,e,n)||this;i.idPrefix=i.uniqueName+"_";for(var r=i.getTemplate().replace(new RegExp("~_","g"),i.idPrefix),o=0;;){var a=r.indexOf('{{text:"',o);if(a<0)break;if((o=r.indexOf('"}}',a))<0)break;var l=v(r.substr(a+8,o-a-8));r=r.substr(0,a)+l+r.substr(o+3),o=a+l.length}return i.element.html(r),i}var n;return _(e,t),n=e,e.prototype.byId=function(t){return $("#"+this.idPrefix+t)},e.prototype.byID=function(t,e){return this.byId(t).getWidget(e)},e.noGeneric=function(t){var e=t.indexOf("$");return e>=0?t.substr(0,e):t},e.prototype.getDefaultTemplateName=function(){
return n.noGeneric(M(R(this)))},e.prototype.getTemplateName=function(){var t=R(this),e=V(t),i=n.templateNames,r=n.templateNames[e];if(null!=r)return r;for(;t&&t!==vi;){for(var o=n.noGeneric(V(t)),a=0,l=St.rootNamespaces;a<l.length;a++){var s=l[a];if(d(o,s+".")){o=o.substr(s.length+1);break}}if(ze("Template."+o))return i[e]=o,o;if(ze("Template."+(o=m(o,".","_")))||$("script#Template_"+o).length>0)return i[e]=o,o;if(ze("Template."+(o=n.noGeneric(M(t))))||$("script#Template_"+o).length>0)return n.templateNames[e]=o,o;t=H(t)}return i[e]=r=this.getDefaultTemplateName(),r},e.prototype.getFallbackTemplate=function(){return null},e.prototype.getTemplate=function(){var t,e=this.getTemplateName(),n=$("script#Template_"+e);if(n.length>0)return n.html();if(!ze("Template."+e)&&this.getDefaultTemplateName()==e&&null!=(t=this.getFallbackTemplate()))return t;if(null==(t=Ge(e)))throw new Error(me("Can't locate template for widget '{0}' with name '{1}'!",M(R(this)),e));return t},e.templateNames={},
e=n=S([In.registerClass("Serenity.TemplatedWidget")],e)}(vi);!function(t){function e(t,e,n,i){var r=e.widgetName;return t.element.bind("ondatachange."+r,(function(t,e){i?window.setTimeout((function(){n(t,e)}),0):n(t,e)})).bind("remove."+r,(function(){t.element.unbind("ondatachange."+r)})),t}function n(t){return{my:"left top",at:"left+20 top+20",of:t[0]}}t.bindToDataChange=e,t.triggerDataChange=function(t){return t.element.triggerHandler("ondatachange"),t},t.triggerDataChanged=function(t){return t.triggerHandler("ondatachange"),t},t.bubbleDataChange=function(t,n,i){return e(t,n,(function(t,e){n.element.triggerHandler("ondatachange")}),i)},t.cascade=function(t,e){return t.element.one("dialogopen",(function(i){t.element.dialog().dialog("option","position",n(e))})),t},t.cascadedDialogOffset=n}(bi||(bi={})),function(t){function e(t){var e=.01*ve(100*t/1024),n="KB";e>=1024&&(e=.01*ve(100*e/1024),n="MB");var i=e.toString().split(String.fromCharCode(46))
;return(i.length>1?i[0]+"."+i[1].substr(0,2):i[0])+" "+n}function n(t){return!l(t)&&(a(t=t.toLowerCase(),".jpg")||a(t,".jpeg")||a(t,".gif")||a(t,".png"))}function i(t){var e=(t=null!=t?t:"").lastIndexOf(".");return e>=0&&(t=t.substr(0,e)),t+"_t.jpg"}function r(t){return t=m(null!=t?t:"","\\","/"),se("~/upload/")+t}function o(t,e){t.colorbox({current:v("Controls.ImageUpload.ColorboxCurrent"),previous:v("Controls.ImageUpload.ColorboxPrior"),next:v("Controls.ImageUpload.ColorboxNext"),close:v("Controls.ImageUpload.ColorboxClose")})}t.addUploadInput=function(t){t.container.addClass("fileinput-button");var e=$("<input/>").attr("type","file").attr("name",t.inputName+"[]").attr("data-url",se("~/File/TemporaryUpload")).attr("multiple","multiple").appendTo(t.container);return t.allowMultiple&&e.attr("multiple","multiple"),e.fileupload({dataType:"json",dropZone:t.zone,pasteZone:t.zone,done:function(e,n){var i=n.result;i.Error?wt(i.Error.Message):null!=t.fileDone&&t.fileDone(i,n.files[0].name,n)
},fail:function(t,e){var n,i=null===(n=null==e?void 0:e._response)||void 0===n?void 0:n.jqXHR;if(i){if((i.getResponseHeader("content-type")||"").toLowerCase().indexOf("application/json")>=0){var r=$.parseJSON(i.responseText);if(r&&r.Error&&r.Error.Message)return void wt(r.Error.Message)}var o=i.responseText;o?Xt({html:o}):i.status?500!=i.status?wt("HTTP "+i.status+" error! Check browser console for details."):wt("HTTP 500: Connection refused! Check browser console for details."):"abort"!=i.statusText&&wt("An unknown connection error occurred! Check browser console for details.")}else wt("An error occurred during file upload.")},start:function(){ne(null),null!=t.progress&&t.progress.show()},stop:function(){ie(),null!=t.progress&&t.progress.hide()},progress:function(e,n){if(null!=t.progress){var i=n.loaded/n.total*100;t.progress.children().css("width",i.toString()+"%")}}}),e},t.checkImageConstraints=function(t,n){
return t.IsImage||n.allowNonImage?n.minSize>0&&t.Size<n.minSize?(alert(me(v("Controls.ImageUpload.UploadFileTooSmall"),e(n.minSize))),!1):n.maxSize>0&&t.Size>n.maxSize?(alert(me(v("Controls.ImageUpload.UploadFileTooBig"),e(n.maxSize))),!1):!t.IsImage||(n.minWidth>0&&t.Width<n.minWidth?(alert(me(v("Controls.ImageUpload.MinWidth"),n.minWidth)),!1):n.maxWidth>0&&t.Width>n.maxWidth?(alert(me(v("Controls.ImageUpload.MaxWidth"),n.maxWidth)),!1):n.minHeight>0&&t.Height<n.minHeight?(alert(me(v("Controls.ImageUpload.MinHeight"),n.minHeight)),!1):!(n.maxHeight>0&&t.Height>n.maxHeight)||(alert(me(v("Controls.ImageUpload.MaxHeight"),n.maxHeight)),!1)):(alert(v("Controls.ImageUpload.NotAnImageFile")),!1)},t.fileNameSizeDisplay=function(t,n){return t+" ("+e(n)+")"},t.fileSizeDisplay=e,t.hasImageExtension=n,t.thumbFileName=i,t.dbFileUrl=r,t.colorBox=o,t.populateFileSymbols=function(t,e,a,s){var u;e=e||[],t.html("");for(var c=0;c<e.length;c++){
var p=e[c],h=$("<li/>").addClass("file-item").data("index",c),f=n(p.Filename);f?h.addClass("file-image"):h.addClass("file-binary");var g=$("<a/>").addClass("thumb").appendTo(h),m=null!==(u=p.OriginalName)&&void 0!==u?u:"",y=p.Filename;null==s||null==y||d(y,"temporary/")||(y=s+y),g.attr("href",r(y)),g.attr("target","_blank"),l(m)||g.attr("title",m),f&&(g.css("backgroundImage","url('"+r(i(p.Filename))+"')"),o(g)),a&&$("<div/>").addClass("filename").text(m).attr("title",m).appendTo(h),h.appendTo(t)}}}(Ci||(Ci={}));var _i,Si=function(t){function e(e,n){var i=t.call(this,e,n)||this;return e.addClass("s-PopupMenuButton"),e.click((function(t){var e,n;t.preventDefault(),t.stopPropagation(),null!=i.options.onPopup&&i.options.onPopup();var r=i.options.menu;r.show().position({my:null!==(e=i.options.positionMy)&&void 0!==e?e:"left top",at:null!==(n=i.options.positionAt)&&void 0!==n?n:"left bottom",of:i.element});var o=i.uniqueName;$(document).one("click."+o,(function(t){r.hide()}))})),
i.options.menu.hide().appendTo(document.body).addClass("s-PopupMenu").menu(),i}return _(e,t),e.prototype.destroy=function(){null!=this.options.menu&&(this.options.menu.remove(),this.options.menu=null),t.prototype.destroy.call(this)},e=S([In.registerEditor("Serenity.PopupMenuButton")],e)}(vi),ki=function(t){function e(e,n){var i=t.call(this,e,n)||this;return e.addClass("s-PopupToolButton"),$("<b/>").appendTo(e.children(".button-outer").children("span")),i}return _(e,t),e=S([In.registerEditor("Serenity.PopupToolButton")],e)}(Si),Ii=function(t){function e(e,n){var i=t.call(this,e,n)||this;i.element.addClass("s-Toolbar clearfix").html('<div class="tool-buttons"><div class="buttons-outer"><div class="buttons-inner"></div></div></div>');for(var r=$("div.buttons-inner",i.element),o=i.options.buttons,a=0;a<o.length;a++)i.createButton(r,o[a]);return i}return _(e,t),e.prototype.destroy=function(){this.element.find("div.tool-button").unbind("click"),
this.mouseTrap&&(this.mouseTrap.destroy?this.mouseTrap.destroy():this.mouseTrap.reset(),this.mouseTrap=null),t.prototype.destroy.call(this)},e.prototype.createButton=function(t,e){var n,i=null!==(n=e.cssClass)&&void 0!==n?n:"";!0!==e.separator&&"left"!==e.separator&&"both"!==e.separator||$('<div class="separator"></div>').appendTo(t);var r=$('<div class="tool-button"><div class="button-outer"><span class="button-inner"></span></div></div>').appendTo(t);"right"!==e.separator&&"both"!==e.separator||$('<div class="separator"></div>').appendTo(t),i.length>0&&r.addClass(i),l(e.hint)||r.attr("title",e.hint),r.click((function(t){r.hasClass("disabled")||e.onClick(t)}));var o=e.title;if(!1!==e.htmlEncode&&(o=$t(e.title)),!l(e.icon)){r.addClass("icon-tool-button");var a=e.icon;d(a,"fa-")?a="fa "+a:d(a,"glyphicon-")&&(a="glyphicon "+a),o="<i class='"+a+"'></i> "+o}null==o||0===o.length?r.addClass("no-text"):r.find("span").html(o),!1===e.visible&&r.hide(),
null!=e.disabled&&"function"!=typeof e.disabled&&r.toggleClass("disabled",!!e.disabled),"function"!=typeof e.visible&&"function"!=typeof e.disabled||r.on("updateInterface",(function(){"function"==typeof e.visible&&r.toggle(!!e.visible()),"function"==typeof e.disabled&&r.toggleClass("disabled",!!e.disabled())})),l(e.hotkey)||null==window.Mousetrap||(this.mouseTrap=this.mouseTrap||window.Mousetrap(e.hotkeyContext||this.options.hotkeyContext||window.document.documentElement),this.mouseTrap.bind(e.hotkey,(function(t,n){return r.is(":visible")&&r.triggerHandler("click"),e.hotkeyAllowDefault})))},e.prototype.findButton=function(t){return null!=t&&d(t,".")&&(t=t.substr(1)),$("div.tool-button."+t,this.element)},e.prototype.updateInterface=function(){this.element.find(".tool-button").each((function(t,e){$(e).triggerHandler("updateInterface")}))},e=S([In.registerClass("Serenity.Toolbar")],e)}(vi);!function(t){t.getDisplayText=function(t){var e,i,r;if(null!=t.element.data("select2")){
var o=t.element.select2("data");return null==o?"":null!==(e=o.text)&&void 0!==e?e:""}var a=n(t);return null==a?"":"string"==typeof a?a:a instanceof Boolean?a?null!==(i=b("Controls.FilterPanel.OperatorNames.true"))&&void 0!==i?i:"True":null!==(r=b("Controls.FilterPanel.OperatorNames.true"))&&void 0!==r?r:"False":a.toString()};var e={name:"_"};function n(t){var n={};return i(t,e,n),n._}function i(t,e,n){var i=G(t,ai);if(null==i){var r=G(t,ui);if(null==r){var o=G(t,ni);if(null==o){var a=G(t,ii);if(null==a)null==t.getEditValue?t.element.is(":input")&&(n[e.name]=t.element.val()):t.getEditValue(e,n);else{var l=a.get_value();n[e.name]=isNaN(l)?null:l}}else n[e.name]=o.get_value()}else n[e.name]=r.get_value()}else i.getEditValue(e,n)}function r(t,e,n){var i=G(t,si);if(null==i){var r=G(t,ui);if(null!=r){var o=n[e.name];return null!=o&&(o=o.toString()),void r.set_value(z(o,String))}var a=G(t,ni);if(null==a){var l=G(t,ii);if(null==l)if(null==t.setEditValue)if(t.element.is(":input")){
var s=n[e.name];null==s?t.element.val(""):t.element.val(s)}else;else t.setEditValue(n,e);else{var c=n[e.name];null==c||q(c,String)&&u(z(c,String))?l.set_value(null):q(c,String)?l.set_value(z(_e(z(c,String)),Number)):q(c,Boolean)?l.set_value(c?1:0):l.set_value(z(c,Number))}}else{var d=n[e.name];"number"==typeof d?a.set_value(d>0):a.set_value(!!d)}}else i.setEditValue(n,e)}function o(t,e){return t.each((function(t,n){var i=$(n),r=i.attr("type");return i.is("select")||"radio"===r||"checkbox"===r?e?i.addClass("readonly").attr("disabled","disabled"):i.removeClass("readonly").removeAttr("disabled"):e?i.addClass("readonly").attr("readonly","readonly"):i.removeClass("readonly").removeAttr("readonly"),!0})),t}t.getValue=n,t.saveValue=i,t.setValue=function(t,n){r(t,e,{_:n})},t.loadValue=r,t.setReadonly=o,t.setReadOnly=function(t,e){var n=G(t,li);null!=n?n.set_readOnly(e):t.element.is(":input")&&o(t.element,e)},t.setRequired=function(t,e){var n=G(t,ci)
;null!=n?n.set_required(e):t.element.is(":input")&&t.element.toggleClass("required",!!e);var i=t.element.closest(".field"),r=i.find("sup").get().length>0;e&&!r?$("<sup>*</sup>").attr("title",v("Controls.PropertyGrid.RequiredHint")).prependTo(i.find(".caption")[0]):!e&&r&&$(i.find("sup")[0]).remove()},t.setContainerReadOnly=function(e,n){if(n)e.addClass("readonly-container").find(".editor").not(".container-readonly").each((function(e,n){var i=$(n).tryGetWidget(vi);if(null!=i){if(i.get_readOnly){if(i.get_readOnly())return}else if($(n).is("[readonly]")||$(n).is("[disabled]")||$(n).is(".readonly")||$(n).is(".disabled"))return;$(n).addClass("container-readonly"),t.setReadOnly(i,!0)}else{if($(n).is("[readonly]")||$(n).is("[disabled]")||$(n).is(".readonly")||$(n).is(".disabled"))return;t.setReadonly($(n).addClass("container-readonly"),!0)}}));else{if(!e.hasClass("readonly-container"))return
;e.removeClass("readonly-container").find(".editor.container-readonly").removeClass("container-readonly").each((function(e,n){var i=$(n).tryGetWidget(vi);null!=i?t.setReadOnly(i,!1):t.setReadonly($(n),!1)}))}}}(_i||(_i={}));var xi,Ti,Fi=function(){function t(t,e,n){var i=this;this.parentType=t,this.widget=e,this.parentChange=n,this.bind(),this.widget.element.bind("remove."+e.uniqueName+"cwh",(function(t){i.unbind(),i.widget=null,i.parentChange=null}))}return t.prototype.bind=function(){var t=this;if(l(this._parentID))return null;var e=xt(this.widget.element,this._parentID).tryGetWidget(this.parentType);return null!=e?(e.element.bind("change."+this.widget.uniqueName,(function(){t.parentChange(e)})),e):(wt("Can't find cascaded parent element with ID: "+this._parentID+"!","",null),null)},t.prototype.unbind=function(){if(l(this._parentID))return null;var t=xt(this.widget.element,this._parentID).tryGetWidget(this.parentType);return null!=t&&t.element.unbind("."+this.widget.uniqueName),t},
t.prototype.get_parentID=function(){return this._parentID},t.prototype.set_parentID=function(t){this._parentID!==t&&(this.unbind(),this._parentID=t,this.bind())},t=S([In.registerClass("Serenity.CascadedWidgetLink")],t)}();!function(t){t.asyncSubmit=function(t,e,n){var i=t.validate().settings;return!i.abortHandler&&((null==e||!1!==e())&&(i.abortHandler=on,i.submitHandler=function(){return null!=n&&n(),!1},t.trigger("submit"),!0))},t.submit=function(t,e,n){var i=t.validate();return null==i.settings.abortHandler&&((null==e||!1!==e())&&(!!i.form()&&(null!=n&&n(),!0)))},t.getValidator=function(t){var e=t.closest("form");return 0===e.length?null:e.data("validator")}}(xi||(xi={})),function(t){t.addValidationRule=function(t,e,n){if(!t.length)return t;if(null==n)throw new pt("rule is null!");return t.addClass("customValidate").bind("customValidate."+e,n),t},t.removeValidationRule=function(t,e){return t.unbind("customValidate."+e),t},t.validateElement=function(t,e){return t.element(e.element[0])
}}(Ti||(Ti={}));var Pi,Oi,Di=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.initValidator(),i.initTabs(),i.initToolbar(),i}return _(e,t),e.prototype.destroy=function(){this.tabs&&(this.tabs.tabs("destroy"),this.tabs=null),this.toolbar&&(this.toolbar.destroy(),this.toolbar=null),this.validator&&(this.byId("Form").remove(),this.validator=null),t.prototype.destroy.call(this)},e.prototype.arrange=function(){this.element.find(".require-layout").filter(":visible").each((function(t,e){$(e).triggerHandler("layout")}))},e.prototype.getToolbarButtons=function(){return[]},e.prototype.getValidatorOptions=function(){return{}},e.prototype.initTabs=function(){var t=this.byId("Tabs");0!==t.length&&(this.tabs=t.tabs({}))},e.prototype.initToolbar=function(){var t=this.byId("Toolbar");if(0!==t.length){var e={buttons:this.getToolbarButtons()};this.toolbar=new Ii(t,e)}},e.prototype.initValidator=function(){var t=this.byId("Form");if(t.length>0){var e=this.getValidatorOptions()
;this.validator=t.validate(an(e))}},e.prototype.resetValidation=function(){this.validator&&this.validator.resetAll()},e.prototype.validateForm=function(){return null==this.validator||!!this.validator.form()},e}(wi);!function(t){function e(t){var e=t.data("indexByKey");return e||(e={},t.children("ul").children("li").children("a").each((function(t,n){var i=n.getAttribute("href").toString(),r="_Tab",o=i.lastIndexOf(r);o>=0&&(i=i.substr(o+r.length)),e[i]=t})),t.data("indexByKey",e)),e}t.setDisabled=function(t,n,i){if(t){var r=e(t);if(r){var o=r[n];null!=o&&(i&&o===t.tabs("option","active")&&t.tabs("option","active",0),t.tabs(i?"disable":"enable",o))}}},t.toggle=function(t,n,i){if(t){var r=e(t);if(r){var o=r[n];null!=o&&(i||o!==t.tabs("option","active")||t.tabs("option","active",0),t.children("ul").children("li").eq(o).toggle(i))}}},t.activeTabKey=function(t){var e=t.children("ul").children("li").eq(t.tabs("option","active")).children("a").attr("href").toString(),n="_Tab",i=e.lastIndexOf(n)
;return i>=0&&(e=e.substr(i+n.length)),e},t.indexByKey=e,t.selectTab=function(t,n){var i=e(t);if(i){var r=i[n];null!=r&&r!==t.tabs("option","active")&&t.tabs("option","active",r)}}}(Pi||(Pi={})),function(t){t.set=function(t,e){if(null!=e){var n=R(t);if(n!==Object){var i=n.__propByName,r=n.__fieldByName;if(null==i){i={};for(var o=0,a=U(n,16).filter((function(t){return!!t.setter&&((t.attr||[]).filter((function(t){return q(t,Hn)})).length>0||(t.attr||[]).filter((function(t){return q(t,mn)})).length>0)}));o<a.length;o++){var l=a[o];i[ti.makeCamelCase(l.name)]=l}n.__propByName=i}if(null==r){var s=U(n,4).filter((function(t){return(t.attr||[]).filter((function(t){return q(t,Hn)})).length>0||(t.attr||[]).filter((function(t){return q(t,mn)})).length>0}));r={};for(var u=0;u<s.length;u++){var c=s[u];r[ti.makeCamelCase(c.name)]=c}n.__fieldByName=r}for(var d=0,p=Object.keys(e);d<p.length;d++){var h=p[d],f=e[h],g=ti.makeCamelCase(h),m=i[g]||i[h];if(null!=m){var y=t[m.setter];y&&y.call(t,f)}else{
var v=r[g]||r[h];v&&(t[v.name]=f)}}}}}}(Oi||(Oi={}));var Ei=function(t){function n(n,i){var r=t.call(this,n,i)||this;r.categoryLinkClick=function(t){t.preventDefault();var e=$("a[name="+t.target.getAttribute("href").toString().substr(1)+"]");e.closest(".category").hasClass("collapsed")&&e.closest(".category").children(".category-title").click();var n=function(){e.fadeTo(100,.5,(function(){e.fadeTo(100,1,(function(){}))}))},i=e.closest(".category");0===i.closest(":scrollable(both)").length?n():i.scrollintoview({duration:"fast",direction:"y",complete:n})},null==i.mode&&(i.mode=1),n.addClass("s-PropertyGrid"),r.editors=[];var o=r.options.items||[];if(r.items=[],e(o,(function(t){return!l(t.tab)}))){var a=o.filter((function(t){return l(t.tab)}));a.length>0&&(r.createItems(r.element,a),$("<div class='pad'></div>").appendTo(r.element));for(var s=o.filter((function(t){return!l(t.tab)
})),u=$("<ul class='nav nav-tabs property-tabs' role='tablist'></ul>").appendTo(r.element),c=$("<div class='tab-content property-panes'></div>").appendTo(r.element),d=0,p=0;p<s.length;){var h={$:f(s[p].tab)},g=[],m=p;do{g.push(s[m])}while(++m<s.length&&f(s[m].tab)===h.$);p=m;var y=$(Vt()?'<li><a data-toggle="tab" role="tab"></a></li>':'<li class="nav-item"><a class="nav-link" data-'+(Mt()?"bs-":"")+'toggle="tab" role="tab"></a></li>').appendTo(u);0===d&&(Vt()?y.addClass("active"):y.children("a").addClass("active"));var v=r.uniqueName+"_Tab"+d;y.children("a").attr("href","#"+v).text(r.determineText(h.$,function(t){return t+"Tabs."+this.tab.$}.bind({tab:h})));var b=$("<div class='tab-pane fade' role='tabpanel'>").appendTo(c);0===d&&b.addClass(Vt()?"in active":"show active"),b.attr("id",v),r.createItems(b,g),d++}}else r.createItems(r.element,o);return r.updateInterface(),r}var i;return _(n,t),i=n,n.prototype.destroy=function(){if(null!=this.editors){
for(var t=0;t<this.editors.length;t++)this.editors[t].destroy();this.editors=null}this.element.find("a.category-link").unbind("click",this.categoryLinkClick).remove(),vi.prototype.destroy.call(this)},n.prototype.createItems=function(t,n){var i,r,o,a,s={},u=!1!==this.options.useCategories&&e(n,(function(t){return!l(t.category)}));if(u){var c=$("<div/>").addClass("category-links");s=this.createCategoryLinks(c,n),Object.keys(s).length>1?c.appendTo(t):c.find("a.category-link").unbind("click",this.categoryLinkClick).remove()}o=$("<div/>").addClass("categories").appendTo(t),a=u?o:$("<div/>").addClass("category").appendTo(o);for(var d=null,p=0;p<n.length;p++){var h=n[p],f=h.category;if(null==f&&(f=null!==(i=this.options.defaultCategory)&&void 0!==i?i:""),u&&d!==f){var g=this.createCategoryDiv(o,s,f,!0!==h.collapsible?null:null!==(r=h.collapsed)&&void 0!==r&&r);null==d&&g.addClass("first-category"),d=f,a=g}var m=this.createField(a,h);this.items.push(h),this.editors.push(m)}},
n.prototype.createCategoryDiv=function(t,e,n,i){var r=$("<div/>").addClass("category").appendTo(t),o=$("<div/>").addClass("category-title").append($("<a/>").addClass("category-anchor").text(this.determineText(n,(function(t){return t+"Categories."+n}))).attr("name",this.options.idPrefix+"Category"+e[n].toString())).appendTo(r);if(null!=i){r.addClass(!0===i?"collapsible collapsed":"collapsible");var a=$("<i/>").addClass(!0===i?"fa fa-plus":"fa fa-minus").appendTo(o);o.click((function(t){r.toggleClass("collapsed"),a.toggleClass("fa-plus").toggleClass("fa-minus")}))}return r},n.prototype.determineText=function(t,e){if(null!=t&&!d(t,"`")){var n=b(t);if(null!=n)return n}if(null!=t&&d(t,"`")&&(t=t.substr(1)),!l(this.options.localTextPrefix)){var i=b(e(this.options.localTextPrefix));if(null!=i)return i}return t},n.prototype.createField=function(t,e){var n,r,o=$("<div/>").addClass("field").addClass(e.name).data("PropertyItem",e).appendTo(t);if(l(e.cssClass)||o.addClass(e.cssClass),
!l(e.formCssClass)&&(o.addClass(e.formCssClass),e.formCssClass.indexOf("line-break-")>=0)){var a=e.formCssClass.split(String.fromCharCode(32));a.indexOf("line-break-xs")>=0?$("<div class='line-break' style='width: 100%' />").insertBefore(o):a.indexOf("line-break-sm")>=0?$("<div class='line-break hidden-xs' style='width: 100%' />").insertBefore(o):a.indexOf("line-break-md")>=0?$("<div class='line-break hidden-sm' style='width: 100%' />").insertBefore(o):a.indexOf("line-break-lg")>=0&&$("<div class='line-break hidden-md' style='width: 100%' />").insertBefore(o)}var s=this.options.idPrefix+e.name,u=this.determineText(e.title,(function(t){return t+e.name})),c=this.determineText(e.hint,(function(t){return t+e.name+"_Hint"})),d=this.determineText(e.placeholder,(function(t){return t+e.name+"_Placeholder"}));null==c&&(c=null!=u?u:"");var p=$("<label/>").addClass("caption").attr("for",s).attr("title",c).html(null!=u?u:"").appendTo(o)
;l(e.labelWidth)||("0"===e.labelWidth?p.hide():p.css("width",e.labelWidth)),!0===e.required&&$("<sup>*</sup>").attr("title",v("Controls.PropertyGrid.RequiredHint")).prependTo(p);var h=hi.get(null!==(n=e.editorType)&&void 0!==n?n:"String"),f=j(h,Tn,!0),g=(f.length>0&&f[0].value,vi.elementFor(h).addClass("editor").attr("id",s).appendTo(o));g.is(":input")&&g.attr("name",null!==(r=e.name)&&void 0!==r?r:""),l(d)||g.attr("placeholder",d);e.editorParams;var m,y=null,b=j(h,jn,!0);return null!=b&&b.length>0&&(y=b[0].optionsType),(m=new h(g,P(null!=y?new y:new Object,e.editorParams))).initialize(),"BooleanEditor"!=M(m)||null!=e.editorParams&&e.editorParams.labelFor||p.removeAttr("for"),"RadioButtonEditor"!=M(m)||null!=e.editorParams&&e.editorParams.labelFor||p.removeAttr("for"),null!=e.maxLength&&i.setMaxLength(m,e.maxLength),null!=e.editorParams&&Oi.set(m,e.editorParams),$("<div/>").addClass("vx").appendTo(o),$("<div/>").addClass("clear").appendTo(o),m},n.prototype.getCategoryOrder=function(t){
var e,n=0,i={},r=g(this.options.categoryOrder);if(null!=r)for(var o=0,a=r.split(";");o<a.length;o++){var l=g(a[o]);null!=l&&(null==i[l]&&(i[l]=n++))}for(var s=0,u=t;s<u.length;s++){var c=u[s].category;null==c&&(c=null!==(e=this.options.defaultCategory)&&void 0!==e?e:""),null==i[c]&&(i[c]=n++)}return i},n.prototype.createCategoryLinks=function(t,e){for(var n,i=0,r={},o={},a=0,l=e;a<l.length;a++){var s=l[a],u=s.name,c=s.category;null==c&&(c=null!==(n=this.options.defaultCategory)&&void 0!==n?n:""),o[u]=c,r[s.name]=i++}var d=this.getCategoryOrder(e);e.sort((function(t,e){var n=0,i=o[t.name],a=o[e.name];if(i!=a){var l=d[i],s=d[a];null!=l&&null!=s?n=l-s:null!=l?n=-1:null!=s&&(n=1)}return 0===n&&(n=de.stringCompare(i,a)),0===n&&(n=r[t.name]<r[e.name]?-1:r[t.name]>r[e.name]?1:0),n}));for(var p={},h=0;h<e.length;h++){var f=e[h],g={$:o[f.name]};if(null==p[g.$]){var m=Object.keys(p).length+1;p[g.$]=m,m>1&&$("<span/>").addClass("separator").text("|").prependTo(t),
$("<a/>").addClass("category-link").text(this.determineText(g.$,function(t){return t+"Categories."+this.category.$}.bind({category:g}))).attr("tabindex","-1").attr("href","#"+this.options.idPrefix+"Category"+m.toString()).click(this.categoryLinkClick).prependTo(t)}}return $("<div/>").addClass("clear").appendTo(t),p},n.prototype.get_editors=function(){return this.editors},n.prototype.get_items=function(){return this.items},n.prototype.get_idPrefix=function(){return this.options.idPrefix},n.prototype.get_mode=function(){return this.options.mode},n.prototype.set_mode=function(t){this.options.mode!==t&&(this.options.mode=t,this.updateInterface())},n.loadEditorValue=function(t,e,n){},n.saveEditorValue=function(t,e,n){_i.saveValue(t,e,n)},n.setReadOnly=function(t,e){_i.setReadOnly(t,e)},n.setReadonly=function(t,e){return _i.setReadonly(t,e)},n.setRequired=function(t,e){_i.setRequired(t,e)},n.setMaxLength=function(t,e){
t.element.is(":input")&&(e>0?t.element.attr("maxlength",e):t.element.removeAttr("maxlength"))},n.prototype.load=function(t){for(var e=0;e<this.editors.length;e++){var n=this.items[e],i=this.editors[e];1===this.get_mode()&&null!=n.defaultValue&&void 0===t[n.name]&&(t[n.name]=n.defaultValue),_i.loadValue(i,n,t)}},n.prototype.save=function(t){null==t&&(t=Object.create(null));for(var e=0;e<this.editors.length;e++){var n=this.items[e];if(!0!==n.oneWay&&this.canModifyItem(n)){var i=this.editors[e];_i.saveValue(i,n,t)}}return t},Object.defineProperty(n.prototype,"value",{get:function(){return this.save()},set:function(t){null==t&&(t=Object.create(null)),this.load(t)},enumerable:!1,configurable:!0}),n.prototype.canModifyItem=function(t){return 1===this.get_mode()?!1!==t.insertable&&(null==t.insertPermission||Fe.hasPermission(t.insertPermission)):2!==this.get_mode()||!1!==t.updatable&&(null==t.updatePermission||Fe.hasPermission(t.updatePermission))},n.prototype.updateInterface=function(){
for(var t=0;t<this.editors.length;t++){var e=this.items[t],n=this.editors[t],i=!0===e.readOnly||!this.canModifyItem(e);if(_i.setReadOnly(n,i),_i.setRequired(n,!i&&!!e.required&&"Boolean"!==e.editorType),!1===e.visible||null!=e.readPermission||null!=e.insertPermission||null!=e.updatePermission||!0===e.hideOnInsert||!0===e.hideOnUpdate){var r=null!=e.readPermission&&!Fe.hasPermission(e.readPermission)||!1===e.visible||1===this.get_mode()&&!0===e.hideOnInsert||2===this.get_mode()&&!0===e.hideOnUpdate;n.getGridField().toggle(!r)}}},n.prototype.enumerateItems=function(t){for(var e=0;e<this.editors.length;e++){t(this.items[e],this.editors[e])}},n=i=S([In.registerClass("Serenity.PropertyGrid")],n)}(vi),$i=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.initPropertyGrid(),i.loadInitialEntity(),i}return _(e,t),e.prototype.destroy=function(){this.propertyGrid&&(this.propertyGrid.destroy(),this.propertyGrid=null),this.validator&&(this.byId("Form").remove(),this.validator=null),
t.prototype.destroy.call(this)},e.prototype.initPropertyGrid=function(){var t=this.byId("PropertyGrid");if(!(t.length<=0)){var e=this.getPropertyGridOptions();this.propertyGrid=new Ei(t,e).init(null),this.element.closest(".ui-Panel").hasClass("s-Flexify")&&this.propertyGrid.element.children(".categories").flexHeightOnly(1)}},e.prototype.loadInitialEntity=function(){this.propertyGrid&&this.propertyGrid.load(new Object)},e.prototype.getFormKey=function(){var t=j(R(this),Dn,!0);if(t.length>=1)return t[0].value;var e=V(R(this)),n=e.indexOf(".");return n>=0&&(e=e.substring(n+1)),a(e,"Panel")?e=e.substr(0,e.length-6):a(e,"Panel")&&(e=e.substr(0,e.length-5)),e},e.prototype.getPropertyGridOptions=function(){return{idPrefix:this.idPrefix,items:this.getPropertyItems(),mode:1,useCategories:!1,localTextPrefix:"Forms."+this.getFormKey()+"."}},e.prototype.getPropertyItems=function(){return qe(this.getFormKey())},e.prototype.getSaveEntity=function(){var t=new Object
;return this.propertyGrid&&this.propertyGrid.save(t),t},e.prototype.get_entity=function(){return this._entity},e.prototype.get_entityId=function(){return this._entityId},e.prototype.set_entity=function(t){this._entity=null!=t?t:new Object},e.prototype.set_entityId=function(t){this._entityId=t},e.prototype.validateBeforeSave=function(){return this.validator.form()},e=S([In.registerClass("Serenity.PropertyPanel")],e)}(Di),Ai=function(t){function e(e){return t.call(this,e)||this}return _(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.element.val()},set:function(t){this.element.val(t)},enumerable:!1,configurable:!0}),e.prototype.get_value=function(){return this.value},e.prototype.set_value=function(t){this.value=t},e=S([In.registerEditor("Serenity.StringEditor",[ui]),In.element('<input type="text"/>')],e)}(vi),Ni=function(t){function e(e){var n=t.call(this,e)||this;return e.attr("type","password"),n}return _(e,t),
e=S([In.registerEditor("Serenity.PasswordEditor")],e)}(Ai),Bi=function(t){function e(e,n){var i,r,o=t.call(this,e,n)||this;return 0!==o.options.cols&&e.attr("cols",null!==(i=o.options.cols)&&void 0!==i?i:80),0!==o.options.rows&&e.attr("rows",null!==(r=o.options.rows)&&void 0!==r?r:6),o}return _(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.element.val()},set:function(t){this.element.val(t)},enumerable:!1,configurable:!0}),e.prototype.get_value=function(){return this.value},e.prototype.set_value=function(t){this.value=t},e=S([In.registerEditor("Serenity.TextAreaEditor",[ui]),In.element("<textarea />")],e)}(vi),Vi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.element.is(":checked")},set:function(t){this.element.prop("checked",!!t)},enumerable:!1,configurable:!0}),e.prototype.get_value=function(){return this.value},e.prototype.set_value=function(t){
this.value=t},e=S([In.registerEditor("Serenity.BooleanEditor",[ni]),In.element('<input type="checkbox"/>')],e)}(vi),Mi=function(t){function e(e,i){var r,o,a=t.call(this,e,i)||this;e.addClass("decimalQ");var l=P(n.defaultAutoNumericOptions(),{vMin:null!==(r=a.options.minValue)&&void 0!==r?r:a.options.allowNegatives?null!=a.options.maxValue?"-"+a.options.maxValue:"-999999999999.99":"0.00",vMax:null!==(o=a.options.maxValue)&&void 0!==o?o:"999999999999.99"});return null!=a.options.decimals&&(l.mDec=a.options.decimals),null!=a.options.padDecimals&&(l.aPad=a.options.padDecimals),$.fn.autoNumeric&&e.autoNumeric(l),a}var n;return _(e,t),n=e,e.prototype.get_value=function(){var t;return $.fn.autoNumeric?null==(t=this.element.autoNumeric("get"))||""===t?null:parseFloat(t):_e(t=this.element.val())},Object.defineProperty(e.prototype,"value",{get:function(){return this.get_value()},set:function(t){this.set_value(t)},enumerable:!1,configurable:!0}),e.prototype.set_value=function(t){
null==t||""===t?this.element.val(""):$.fn.autoNumeric?this.element.autoNumeric("set",t):this.element.val(Ce(t))},e.prototype.get_isValid=function(){return!isNaN(this.get_value())},e.defaultAutoNumericOptions=function(){return{aDec:de.decimalSeparator,altDec:"."===de.decimalSeparator?",":".",aSep:"."===de.decimalSeparator?",":".",aPad:!0}},e=n=S([In.registerEditor("Serenity.DecimalEditor",[ii]),In.element('<input type="text"/>')],e)}(vi),Ri=function(t){function e(e,n){var i,r,o=t.call(this,e,n)||this;e.addClass("integerQ");var a=P(Mi.defaultAutoNumericOptions(),{vMin:(null!==(i=o.options.minValue)&&void 0!==i?i:o.options.allowNegatives)?null!=o.options.maxValue?"-"+o.options.maxValue:"-2147483647":"0",vMax:null!==(r=o.options.maxValue)&&void 0!==r?r:2147483647,aSep:null});return $.fn.autoNumeric&&e.autoNumeric(a),o}return _(e,t),e.prototype.get_value=function(){var t
;return $.fn.autoNumeric?u(t=this.element.autoNumeric("get"))?null:parseInt(t,10):null==(t=g(this.element.val()))?null:we(t)},Object.defineProperty(e.prototype,"value",{get:function(){return this.get_value()},set:function(t){this.set_value(t)},enumerable:!1,configurable:!0}),e.prototype.set_value=function(t){null==t||""===t?this.element.val(""):$.fn.autoNumeric?this.element.autoNumeric("set",t):this.element.val(Ce(t))},e.prototype.get_isValid=function(){return!isNaN(this.get_value())},e=S([In.registerEditor("Serenity.IntegerEditor",[ii]),In.element('<input type="text"/>')],e)}(vi),Li='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 17 17"><g></g><path d="M14 2v-1h-3v1h-5v-1h-3v1h-3v15h17v-15h-3zM12 2h1v2h-1v-2zM4 2h1v2h-1v-2zM16 16h-15v-8.921h15v8.921zM1 6.079v-3.079h2v2h3v-2h5v2h3v-2h2v3.079h-15z" fill="#000000"></path></svg>',qi=function(t){function e(e){var i,r=t.call(this,e)||this
;return"undefined"==typeof flatpickr||!n.useFlatpickr&&$.fn.datepicker?$.fn.datepicker?e.datepicker({showOn:"button",beforeShow:function(t,n){return!e.hasClass("readonly")},yearRange:null!==(i=r.yearRange)&&void 0!==i?i:"-100:+50"}):e.attr("type","date"):flatpickr(e[0],n.flatPickrOptions(e)),e.on("keyup."+r.uniqueName,(function(t){32!==t.which||r.get_readOnly()?n.dateInputKeyup(t):r.get_valueAsDate()!=F()&&(r.set_valueAsDate(F()),r.element.trigger("change"))})),e.on("change."+r.uniqueName,n.dateInputChange),en(e,r.uniqueName,(function(t){var e=r.get_value();return l(e)?null:!l(r.get_minValue())&&ue.stringCompare(Ie(e,"yyyy-MM-dd"),Ie(r.get_minValue(),"yyyy-MM-dd"))<0?me(v("Validation.MinDate"),Ie(r.get_minValue(),null)):!l(r.get_maxValue())&&ue.stringCompare(Ie(e,"yyyy-MM-dd"),Ie(r.get_maxValue(),"yyyy-MM-dd"))>0?me(v("Validation.MaxDate"),Ie(r.get_maxValue(),null)):null})),r.set_sqlMinMax(!0),r}var n;return _(e,t),n=e,e.flatPickrOptions=function(t){return{clickOpens:!0,allowInput:!0,
dateFormat:de.dateOrder.split("").join(de.dateSeparator).replace("y","Y"),onChange:function(){t.triggerHandler("change")}}},e.prototype.get_value=function(){var t=this.element.val().trim();return null!=t&&0===t.length?null:Ie(t,"yyyy-MM-dd")},Object.defineProperty(e.prototype,"value",{get:function(){return this.get_value()},set:function(t){this.set_value(t)},enumerable:!1,configurable:!0}),e.prototype.set_value=function(t){null==t?this.element.val(""):"today"===t.toLowerCase()||"now"===t.toLowerCase()?this.element.val(Ie(F(),null)):this.element.val(Ie(t,null))},e.prototype.get_valueAsDate=function(){return l(this.get_value())?null:De(this.get_value())},Object.defineProperty(e.prototype,"valueAsDate",{get:function(){return this.get_valueAsDate()},set:function(t){this.set_valueAsDate(t)},enumerable:!1,configurable:!0}),e.prototype.set_valueAsDate=function(t){null==t&&this.set_value(null),this.set_value(Ie(t,"yyyy-MM-dd"))},e.prototype.get_readOnly=function(){
return this.element.hasClass("readonly")},e.prototype.set_readOnly=function(t){t!==this.get_readOnly()&&(t?(this.element.addClass("readonly").attr("readonly","readonly"),this.element.nextAll(".ui-datepicker-trigger").css("opacity","0.1")):(this.element.removeClass("readonly").removeAttr("readonly"),this.element.nextAll(".ui-datepicker-trigger").css("opacity","1")))},e.prototype.get_minValue=function(){return this.minValue},e.prototype.set_minValue=function(t){this.minValue=t},e.prototype.get_maxValue=function(){return this.maxValue},e.prototype.set_maxValue=function(t){this.maxValue=t},e.prototype.get_minDate=function(){return De(this.get_minValue())},e.prototype.set_minDate=function(t){this.set_minValue(Ie(t,"yyyy-MM-dd"))},e.prototype.get_maxDate=function(){return De(this.get_maxValue())},e.prototype.set_maxDate=function(t){this.set_maxValue(Ie(t,"yyyy-MM-dd"))},e.prototype.get_sqlMinMax=function(){return"1753-01-01"===this.get_minValue()&&"9999-12-31"===this.get_maxValue()},
e.prototype.set_sqlMinMax=function(t){t?(this.set_minValue("1753-01-01"),this.set_maxValue("9999-12-31")):(this.set_minValue(null),this.set_maxValue(null))},e.flatPickrTrigger=function(t){return $('<i class="ui-datepicker-trigger" href="javascript:;">'+Li+"</i>").insertAfter(t).click((function(){t.hasClass("readonly")||t[0]._flatpickr.open()}))},e.dateInputKeyup=function(t){var e;if("dmy"===de.dateOrder){var n=$(t.target);if(n.is(":input")&&"date"!=n.attr("type")&&!n.is("[readonly]")&&!n.is(":disabled")){var i=null!==(e=n.val())&&void 0!==e?e:"";if(0!==i.length&&n[0].selectionEnd===i.length)if(-1===i.indexOf(de.dateSeparator+de.dateSeparator)){if(47===t.which||111===t.which){if(i.length>=2&&i.charAt(i.length-1)===de.dateSeparator&&i.charAt(i.length-2)===de.dateSeparator)return void n.val(i.substr(0,i.length-1));if(i.charAt(i.length-1)!==de.dateSeparator)return;switch(i.length){case 2:if(r(i.charCodeAt(0))){i="0"+i;break}return;case 4:
if(r(i.charCodeAt(0))&&r(i.charCodeAt(2))&&i.charAt(1)==de.dateSeparator){i="0"+i.charAt(0)+de.dateSeparator+"0"+i.charAt(2)+de.dateSeparator;break}return;case 5:if(r(i.charCodeAt(0))&&r(i.charCodeAt(2))&&r(i.charCodeAt(3))&&i.charAt(1)===de.dateSeparator){i="0"+i;break}if(r(i.charCodeAt(0))&&r(i.charCodeAt(1))&&r(i.charCodeAt(3))&&i.charAt(2)===de.dateSeparator){i=i.charAt(0)+i.charAt(1)+de.dateSeparator+"0"+i.charAt(3)+de.dateSeparator;break}break;default:return}n.val(i)}if(i.length<6&&(t.which>=48&&t.which<=57||t.which>=96&&t.which<=105)&&r(i.charCodeAt(i.length-1))){switch(i.length){case 1:if(i.charCodeAt(0)<=51)return;i="0"+i;break;case 2:if(!r(i.charCodeAt(0)))return;break;case 3:if(!r(i.charCodeAt(0))||i.charAt(1)!==de.dateSeparator||i.charCodeAt(2)<=49)return;i="0"+i.charAt(0)+de.dateSeparator+"0"+i.charAt(2);break;case 4:if(i.charAt(1)==de.dateSeparator){if(!r(i.charCodeAt(0))||!r(i.charCodeAt(2)))return;i="0"+i;break}if(i.charAt(2)==de.dateSeparator){
if(!r(i.charCodeAt(0))||!r(i.charCodeAt(1))||i.charCodeAt(3)<=49)return;i=i.charAt(0)+i.charAt(1)+de.dateSeparator+"0"+i.charAt(3);break}return;case 5:if(i.charAt(2)!==de.dateSeparator||!r(i.charCodeAt(0))||!r(i.charCodeAt(1))||!r(i.charCodeAt(3)))return;break;default:return}n.val(i+de.dateSeparator)}}else n.val(m(i,de.dateSeparator+de.dateSeparator,de.dateSeparator))}}function r(t){return t>=48&&t<=57}},e.dateInputChange=function(t){var e,n;if("dmy"===de.dateOrder){var i=$(t.target);if(i.is(":input")&&"date"!=i.attr("type")){var r=null!==(e=i.val())&&void 0!==e?e:"";if(r.length>=6&&/^[0-9]*$/g.test(r)&&i.val(r.substr(0,2)+de.dateSeparator+r.substr(2,2)+de.dateSeparator+r.substr(4)),(r=null!==(n=i.val())&&void 0!==n?n:"").length>=5&&!1!==Ae(r)){var o=Ae(r);i.val(Ie(o,null))}}}},S([In.option()],e.prototype,"yearRange",void 0),S([In.option()],e.prototype,"get_minValue",null),S([In.option()],e.prototype,"get_maxValue",null),S([In.option()],e.prototype,"get_maxDate",null),
S([In.option()],e.prototype,"get_sqlMinMax",null),e=n=S([In.registerEditor("Serenity.DateEditor",[ui,li]),In.element('<input type="text"/>')],e)}(vi);function Gi(){if(!$.datepicker||!$.datepicker.regional||!$.datepicker.regional.en)return!1;var t=de.dateOrder,e=de.dateSeparator,n=($("html").attr("lang")||"en").toLowerCase();return $.datepicker.regional[n]||(n=n.split("-")[0],$.datepicker.regional[n]||(n="en")),$.datepicker.setDefaults($.datepicker.regional.en),$.datepicker.setDefaults($.datepicker.regional[n]),$.datepicker.setDefaults({dateFormat:"mdy"==t?"mm"+e+"dd"+e+"yy":"ymd"==t?"yy"+e+"mm"+e+"dd":"dd"+e+"mm"+e+"yy",buttonImage:"data:image/svg+xml,"+encodeURIComponent(Li),buttonImageOnly:!0,showOn:"both",showButtonPanel:!0,changeMonth:!0,changeYear:!0}),!0}"undefined"!=typeof $&&$.fn&&!Gi()&&$(Gi);var zi=function(t){function e(e,i){var r,o,a,s,u=t.call(this,e,i)||this;if(e.addClass("s-DateTimeEditor"),
u.options.inputOnly)e.addClass("dateTimeQ");else if("undefined"==typeof flatpickr||!qi.useFlatpickr&&$.fn.datepicker&&!u.options.seconds)if($.fn.datepicker){e.addClass("dateQ"),e.datepicker({showOn:"button",beforeShow:function(){return!e.hasClass("readonly")},yearRange:null!==(r=u.options.yearRange)&&void 0!==r?r:"-100:+50"}),e.bind("change."+u.uniqueName,(function(t){u.lastSetValue=null,qi.dateInputChange(t)})),u.time=$("<select/>").addClass("editor s-DateTimeEditor time");var c=e.next(".ui-datepicker-trigger");c.length>0?u.time.insertAfter(c):(c=e.prev(".ui-datepicker-trigger")).length>0?u.time.insertBefore(c):u.time.insertAfter(e),u.time.on("change",(function(t){this.lastSetValue=null,e.triggerHandler("change")}));for(var d=0,p=n.getTimeOptions(null!==(o=u.options.startHour)&&void 0!==o?o:0,0,null!==(a=u.options.endHour)&&void 0!==a?a:23,59,null!==(s=u.options.intervalMinutes)&&void 0!==s?s:5);d<p.length;d++){var h=p[d];It(u.time,h,h)}en(e,u.uniqueName,(function(t){
var e=u.get_value();return l(e)?null:!l(u.get_minValue())&&ue.stringCompare(e,u.get_minValue())<0?me(v("Validation.MinDate"),Ie(u.get_minValue(),null)):!l(u.get_maxValue())&&ue.stringCompare(e,u.get_maxValue())>0?me(v("Validation.MaxDate"),Ie(u.get_maxValue(),null)):null}))}else e.attr("type","datetime").addClass("dateTimeQ");else e.addClass("dateTimeQ"),flatpickr(e[0],u.getFlatpickrOptions());return e.bind("keyup."+u.uniqueName,(function(t){if(!u.get_readOnly()&&u.time)if(32===t.which)u.get_valueAsDate()!==new Date&&(u.set_valueAsDate(new Date),u.element.trigger("change"));else{var e=u.element.val();qi.dateInputKeyup(t),e!=u.element.val()&&(u.lastSetValue=null)}})),u.set_sqlMinMax(!0),u.options.inputOnly||$("<i class='inplace-button inplace-now'><b></b></div>").attr("title",u.getInplaceNowText()).insertAfter(u.time).click((function(t){u.element.hasClass("readonly")||(u.lastSetValue=null,u.set_valueAsDate(new Date),e.triggerHandler("change"))})),u}var n;return _(e,t),n=e,
e.prototype.getFlatpickrOptions=function(){var t,e=this;return{clickOpens:!0,allowInput:!0,enableTime:!0,time_24hr:!0,enableSeconds:!!this.options.seconds,minuteIncrement:null!==(t=this.options.intervalMinutes)&&void 0!==t?t:5,dateFormat:de.dateOrder.split("").join(de.dateSeparator).replace("y","Y")+" H:i"+(this.options.seconds?":S":""),onChange:function(){e.lastSetValue=null,e.element&&e.element.triggerHandler("change")}}},e.prototype.get_value=function(){var t,e=this.element.val().trim();if(null!=e&&0===e.length)return null;this.time?t=Ie(e,"yyyy-MM-dd")+"T"+this.time.val()+":00.000":t=Ie(Ae(this.element.val()),"yyyy-MM-ddTHH:mm:ss.fff");return this.options.useUtc&&(t=xe(De(t))),null!=this.lastSetValue&&this.lastSetValueGet==t?this.lastSetValue:t},Object.defineProperty(e.prototype,"value",{get:function(){return this.get_value()},set:function(t){this.set_value(t)},enumerable:!1,configurable:!0}),e.prototype.set_value=function(t){var e;if(l(t))this.element.val(""),
this.time&&this.time.val("00:00");else if("today"===t.toLowerCase())this.time?(this.element.val(Ie(F(),null)),this.time.val("00:00")):this.element.val(this.getDisplayFormat());else{var i="now"===t.toLowerCase()?new Date:De(t);this.time?(i=n.roundToMinutes(i,null!==(e=this.options.intervalMinutes)&&void 0!==e?e:5),this.element.val(Ie(i,null)),this.time.val(Ie(i,"HH:mm"))):this.element.val(Ie(i,this.getDisplayFormat()))}this.lastSetValue=null,l(t)||"today"==t.toLowerCase()||"now"==t.toLowerCase()||(this.lastSetValueGet=this.get_value(),this.lastSetValue=t)},e.prototype.getInplaceNowText=function(){var t;return null!==(t=b("Controls.DateTimeEditor.SetToNow"))&&void 0!==t?t:"set to now"},e.prototype.getDisplayFormat=function(){return this.options.seconds?de.dateTimeFormat:de.dateTimeFormat.replace(":ss","")},e.prototype.get_valueAsDate=function(){return l(this.get_value())?null:De(this.get_value())},Object.defineProperty(e.prototype,"valueAsDate",{get:function(){
return this.get_valueAsDate()},set:function(t){this.set_valueAsDate(t)},enumerable:!1,configurable:!0}),e.prototype.set_valueAsDate=function(t){null==t&&this.set_value(null),this.set_value(Ie(t,"yyyy-MM-ddTHH:mm"+(this.options.seconds?":ss":"")))},e.prototype.get_minValue=function(){return this.minValue},e.prototype.set_minValue=function(t){this.minValue=t},e.prototype.get_maxValue=function(){return this.maxValue},e.prototype.set_maxValue=function(t){this.maxValue=t},e.prototype.get_minDate=function(){return De(this.get_minValue())},e.prototype.set_minDate=function(t){this.set_minValue(Ie(t,"yyyy-MM-ddTHH:mm:ss"))},e.prototype.get_maxDate=function(){return De(this.get_maxValue())},e.prototype.set_maxDate=function(t){this.set_maxValue(Ie(t,"yyyy-MM-ddTHH:mm:ss"))},e.prototype.get_sqlMinMax=function(){return"1753-01-01"===this.get_minValue()&&"9999-12-31"===this.get_maxValue()},e.prototype.set_sqlMinMax=function(t){t?(this.set_minValue("1753-01-01"),
this.set_maxValue("9999-12-31")):(this.set_minValue(null),this.set_maxValue(null))},e.prototype.get_readOnly=function(){return this.element.hasClass("readonly")},e.prototype.set_readOnly=function(t){t!==this.get_readOnly()&&(t?(this.element.addClass("readonly").attr("readonly","readonly"),this.element.nextAll(".ui-datepicker-trigger").css("opacity","0.1"),this.element.nextAll(".inplace-now").css("opacity","0.1")):(this.element.removeClass("readonly").removeAttr("readonly"),this.element.nextAll(".ui-datepicker-trigger").css("opacity","1"),this.element.nextAll(".inplace-now").css("opacity","1")),this.time&&_i.setReadonly(this.time,t))},e.roundToMinutes=function(t,e){t=new Date(t.getTime());var n=be(ve(t.getMinutes()/e)*e);return t.setMinutes(n),t.setSeconds(0),t.setMilliseconds(0),t},e.getTimeOptions=function(t,e,n,i,r){var o=[];n>=23&&(n=23),i>=60&&(i=59);for(var a=t,l=e;!(a>n||a===n&&l>i);){var s=(a>=10?"":"0")+a+":"+(l>=10?"":"0")+l;o.push(s),(l+=r)>=60&&(l-=60,a++)}return o},
S([In.option()],e.prototype,"get_minValue",null),S([In.option()],e.prototype,"get_maxValue",null),S([In.option()],e.prototype,"get_maxDate",null),S([In.option()],e.prototype,"get_sqlMinMax",null),e=n=S([In.registerEditor("Serenity.DateTimeEditor",[ui,li]),In.element('<input type="text"/>')],e)}(vi),Hi=function(t){function e(e,n){var i=t.call(this,e,n)||this;e.addClass("editor s-TimeEditor hour"),i.options.noEmptyOption||It(e,"","--");for(var r=i.options.startHour||0;r<=(i.options.endHour||23);r++)It(e,r.toString(),r<10?"0"+r:r.toString());i.minutes=$("<select/>").addClass("editor s-TimeEditor minute").insertAfter(e),i.minutes.change((function(){return i.element.trigger("change")}));for(var o=0;o<=59;o+=i.options.intervalMinutes||5)It(i.minutes,o.toString(),o<10?"0"+o:o.toString());return i}return _(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=Se(this.element.val()),e=Se(this.minutes.val());return null==t||null==e?null:60*t+e},set:function(t){
t?(this.element.val(Math.floor(t/60).toString()),this.minutes.val(t%60)):this.options.noEmptyOption?(this.element.val(this.options.startHour),this.minutes.val("0")):(this.element.val(""),this.minutes.val("0"))},enumerable:!1,configurable:!0}),e.prototype.get_value=function(){return this.value},e.prototype.set_value=function(t){this.value=t},e.prototype.get_readOnly=function(){return this.element.hasClass("readonly")},e.prototype.set_readOnly=function(t){t!==this.get_readOnly()&&(t?this.element.addClass("readonly").attr("readonly","readonly"):this.element.removeClass("readonly").removeAttr("readonly"),_i.setReadonly(this.minutes,t))},e=S([In.registerEditor("Serenity.TimeEditor",[ii,li]),In.element("<select />")],e)}(vi),ji=function(t){function e(e,i){var r=t.call(this,e,i)||this;n.registerValidationMethods(),e.addClass("emailuser");var o=$("<span/>").text("@").addClass("emailat").insertAfter(e),a=$('<input type="text"/>').addClass("emaildomain").insertAfter(o)
;return a.bind("blur."+r.uniqueName,(function(){var t=a.closest("form").data("validator");null!=t&&t.element(e[0])})),l(r.options.domain)||a.val(r.options.domain),r.options.readOnlyDomain&&a.attr("readonly","readonly").addClass("disabled").attr("tabindex","-1"),e.bind("keypress."+r.uniqueName,(function(t){64===t.which&&(t.preventDefault(),r.options.readOnlyDomain||(a.focus(),a.select()))})),a.bind("keypress."+r.uniqueName,(function(t){64===t.which&&t.preventDefault()})),r.options.readOnlyDomain||e.change((function(t){return r.set_value(e.val())})),r}var n;return _(e,t),n=e,e.registerValidationMethods=function(){var t;$.validator&&$.validator.methods&&null==$.validator.methods.emailuser&&$.validator.addMethod("emailuser",(function(t,e){var n=$(e).nextAll(".emaildomain");return n.length>0&&null==n.attr("readonly")?!(!this.optional(e)||!this.optional(n[0]))||$.validator.methods.email.call(this,t+"@"+n.val(),e):$.validator.methods.email.call(this,t+"@dummy.com",e)
}),null!==(t=b("Validation.Email"))&&void 0!==t?t:$.validator.messages.email)},e.prototype.get_value=function(){var t=this.element.nextAll(".emaildomain"),e=this.element.val(),n=t.val();return l(e)?this.options.readOnlyDomain||l(n)?"":"@"+n:e+"@"+n},Object.defineProperty(e.prototype,"value",{get:function(){return this.get_value()},set:function(t){this.set_value(t)},enumerable:!1,configurable:!0}),e.prototype.set_value=function(t){var e=this.element.nextAll(".emaildomain");if(null==(t=g(t)))this.options.readOnlyDomain||e.val(""),this.element.val("");else{var n=t.split("@");n.length>1?this.options.readOnlyDomain?l(this.options.domain)?this.element.val(n[0]):n[1]!==this.options.domain?this.element.val(t):this.element.val(n[0]):(e.val(n[1]),this.element.val(n[0])):this.element.val(n[0])}},e.prototype.get_readOnly=function(){var t=this.element.nextAll(".emaildomain");return!(null==this.element.attr("readonly")&&(!this.options.readOnlyDomain||null==t.attr("readonly")))},
e.prototype.set_readOnly=function(t){var e=this.element.nextAll(".emaildomain");t?(this.element.attr("readonly","readonly").addClass("readonly"),this.options.readOnlyDomain||e.attr("readonly","readonly").addClass("readonly")):(this.element.removeAttr("readonly").removeClass("readonly"),this.options.readOnlyDomain||e.removeAttr("readonly").removeClass("readonly"))},e=n=S([In.registerEditor("Serenity.EmailEditor",[ui,li]),In.element('<input type="text"/>')],e)}(vi),Ui=function(t){function e(e){var n=t.call(this,e)||this;return e.attr("type","email").addClass("email"),n}return _(e,t),e=S([In.registerEditor("Serenity.EmailAddressEditor")],e)}(Ai),Wi=function(t){function e(e){var n=t.call(this,e)||this;return e.addClass("url").attr("title","URL should be entered in format: 'http://www.site.com/page'."),e.on("blur."+n.uniqueName,(function(t){var n=e.closest("form").data("validator");if(null!=n&&e.hasClass("error")){var i=g(e.val());i&&(i="http://"+i,
1==$.validator.methods.url.call(n,i,e[0])&&(e.val(i),n.element(e)))}})),n}return _(e,t),e=S([In.registerEditor("Serenity.URLEditor",[ui])],e)}(Ai),Ki=function(t){function e(e,n){var i,r=t.call(this,e,n)||this;if(l(r.options.enumKey)&&null==r.options.enumType&&l(r.options.lookupKey))return r;if(l(r.options.lookupKey)){var o=r.options.enumType||fi.get(r.options.enumKey),a=r.options.enumKey;if(null==a&&null!=o){var s=j(o,gn,!1);s.length>0&&(a=s[0].value)}for(var u=0,c=D.getValues(o);u<c.length;u++){var d=c[u],p=D.toString(o,d);r.addRadio(d.toString(),null!==(i=b("Enums."+a+"."+p))&&void 0!==i?i:p)}}else for(var h=Ve(r.options.lookupKey),f=0,g=h.items;f<g.length;f++){var m=g[f],y=m[h.textField],v=null==y?"":y.toString(),C=m[h.idField],w=null==C?"":C.toString();r.addRadio(w,v)}return r}return _(e,t),e.prototype.addRadio=function(t,e){var n=$("<label/>").text(e);$('<input type="radio"/>').attr("name",this.uniqueName).attr("id",this.uniqueName+"_"+t).attr("value",t).prependTo(n),
n.appendTo(this.element)},e.prototype.get_value=function(){return this.element.find("input:checked").first().val()},Object.defineProperty(e.prototype,"value",{get:function(){return this.get_value()},set:function(t){this.set_value(t)},enumerable:!1,configurable:!0}),e.prototype.set_value=function(t){if(t!==this.get_value()){var e=this.element.find("input"),n=e.filter(":checked");n.length>0&&(n[0].checked=!1),l(t)||(n=e.filter("[value="+t+"]")).length>0&&(n[0].checked=!0)}},e.prototype.get_readOnly=function(){return null!=this.element.attr("disabled")},e.prototype.set_readOnly=function(t){this.get_readOnly()!==t&&(t?this.element.attr("disabled","disabled").find("input").attr("disabled","disabled"):this.element.removeAttr("disabled").find("input").removeAttr("disabled"))},e=S([In.registerEditor("Serenity.RadioButtonEditor",[ui,li]),In.element("<div/>")],e)}(vi),Qi=function(t){function n(e,n){var i=t.call(this,e,n)||this;i._items=[],i._itemById={};var r=i.emptyItemText()
;null!=r&&e.attr("placeholder",r);var o=i.getSelect2Options();return e.select2(o),e.attr("type","text"),e.on("change."+i.uniqueName,(function(t,n){!0!==n&&e.closest("form").data("validator")&&e.valid()})),i.setCascadeFrom(i.options.cascadeFrom),i.useInplaceAdd()&&i.addInplaceCreate(v("Controls.SelectEditor.InplaceAdd"),null),i}var r;return _(n,t),r=n,n.prototype.destroy=function(){null!=this.element&&this.element.select2("destroy"),t.prototype.destroy.call(this)},n.prototype.hasAsyncSource=function(){return!1},n.prototype.asyncSearch=function(t,e){return e({items:[],more:!1}),null},n.prototype.getTypeDelay=function(){var t;return null!==(t=this.options.typeDelay)&&void 0!==t?t:200},n.prototype.emptyItemText=function(){var t;return null!==(t=this.element.attr("placeholder"))&&void 0!==t?t:v("Controls.SelectEditor.EmptyItemText")},n.prototype.getPageSize=function(){var t;return null!==(t=this.options.pageSize)&&void 0!==t?t:100},n.prototype.getIdField=function(){
return this.options.idField},n.prototype.itemId=function(t){var e=t[this.getIdField()];return null==e?"":e.toString()},n.prototype.getTextField=function(){var t;return null!==(t=this.options.textField)&&void 0!==t?t:this.getIdField()},n.prototype.itemText=function(t){var e=t[this.getTextField()];return null==e?"":e.toString()},n.prototype.itemDisabled=function(t){return!1},n.prototype.mapItem=function(t){return{id:this.itemId(t),text:this.itemText(t),disabled:this.itemDisabled(t),source:t}},n.prototype.mapItems=function(t){return t.map(this.mapItem.bind(this))},n.prototype.allowClear=function(){return null!=this.options.allowClear?!!this.options.allowClear:null!=this.emptyItemText()},n.prototype.isMultiple=function(){return!!this.options.multiple},n.prototype.getSelect2Options=function(){var t=this,n=this.emptyItemText(),i={multiple:this.isMultiple(),placeHolder:l(n)?null:n,allowClear:this.allowClear(),createSearchChoicePosition:"bottom"};if(this.hasAsyncSource()){var o=0,a=null
;i.query=function(e){var n=t.getPageSize(),i={searchTerm:g(e.term),skip:(e.page-1)*n,take:n,checkMore:!0};a&&a.abort&&a.abort(),a=null,null!=o&&clearTimeout(o);var r=$(t.element).data("select2");r&&r.search&&r.search.removeClass("select2-active").parent().removeClass("select2-active"),o=setTimeout((function(){a&&a.abort&&a.abort(),r&&r.search.addClass("select2-active").parent().addClass("select2-active"),((a=t.asyncSearch(i,(function(n){a=null,e.callback({results:t.mapItems(n.items),more:n.more})})))&&(a.catch||a.fail)).call(a,(function(){a=null,r&&r.search&&r.search.removeClass("select2-active").parent().removeClass("select2-active")}))}),e.term?t.getTypeDelay():0)};var s=null;i.initSelection=function(n,i){var r=n.val();if(null!=r&&""!=r){var o=t.isMultiple(),a=o?r.split(","):[r],l={idList:a};s&&s.abort&&s.abort(),((s=t.asyncSearch(l,(function(n){if(s=null,o){var l=(n.items||[]).map((function(e){return t.mapItem(e)}));t._itemById=t._itemById||{};for(var u=0,c=l;u<c.length;u++){
var d=c[u];t._itemById[d.id]=d}if(t.isAutoComplete&&l.length!=a.length)for(var p=0,h=a;p<h.length;p++){var f=h[p];e(l,(function(t){return t.id==f}))||l.push({id:f,text:f})}i(l)}else if(n.items&&n.items.length){d=t.mapItem(n.items[0]);t._itemById=t._itemById||{},t._itemById[d.id]=d,i(d)}else t.isAutoComplete?i({id:r,text:r}):i(null)})))&&(s.catch||s.fail)).call(s,(function(){s=null}))}else i(null)}}else i.data=this._items,i.query=function(e){var n=r.filterByText(t._items,(function(t){return t.text}),e.term),i=t.getPageSize();e.callback({results:n.slice((e.page-1)*i,e.page*i),more:n.length>=e.page*i})},i.initSelection=function(e,n){var i=e.val(),r=t.isAutoComplete();if(t.isMultiple()){for(var o=[],a=0,l=i.split(",");a<l.length;a++){var s=l[a],u=t._itemById[s];null==u&&r&&(u={id:s,text:s},t.addItem(u)),null!=u&&o.push(u)}n(o)}else{var c=t._itemById[i];null==c&&r&&(c={id:i,text:i},t.addItem(c)),n(c)}}
;return null!=this.options.minimumResultsForSearch&&(i.minimumResultsForSearch=this.options.minimumResultsForSearch),(this.isAutoComplete()||this.useInplaceAdd())&&(i.createSearchChoice=this.getCreateSearchChoice(null)),i},n.prototype.get_delimited=function(){return!!this.options.delimited},Object.defineProperty(n.prototype,"items",{get:function(){if(this.hasAsyncSource())throw new Error("Can't read items property of an async select editor!");return this._items||[]},set:function(t){if(this.hasAsyncSource())throw new Error("Can't set items of an async select editor!");this._items=t||[],this._itemById={};for(var e=0,n=this._items;e<n.length;e++){var i=n[e];this._itemById[i.id]=i}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"itemById",{get:function(){if(this.hasAsyncSource())throw new Error("Can't read items property of an async select editor!");return this._itemById},set:function(t){
if(this.hasAsyncSource())throw new Error("Can't set itemById of an async select editor!");this._itemById=t||{}},enumerable:!1,configurable:!0}),n.prototype.clearItems=function(){if(this.hasAsyncSource())throw new Error("Can't clear items of an async select editor!");this._items.length=0,this._itemById={}},n.prototype.addItem=function(t){if(this.hasAsyncSource())throw new Error("Can't add item to an async select editor!");this._items.push(t),this._itemById[t.id]=t},n.prototype.addOption=function(t,e,n,i){this.addItem({id:t,text:e,source:n,disabled:i})},n.prototype.addInplaceCreate=function(t,e){var n=this,i=this;t=null!=t?t:v("Controls.SelectEditor.InplaceAdd"),e=null!=e?e:v("Controls.SelectEditor.InplaceEdit");var r=$("<a><b/></a>").addClass("inplace-button inplace-create").attr("title",t).insertAfter(this.element).click((function(t){i.inplaceCreateClick(t)}));this.get_select2Container().add(this.element).addClass("has-inplace-button"),this.element.change((function(){
var i=n.isMultiple()||l(n.get_value());r.attr("title",i?t:e).toggleClass("edit",!i)})),this.element.change((function(t,e){if(!0!==e)if(n.isMultiple()){var i=n.get_values();i.length>0&&i[i.length-1]==(-2147483648).toString()&&(n.set_values(i.slice(0,i.length-1)),n.inplaceCreateClick(t))}else n.get_value()==(-2147483648).toString()&&(n.set_value(null),n.inplaceCreateClick(t))})),this.isMultiple()&&this.get_select2Container().on("dblclick."+this.uniqueName,".select2-search-choice",(function(t){var e=$(t.target);e.hasClass("select2-search-choice")||(e=e.closest(".select2-search-choice"));var i=e.index(),r=n.get_values();i<0||i>=n.get_values().length||(t.editItem=r[i],n.inplaceCreateClick(t))}))},n.prototype.useInplaceAdd=function(){return!this.isAutoComplete()&&this.options.inplaceAdd&&(null==this.options.inplaceAddPermission||Fe.hasPermission(this.options.inplaceAddPermission))},n.prototype.isAutoComplete=function(){return!!this.options.autoComplete},
n.prototype.getCreateSearchChoice=function(t){var n=this;return function(i){var r;return n.lastCreateTerm=i,u(i=(null!==(r=Select2.util.stripDiacritics(i))&&void 0!==r?r:"").toLowerCase())||e(n._items||[],(function(e){var n=t?t(e.source):e.text;return Select2.util.stripDiacritics(null!=n?n:"").toLowerCase()==i}))?null:e(n._items||[],(function(t){var e;return-1!==(null!==(e=Select2.util.stripDiacritics(t.text))&&void 0!==e?e:"").toLowerCase().indexOf(i)}))?n.isAutoComplete()?{id:n.lastCreateTerm,text:n.lastCreateTerm}:{id:(-2147483648).toString(),text:v("Controls.SelectEditor.ClickToDefine")}:n.isAutoComplete()?{id:n.lastCreateTerm,text:n.lastCreateTerm}:{id:(-2147483648).toString(),text:v("Controls.SelectEditor.NoResultsClickToDefine")}}},n.prototype.setEditValue=function(t,e){var n=t[e.name];i(n)?this.set_values(n):this.set_value(null==n?null:n.toString())},n.prototype.getEditValue=function(t,e){
!this.isMultiple()||this.get_delimited()?e[t.name]=this.get_value():e[t.name]=this.get_values()},n.prototype.get_select2Container=function(){return this.element.prevAll(".select2-container")},n.prototype.get_items=function(){return this.items},n.prototype.get_itemByKey=function(){return this.itemById},n.filterByText=function(t,e,n){if(null==n||0==n.length)return t;n=Select2.util.stripDiacritics(n).toUpperCase();var i=[];return t.filter((function(t){var r=e(t);return!(null==r||!r.length)&&(!!d(r=Select2.util.stripDiacritics(r).toUpperCase(),n)||(r.indexOf(n)>=0&&i.push(t),!1))})).concat(i)},n.prototype.get_value=function(){var t;if(this.element.data("select2")){if(null!=(t=this.element.select2("val"))&&i(t))return t.join(",")}else t=this.element.val();return t},Object.defineProperty(n.prototype,"value",{get:function(){return this.get_value()},set:function(t){this.set_value(t)},enumerable:!1,configurable:!0}),n.prototype.set_value=function(t){if(t!=this.get_value()){var e=t
;!l(t)&&this.isMultiple()&&(e=t.split(String.fromCharCode(44)).map((function(t){return g(t)})).filter((function(t){return null!=t})));var n=this.element;n.select2("val",e),n.data("select2-change-triggered",!0);try{n.triggerHandler("change",[!0])}finally{n.data("select2-change-triggered",!1)}this.updateInplaceReadOnly()}},Object.defineProperty(n.prototype,"selectedItem",{get:function(){var t=this.get_value();if(t&&this._itemById){var e=this._itemById[t];if(e)return e.source}return null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"selectedItems",{get:function(){for(var t=[],e=0,n=this.values;e<n.length;e++){var i=n[e];if(i&&this._itemById){var r=this._itemById[i];r&&r.source?t.push(r.source):t.push(null)}}return t},enumerable:!1,configurable:!0}),n.prototype.get_values=function(){var t=this.element.select2("val");if(null==t)return[];if(i(t))return t;var e=t;return l(e)?[]:[e]},Object.defineProperty(n.prototype,"values",{get:function(){return this.get_values()},
set:function(t){this.set_values(t)},enumerable:!1,configurable:!0}),n.prototype.set_values=function(t){null!=t&&0!==t.length?this.set_value(t.join(",")):this.set_value(null)},n.prototype.get_text=function(){var t;return(null!==(t=this.element.select2("data"))&&void 0!==t?t:{}).text},Object.defineProperty(n.prototype,"text",{get:function(){return this.get_text()},enumerable:!1,configurable:!0}),n.prototype.get_readOnly=function(){return!l(this.element.attr("readonly"))},Object.defineProperty(n.prototype,"readOnly",{get:function(){return this.get_readOnly()},set:function(t){this.set_readOnly(t)},enumerable:!1,configurable:!0}),n.prototype.updateInplaceReadOnly=function(){var t=this.get_readOnly()&&(this.isMultiple()||!this.value);this.element.nextAll(".inplace-create").attr("disabled",t?"disabled":"").css("opacity",t?"0.1":"").css("cursor",t?"default":"")},n.prototype.set_readOnly=function(t){t!==this.get_readOnly()&&(this.element.attr("readonly",t?"readonly":null),
this.updateInplaceReadOnly())},n.prototype.getCascadeFromValue=function(t){return _i.getValue(t)},n.prototype.setCascadeFrom=function(t){var e=this;if(l(t))return null!=this.cascadeLink&&(this.cascadeLink.set_parentID(null),this.cascadeLink=null),void(this.options.cascadeFrom=null);this.cascadeLink=new Fi(vi,this,(function(t){e.set_cascadeValue(e.getCascadeFromValue(t))})),this.cascadeLink.set_parentID(t),this.options.cascadeFrom=t},n.prototype.get_cascadeFrom=function(){return this.options.cascadeFrom},Object.defineProperty(n.prototype,"cascadeFrom",{get:function(){return this.get_cascadeFrom()},set:function(t){this.set_cascadeFrom(t)},enumerable:!1,configurable:!0}),n.prototype.set_cascadeFrom=function(t){t!==this.options.cascadeFrom&&(this.setCascadeFrom(t),this.updateItems())},n.prototype.get_cascadeField=function(){var t;return null!==(t=this.options.cascadeField)&&void 0!==t?t:this.options.cascadeFrom},Object.defineProperty(n.prototype,"cascadeField",{get:function(){
return this.get_cascadeField()},set:function(t){this.set_cascadeField(t)},enumerable:!1,configurable:!0}),n.prototype.set_cascadeField=function(t){this.options.cascadeField=t},n.prototype.get_cascadeValue=function(){return this.options.cascadeValue},Object.defineProperty(n.prototype,"cascadeValue",{get:function(){return this.get_cascadeValue()},set:function(t){this.set_cascadeValue(t)},enumerable:!1,configurable:!0}),n.prototype.set_cascadeValue=function(t){this.options.cascadeValue!==t&&(this.options.cascadeValue=t,this.set_value(null),this.updateItems())},n.prototype.get_filterField=function(){return this.options.filterField},Object.defineProperty(n.prototype,"filterField",{get:function(){return this.get_filterField()},set:function(t){this.set_filterField(t)},enumerable:!1,configurable:!0}),n.prototype.set_filterField=function(t){this.options.filterField=t},n.prototype.get_filterValue=function(){return this.options.filterValue},Object.defineProperty(n.prototype,"filterValue",{
get:function(){return this.get_filterValue()},set:function(t){this.set_filterValue(t)},enumerable:!1,configurable:!0}),n.prototype.set_filterValue=function(t){this.options.filterValue!==t&&(this.options.filterValue=t,this.set_value(null),this.updateItems())},n.prototype.cascadeItems=function(t){var e=this.get_cascadeValue();if(null==e||""===e)return l(this.get_cascadeField())?t:[];var n=e.toString(),i=this.get_cascadeField();return t.filter((function(t){var e,r=null!==(e=t[i])&&void 0!==e?e:ti.getPropertyValue(t,i);return!(null==r||r.toString()!==n)}))},n.prototype.filterItems=function(t){var e=this.get_filterValue();if(null==e||""===e)return t;var n=e.toString(),i=this.get_filterField();return t.filter((function(t){var e,r=null!==(e=t[i])&&void 0!==e?e:ti.getPropertyValue(t,i);return!(null==r||r.toString()!==n)}))},n.prototype.updateItems=function(){},n.prototype.getDialogTypeKey=function(){return null!=this.options.dialogType?this.options.dialogType:null},
n.prototype.createEditDialog=function(t){var e=this.getDialogTypeKey(),n=ei.get(e);vi.create({type:n,init:function(e){return t(e)}})},n.prototype.initNewEntity=function(t){l(this.get_cascadeField())||(t[this.get_cascadeField()]=this.get_cascadeValue()),l(this.get_filterField())||(t[this.get_filterField()]=this.get_filterValue()),null!=this.onInitNewEntity&&this.onInitNewEntity(t)},n.prototype.setEditDialogReadOnly=function(t){t.element&&t.element.find(".tool-button.delete-button").addClass("disabled").unbind("click")},n.prototype.editDialogDataChange=function(){},n.prototype.setTermOnNewEntity=function(t,e){},n.prototype.inplaceCreateClick=function(t){var e=this;this.get_readOnly()&&(this.isMultiple()&&!t.editItem||!this.value)||this.createEditDialog((function(n){e.get_readOnly()&&e.setEditDialogReadOnly(n),bi.bindToDataChange(n,e,(function(t,n){if(e.editDialogDataChange(),e.updateItems(),e.lastCreateTerm=null,
"create"!==n.type&&"update"!==n.type||null==n.entityId)if(e.isMultiple()&&"delete"===n.type&&null!=n.entityId){var i=n.entityId.toString(),r=e.get_values().slice(),o=r.indexOf(i);o>=0&&r.splice(o,1),e.set_values(r.slice())}else e.isMultiple()||e.set_value(null);else{var a=n.entityId.toString();if(e.isMultiple()){var l=e.get_values().slice();l.indexOf(a)<0&&l.push(a),e.set_values(null),e.set_values(l.slice())}else e.set_value(null),e.set_value(a)}}),!0);var i=t.editItem;if(null!=i)n.load(i,(function(){n.dialogOpen(e.openDialogAsPanel)}),null);else if(e.isMultiple()||l(e.get_value())){var r={};e.setTermOnNewEntity(r,f(e.lastCreateTerm)),e.initNewEntity(r),n.load(r,(function(){n.dialogOpen(e.openDialogAsPanel)}),null)}else n.load(e.get_value(),(function(){n.dialogOpen(e.openDialogAsPanel)}),null)}))},n=r=S([In.registerClass("Serenity.Select2Editor",[si,ai,ui,li]),In.element('<input type="hidden"/>')],n)}(vi),Yi=function(t){function e(e,n){var i=t.call(this,e,n)||this
;return i.updateItems(),i}return _(e,t),e.prototype.getItems=function(){return this.options.items||[]},e.prototype.emptyItemText=function(){return l(this.options.emptyOptionText)?t.prototype.emptyItemText.call(this):this.options.emptyOptionText},e.prototype.updateItems=function(){var t,e=this.getItems();if(this.clearItems(),e.length>0)for(var n="string"==typeof e[0],i=0,r=e;i<r.length;i++){var o=r[i],a=n?o:o[0],l=n?o:null!==(t=o[1])&&void 0!==t?t:o[0];this.addOption(a,l,o,!1)}},e=S([In.registerClass("Serenity.SelectEditor")],e)}(Qi),Ji=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.updateItems(),i}return _(e,t),e.prototype.getItems=function(){var t,e,n=this.options;if(null!=n.items&&n.items.length>=1)return n.items;var i=[],r=(new Date).getFullYear(),o=(new Date).getFullYear();if(n.minYear=(null!==(t=n.minYear)&&void 0!==t?t:"-10").toString(),
d(n.minYear,"-")?r-=parseInt(n.minYear.substr(1),10):d(n.minYear,"+")?r+=parseInt(n.minYear.substr(1),10):r=parseInt(n.minYear,10),n.maxYear=(null!==(e=n.maxYear)&&void 0!==e?e:"+10").toString(),d(n.maxYear,"-")?o-=parseInt(n.maxYear.substr(1),10):d(n.maxYear,"+")?o+=parseInt(n.maxYear.substr(1),10):o=parseInt(n.maxYear,10),n.descending)for(var a=o;a>=r;a--)i.push(a.toString());else for(var l=r;l<=o;l++)i.push(l.toString());return i},e=S([In.registerEditor("Serenity.DateYearEditor")],e)}(Yi),Xi=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.updateItems(),i}return _(e,t),e.prototype.updateItems=function(){var t;this.clearItems();var e=this.options.enumType||fi.get(this.options.enumKey),n=this.options.enumKey;if(null==n&&null!=e){var i=j(e,gn,!1);i.length>0&&(n=i[0].value)}for(var r=0,o=D.getValues(e);r<o.length;r++){var a=o[r],l=D.toString(e,a);this.addOption(parseInt(a,10).toString(),null!==(t=b("Enums."+n+"."+l))&&void 0!==t?t:l,null,!1)}},
e.prototype.allowClear=function(){var t;return null===(t=this.options.allowClear)||void 0===t||t},e=S([In.registerEditor("Serenity.EnumEditor")],e)}(Qi),Zi=function(t){function e(e,n){var i=t.call(this,e,n)||this;if(!i.hasAsyncSource()){i.updateItems();var r=i;Te.bindToChange("Lookup."+i.getLookupKey(),i.uniqueName,(function(){r.updateItems()}))}return i}return _(e,t),e.prototype.hasAsyncSource=function(){return!!this.options.async},e.prototype.destroy=function(){this.hasAsyncSource()||Te.unbindFromChange(this.uniqueName),t.prototype.destroy.call(this)},e.prototype.getLookupKey=function(){if(null!=this.options.lookupKey)return this.options.lookupKey;var t=V(R(this)),e=t.indexOf(".");return e>=0&&(t=t.substring(e+1)),a(t,"Editor")&&(t=t.substr(0,t.length-6)),t},e.prototype.getLookupAsync=function(){return Me(this.getLookupKey())},e.prototype.getLookup=function(){return Ve(this.getLookupKey())},e.prototype.getItems=function(t){return this.filterItems(this.cascadeItems(t.items))},
e.prototype.getIdField=function(){return null!=this.lookup?this.lookup.idField:t.prototype.getIdField.call(this)},e.prototype.getItemText=function(e,n){if(null==n)return t.prototype.itemText.call(this,e);var i=n.textFormatter?n.textFormatter(e):e[n.textField];return null==i?"":i.toString()},e.prototype.mapItem=function(t){return{id:this.itemId(t),text:this.getItemText(t,this.lookup),disabled:this.getItemDisabled(t,this.lookup),source:t}},e.prototype.getItemDisabled=function(e,n){return t.prototype.itemDisabled.call(this,e)},e.prototype.updateItems=function(){this.clearItems(),this.lookup=this.getLookup();for(var t=0,e=this.getItems(this.lookup);t<e.length;t++){var n=e[t];this.addItem(this.mapItem(n))}},e.prototype.asyncSearch=function(t,e){var n=this;return this.getLookupAsync().then((function(i){n.lookup=i;var r=n.getItems(n.lookup);null!=t.idList&&(r=r.filter((function(e){return t.idList.indexOf(n.itemId(e))>=0}))),r=Qi.filterByText(r,function(t){
return this.getItemText(t,this.lookup)}.bind(n),t.searchTerm),e({items:r.slice(t.skip,t.take),more:r.length>=t.take})}))},e.prototype.getDialogTypeKey=function(){var e=t.prototype.getDialogTypeKey.call(this);return e||this.getLookupKey()},e.prototype.setCreateTermOnNewEntity=function(t,e){t[this.getLookup().textField]=e},e.prototype.editDialogDataChange=function(){Re(this.getLookupKey())},e=S([In.registerEditor("Serenity.LookupEditorBase")],e)}(Qi),tr=function(t){function e(e,n){return t.call(this,e,n)||this}return _(e,t),e=S([In.registerEditor("Serenity.LookupEditor")],e)}(Zi),er=function(t){function e(e,n){return t.call(this,e,n)||this}return _(e,t),e.prototype.getDialogTypeKey=function(){var e=t.prototype.getDialogTypeKey.call(this);if(e)return e;var n=this.getService();return d(n,"~/Services/")&&(n=n.substr("~/Services/".length)),3==n.split("/").length&&(n=n.substr(0,n.lastIndexOf("/"))),n.replace("/",".")},e.prototype.getService=function(){return this.options.service},
e.prototype.getServiceUrl=function(){var t=this.getService();if(null==t)throw new Error("ServiceLookupEditor requires 'service' option to be configured!");return!d(t,"~")&&!d(t,"/")&&t.indexOf("://")<0&&(t="~/Services/"+t),d(t,"~")&&(t=se(t)),t},e.prototype.getIncludeColumns=function(){var t=this.options.includeColumns||[],e=this.getIdField();e&&t.indexOf(e)<0&&t.push(e);var n=this.getTextField();return n&&t.indexOf(n)<0&&t.push(n),t},e.prototype.getSort=function(){return this.options.sort||(this.getTextField()?[this.getTextField()]:null)},e.prototype.getCascadeCriteria=function(){var t=this.get_cascadeValue();return null==t||""===t?l(this.get_cascadeField())?null:["1","=","0"]:[[this.get_cascadeField()],"=",t]},e.prototype.getFilterCriteria=function(){var t=this.get_filterValue();return null==t||""===t?null:[[this.get_filterField()],"=",t]},e.prototype.getIdListCriteria=function(t){if(null==t)return null;if(0==t.length)return["0","=","1"];var e=this.getIdField()
;if(null==e)throw new Error("ServiceLookupEditor requires 'idField' option to be configured!");return[[e],"in",[t]]},e.prototype.getCriteria=function(t){return di.and(di.and(this.getIdListCriteria(t.idList),this.options.criteria),di.and(this.getCascadeCriteria(),this.getFilterCriteria()))},e.prototype.getListRequest=function(t){var e={};return t.searchTerm&&(e.ContainsText=t.searchTerm),e.Sort=this.getSort(),e.ColumnSelection=this.options.columnSelection||1,e.IncludeColumns=this.getIncludeColumns(),e.ExcludeColumns=this.options.excludeColumns,e.ContainsField=this.options.containsField,e.EqualityFilter=this.options.equalityFilter,e.Criteria=this.getCriteria(t),e.Skip=t.skip||0,e.Take=t.take?t.checkMore?t.take+1:t.take:0,e.IncludeDeleted=this.options.includeDeleted,e.ExcludeTotalCount=!0,e},e.prototype.getServiceCallOptions=function(t,e){return{blockUI:!1,url:this.getServiceUrl(),request:this.getListRequest(t),onSuccess:function(n){var i=n.Entities||[]
;i&&t.take&&t.checkMore&&n.Entities.length>i.length&&(i=i.slice(0,t.take)),e({items:i.slice(0,t.take),more:t.checkMore&&t.take&&i.length>t.take})}}},e.prototype.hasAsyncSource=function(){return!0},e.prototype.asyncSearch=function(t,e){return oe(this.getServiceCallOptions(t,e))},e=S([In.registerEditor("Serenity.ServiceLookupEditorBase")],e)}(Qi),nr=function(t){function e(e,n){return t.call(this,e,n)||this}return _(e,t),e=S([In.registerEditor("Serenity.ServiceLookupEditor")],e)}(er),ir=function(t){function e(e,i){var r=t.call(this,e,i)||this;r._instanceReady=!1,n.includeCKEditor();var o=e.attr("id");return u(o)&&(e.attr("id",r.uniqueName),o=r.uniqueName),null!=r.options.cols&&e.attr("cols",r.options.cols),null!=r.options.rows&&e.attr("rows",r.options.rows),r.addValidationRule(r.uniqueName,(function(t){if(t.hasClass("required")&&null==g(r.get_value()))return v("Validation.Required");return null})),We.executeOnceWhenShown(r.element,(function(){var t=r.getConfig()
;window.CKEDITOR&&window.CKEDITOR.replace(o,t)})),r}var n;return _(e,t),n=e,e.prototype.instanceReady=function(t){this._instanceReady=!0,$(t.editor.container.$).addClass(this.element.attr("class")),this.element.addClass("select2-offscreen").css("display","block"),t.editor.setData(this.element.val()),t.editor.setReadOnly(this.get_readOnly())},e.prototype.getLanguage=function(){var t;if(!window.CKEDITOR)return"en";var e=window.CKEDITOR,n=null!==(t=g($("html").attr("lang")))&&void 0!==t?t:"en";return e.lang.languages[n]?n:(n.indexOf(String.fromCharCode(45))>=0&&(n=n.split(String.fromCharCode(45))[0]),e.lang.languages[n]?n:"en")},e.prototype.getConfig=function(){var t=this;return{customConfig:"",language:this.getLanguage(),bodyClass:"s-HtmlContentBody",on:{instanceReady:function(e){return t.instanceReady(e)},change:function(e){e.editor.updateElement(),t.element.triggerHandler("change")}},toolbarGroups:[{name:"clipboard",groups:["clipboard","undo"]},{name:"editing",
groups:["find","selection","spellchecker"]},{name:"insert",groups:["links","insert","blocks","bidi","list","indent"]},{name:"forms",groups:["forms","mode","document","doctools","others","about","tools"]},{name:"colors"},{name:"basicstyles",groups:["basicstyles","cleanup"]},{name:"align"},{name:"styles"}],removeButtons:"SpecialChar,Anchor,Subscript,Styles",format_tags:"p;h1;h2;h3;pre",removeDialogTabs:"image:advanced;link:advanced",removePlugins:"uploadimage,image2",contentsCss:se("~/Content/site/site.htmlcontent.css"),entities:!1,entities_latin:!1,entities_greek:!1,autoUpdateElement:!0,height:null==this.options.rows||0===this.options.rows?null:20*this.options.rows+"px"}},e.prototype.getEditorInstance=function(){var t=this.element.attr("id");return window.CKEDITOR.instances[t]},e.prototype.destroy=function(){var e=this.getEditorInstance();e&&e.destroy(!0),t.prototype.destroy.call(this)},e.prototype.get_value=function(){var t=this.getEditorInstance()
;return this._instanceReady&&t?t.getData():this.element.val()},Object.defineProperty(e.prototype,"value",{get:function(){return this.get_value()},set:function(t){this.set_value(t)},enumerable:!1,configurable:!0}),e.prototype.set_value=function(t){var e=this.getEditorInstance();this.element.val(t),this._instanceReady&&e&&e.setData(t)},e.prototype.get_readOnly=function(){return!l(this.element.attr("disabled"))},e.prototype.set_readOnly=function(t){if(this.get_readOnly()!==t){t?this.element.attr("disabled","disabled"):this.element.removeAttr("disabled");var e=this.getEditorInstance();this._instanceReady&&e&&e.setReadOnly(t)}},e.getCKEditorBasePath=function(){var t=n.CKEditorBasePath;if(null==t){if("undefined"==typeof CKEDITOR_BASEPATH||!CKEDITOR_BASEPATH)return"~/Scripts/ckeditor/";t=CKEDITOR_BASEPATH}return a(t,"/")?t:t+"/"},e.includeCKEditor=function(){
window.CKEDITOR||($("#CKEditorScript").length>0||$("<script/>").attr("type","text/javascript").attr("id","CKEditorScript").attr("src",se(n.getCKEditorBasePath()+"ckeditor.js?v="+n.CKEditorVer)).appendTo(window.document.head))},e.CKEditorVer="4.7.1",e=n=S([In.registerEditor("Serenity.HtmlContentEditor",[ui,li]),In.element("<textarea/>")],e)}(vi),rr=function(t){function e(e,n){return t.call(this,e,n)||this}return _(e,t),e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return e.removeButtons+=",Cut,Copy,Paste,BulletedList,NumberedList,Indent,Outdent,SpecialChar,Subscript,Superscript,Styles,PasteText,PasteFromWord,Strike,Link,Unlink,CreatePlaceholder,Image,Table,HorizontalRule,Source,Maximize,Format,Font,FontSize,Anchor,Blockquote,CreatePlaceholder,BGColor,JustifyLeft,JustifyCenter,JustifyRight,JustifyBlock,Superscript,RemoveFormat",e.removePlugins="elementspath,uploadimage,image2",e},e=S([In.registerEditor("Serenity.HtmlNoteContentEditor")],e)}(ir),or=function(t){
function e(e,n){return t.call(this,e,n)||this}return _(e,t),e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return e.removeButtons+=",Cut,Copy,Paste,BulletedList,NumberedList,Indent,Outdent,SpecialChar,Subscript,Superscript,Styles,PasteText,PasteFromWord,Strike,Link,Unlink,CreatePlaceholder,Image,Table,HorizontalRule,Source,Maximize,Format,Font,FontSize,Anchor,Blockquote,CreatePlaceholder,BGColor,JustifyLeft,JustifyCenter,JustifyRight,JustifyBlock,Superscript,RemoveFormat",e.removePlugins="elementspath,uploadimage,image2",e},e=S([In.registerEditor("Serenity.HtmlReportContentEditor")],e)}(ir),ar=function(t){function e(e,n){var i,r=t.call(this,e,n)||this;return e.mask(r.options.mask||"",{placeholder:null!==(i=r.options.placeholder)&&void 0!==i?i:"_"}),r}return _(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.element.triggerHandler("blur.mask"),this.element.val()},set:function(t){this.element.val(t)},enumerable:!1,configurable:!0}),
e.prototype.get_value=function(){return this.value},e.prototype.set_value=function(t){this.value=t},e=S([In.registerEditor("Serenity.MaskedEditor",[ui]),In.element('<input type="text"/>')],e)}(vi),lr=function(t){function e(e,n){var i,r=t.call(this,e,n)||this;if(r.element.addClass("g-recaptcha").attr("data-sitekey",r.options.siteKey),null==window.grecaptcha&&0===$("script#RecaptchaInclude").length){var o="https://www.google.com/recaptcha/api.js",a=r.options.language;null==a&&(a=null!==(i=$("html").attr("lang"))&&void 0!==i?i:""),o+="?hl="+a,$("<script/>").attr("id","RecaptchaInclude").attr("src",o).appendTo(document.body)}var s={visibility:"hidden",width:"0px",height:"0px",padding:"0px"};return en($("<input />").insertBefore(r.element).attr("id",r.uniqueName+"_validate").val("x").css(s),r.uniqueName,(function(t){return l(r.get_value())?v("Validation.Required"):null})),r}return _(e,t),e.prototype.get_value=function(){return this.element.find(".g-recaptcha-response").val()},
e.prototype.set_value=function(t){},e=S([In.registerEditor("Serenity.Recaptcha",[ui]),In.element("<div/>")],e)}(vi),sr=function(t){function e(e,n){var i=t.call(this,e,n)||this;n&&null!=n.allowNonImage||(i.options.allowNonImage=!0),e.addClass("s-FileUploadEditor"),l(i.options.originalNameProperty)&&e.addClass("hide-original-name"),i.toolbar=new Ii($("<div/>").appendTo(i.element),{buttons:i.getToolButtons()}),$("<div><div></div></div>").addClass("upload-progress").prependTo(i.toolbar.element);var r=i.getUploadInputOptions();return i.uploadInput=Ci.addUploadInput(r),i.fileSymbols=$("<ul/>").appendTo(i.element),i.element.attr("id")||i.element.attr("id",i.uniqueName),i.hiddenInput=$('<input type="text" class="s-offscreen" name="'+i.uniqueName+'_Validator" data-vx-highlight="'+i.element.attr("id")+'"/>').appendTo(i.element),i.updateInterface(),i}return _(e,t),e.prototype.getUploadInputOptions=function(){var t=this;return{container:this.toolbar.findButton("add-file-button"),zone:this.element,
inputName:this.uniqueName,progress:this.progress,fileDone:function(e,n,i){if(Ci.checkImageConstraints(e,t.options)){var r={OriginalName:n,Filename:e.TemporaryFile};t.entity=r,t.populate(),t.updateInterface();var o=t.hiddenInput.closest("form").data("validator");null!=o&&o.element(t.hiddenInput)}}}},e.prototype.addFileButtonText=function(){return v("Controls.ImageUpload.AddFileButton")},e.prototype.getToolButtons=function(){var t=this;return[{title:this.addFileButtonText(),cssClass:"add-file-button",onClick:function(){}},{title:"",hint:v("Controls.ImageUpload.DeleteButtonHint"),cssClass:"delete-button",onClick:function(){t.entity=null,t.populate(),t.updateInterface();var e=t.hiddenInput.closest("form").data("validator");null!=e&&e.element(t.hiddenInput)}}]},e.prototype.populate=function(){var t=this.options.displayFileName||!u(this.options.originalNameProperty)
;null==this.entity?Ci.populateFileSymbols(this.fileSymbols,null,t,this.options.urlPrefix):Ci.populateFileSymbols(this.fileSymbols,[this.entity],t,this.options.urlPrefix),this.hiddenInput.val(g((this.get_value()||{}).Filename))},e.prototype.updateInterface=function(){var t=this.toolbar.findButton("add-file-button"),e=this.toolbar.findButton("delete-button");t.toggleClass("disabled",this.get_readOnly()),e.toggleClass("disabled",this.get_readOnly()||null==this.entity)},e.prototype.get_readOnly=function(){return null!=this.uploadInput.attr("disabled")},e.prototype.set_readOnly=function(t){if(this.get_readOnly()!==t){if(t){this.uploadInput.attr("disabled","disabled");try{this.uploadInput.fileupload("disable")}catch(t){}}else{this.uploadInput.removeAttr("disabled");try{this.uploadInput.fileupload("enable")}catch(t){}}this.updateInterface()}},e.prototype.get_required=function(){return this.hiddenInput.hasClass("required")},e.prototype.set_required=function(t){
this.hiddenInput.toggleClass("required",!!t)},e.prototype.get_value=function(){return null==this.entity?null:P({},this.entity)},Object.defineProperty(e.prototype,"value",{get:function(){return this.get_value()},set:function(t){this.set_value(t)},enumerable:!1,configurable:!0}),e.prototype.set_value=function(t){if("string"==typeof(e=t)){var e=g(e);if(null!=t){var n=e.indexOf("/");n<0&&(n=e.indexOf("\\")),t={Filename:t,OriginalName:e.substring(n+1)}}}else null!=t&&u(t.Filename)&&(t=null);null!=t?null==t.Filename?this.entity=null:this.entity=P({},t):this.entity=null,this.populate();var i=this.hiddenInput.closest("form").data("validator");null!=i&&i.element(this.hiddenInput),this.updateInterface()},e.prototype.getEditValue=function(t,e){e[t.name]=null==this.entity?null:g(this.entity.Filename)},e.prototype.setEditValue=function(t,e){var n,i={};if(i.Filename=t[e.name],l(this.options.originalNameProperty)){if(this.options.displayFileName){
var r=null!==(n=i.Filename)&&void 0!==n?n:"",o=m(r,"\\","/").lastIndexOf("/");i.OriginalName=o>=0?r.substr(o+1):r}}else i.OriginalName=t[this.options.originalNameProperty];this.set_value(i)},e=S([In.registerEditor("Serenity.FileUploadEditor",[li,ai,si,ci]),In.element("<div/>")],e)}(vi),ur=function(t){function e(e,n){var i=t.call(this,e,n)||this;return n&&null==n.allowNonImage&&(i.options.allowNonImage=!1),e.addClass("s-ImageUploadEditor"),i}return _(e,t),e=S([In.registerEditor("Serenity.ImageUploadEditor")],e)}(sr),cr=function(t){function e(e,n){var i=t.call(this,e,n)||this;i.entities=[],e.addClass("s-MultipleFileUploadEditor");var r=i;i.toolbar=new Ii($("<div/>").appendTo(i.element),{buttons:i.getToolButtons()});var o=$("<div><div></div></div>").addClass("upload-progress").prependTo(i.toolbar.element),a=i.toolbar.findButton("add-file-button");return i.uploadInput=Ci.addUploadInput({container:a,zone:i.element,inputName:i.uniqueName,progress:o,fileDone:function(t,e,n){
if(Ci.checkImageConstraints(t,i.options)){var o={OriginalName:e,Filename:t.TemporaryFile};r.entities.push(o),r.populate();var a=i.hiddenInput.closest("form").data("validator");null!=a&&a.element(i.hiddenInput),r.updateInterface()}}}),i.fileSymbols=$("<ul/>").appendTo(i.element),i.element.attr("id")||i.element.attr("id",i.uniqueName),i.hiddenInput=$('<input type="text" class="s-offscreen" name="'+i.uniqueName+'_Validator" data-vx-highlight="'+i.element.attr("id")+'"/>').appendTo(i.element),i.updateInterface(),i}return _(e,t),e.prototype.addFileButtonText=function(){return v("Controls.ImageUpload.AddFileButton")},e.prototype.getToolButtons=function(){return[{title:this.addFileButtonText(),cssClass:"add-file-button",onClick:function(){}}]},e.prototype.populate=function(){var t=this;Ci.populateFileSymbols(this.fileSymbols,this.entities,!0,this.options.urlPrefix),this.fileSymbols.children().each((function(e,n){var i=e
;$("<a class='delete'></a>").appendTo($(n).children(".filename")).click((function(e){e.preventDefault(),t.entities.splice(i,1),t.populate();var n=t.hiddenInput.closest("form").data("validator");null!=n&&n.element(t.hiddenInput)}))})),this.hiddenInput.val(g((this.get_value()[0]||{}).Filename))},e.prototype.updateInterface=function(){this.toolbar.findButton("add-file-button").toggleClass("disabled",this.get_readOnly()),this.fileSymbols.find("a.delete").toggle(!this.get_readOnly())},e.prototype.get_readOnly=function(){return null!=this.uploadInput.attr("disabled")},e.prototype.set_readOnly=function(t){if(this.get_readOnly()!==t){if(t){this.uploadInput.attr("disabled","disabled");try{this.uploadInput.fileupload("disable")}catch(t){}}else{this.uploadInput.removeAttr("disabled");try{this.uploadInput.fileupload("enable")}catch(t){}}this.updateInterface()}},e.prototype.get_required=function(){return this.hiddenInput.hasClass("required")},e.prototype.set_required=function(t){
this.hiddenInput&&this.hiddenInput.toggleClass("required",!!t)},e.prototype.get_value=function(){return this.entities.map((function(t){return P({},t)}))},Object.defineProperty(e.prototype,"value",{get:function(){return this.get_value()},set:function(t){this.set_value(t)},enumerable:!1,configurable:!0}),e.prototype.set_value=function(t){this.entities=(t||[]).map((function(t){return P({},t)})),this.populate(),this.updateInterface()},e.prototype.getEditValue=function(t,e){this.jsonEncodeValue?e[t.name]=JSON.stringify(this.get_value()):e[t.name]=this.get_value()},e.prototype.setEditValue=function(t,e){var n,i=t[e.name];if(q(i,String)){var r=null!==(n=g(i))&&void 0!==n?n:"[]";d(r,"[")&&a(r,"]")?this.set_value($.parseJSON(r)):this.set_value([{Filename:r,OriginalName:"UnknownFile"}])}else this.set_value(i)},S([In.option()],e.prototype,"jsonEncodeValue",void 0),e=S([In.registerEditor("Serenity.MultipleFileUploadEditor",[li,ai,si,ci]),In.element("<div/>")],e)}(vi),dr=function(t){
function e(e,n){var i=t.call(this,e,n)||this;return e.addClass("s-MultipleImageUploadEditor"),i}return _(e,t),e=S([In.registerEditor("Serenity.MultipleImageUploadEditor")],e)}(cr),pr=function(t){function e(e,n){var i,r=t.call(this,e,n)||this;e.addClass("quick-filters-bar").addClass("clear");for(var o=r.options.filters,a=0;a<o.length;a++){var l=o[a];r.add(l)}return r.options.idPrefix=null!==(i=r.options.idPrefix)&&void 0!==i?i:r.uniqueName+"_",r}var n;return _(e,t),n=e,e.prototype.addSeparator=function(){this.element.append($("<hr/>"))},e.prototype.add=function(t){var e=this;if(null==t)throw new ft("opt");t.separator&&this.addSeparator();var n=$("<div class='quick-filter-item'><span class='quick-filter-label'></span></div>").appendTo(this.element).data("qffield",t.field).children(),i=t.title;null==i&&null==(i=this.options.getTitle?this.options.getTitle(t):null)&&(i=t.field);var r=n.text(i).parent();null!=t.displayText&&r.data("qfdisplaytext",t.displayText),
null!=t.saveState&&r.data("qfsavestate",t.saveState),null!=t.loadState&&r.data("qfloadstate",t.loadState),l(t.cssClass)||r.addClass(t.cssClass);var o=vi.create({type:t.type,element:function(n){l(t.field)||n.attr("id",e.options.idPrefix+t.field),n.attr("placeholder"," "),n.appendTo(r),null!=t.element&&t.element(n)},options:t.options,init:t.init}),a=function(e){if(!r.hasClass("ignore")){e.EqualityFilter=e.EqualityFilter||{};var n=_i.getValue(o),i=null!=n&&!l(n.toString());if(null!=t.handler){var a={field:t.field,request:e,equalityFilter:e.EqualityFilter,value:n,active:i,widget:o,handled:!0};t.handler(a),r.toggleClass("quick-filter-active",a.active),a.handled||(e.EqualityFilter[t.field]=n)}else e.EqualityFilter[t.field]=n,r.toggleClass("quick-filter-active",i)}};return o.changeSelect2((function(t){window.setTimeout((function(){return e.onChange&&e.onChange(t)}),0)})),this.add_submitHandlers(a),o.element.bind("remove."+this.uniqueName,(function(t){e.remove_submitHandlers(a)})),o},
e.prototype.addDateRange=function(t,e){return this.add(n.dateRange(t,e))},e.dateRange=function(t,e){var n=null;return{field:t,type:qi,title:e,element:function(t){(n=vi.create({type:qi,element:function(e){e.insertAfter(t)},options:null,init:null})).element.change((function(e){t.triggerHandler("change")})),$("<span/>").addClass("range-separator").text("-").insertAfter(t)},handler:function(t){var e=!u(t.widget.value),i=!u(n.value);if(e&&!Ae(t.widget.element.val())&&(e=!1,bt(v("Validation.DateInvalid"),"",null),t.widget.element.val("")),i&&!Ae(n.element.val())&&(i=!1,bt(v("Validation.DateInvalid"),"",null),n.element.val("")),t.active=e||i,e&&(t.request.Criteria=di.join(t.request.Criteria,"and",[[t.field],">=",t.widget.value])),i){var r=new Date(n.valueAsDate.valueOf());r.setDate(r.getDate()+1),t.request.Criteria=di.join(t.request.Criteria,"and",[[t.field],"<",Ie(r,"yyyy-MM-dd")])}},displayText:function(t,e){var i,r=_i.getDisplayText(t),o=_i.getDisplayText(n);if(l(r)&&l(o))return null
;var a=e+" >= "+r,s=e+" <= "+o;return l(r)||l(o)?l(r)?s:a:a+" "+(null!==(i=b("Controls.FilterPanel.And"))&&void 0!==i?i:"and")+" "+s},saveState:function(t){return[_i.getValue(t),_i.getValue(n)]},loadState:function(t,e){null!=e&&i(e)&&2===e.length||(e=[null,null]),_i.setValue(t,e[0]),_i.setValue(n,e[1])}}},e.prototype.addDateTimeRange=function(t,e){return this.add(n.dateTimeRange(t,e))},e.dateTimeRange=function(t,e,n){var r=null;return{field:t,type:zi,title:e,element:function(t){(r=vi.create({type:zi,element:function(e){e.insertAfter(t)},options:null==n?null:{useUtc:n},init:null})).element.change((function(e){t.triggerHandler("change")})),$("<span/>").addClass("range-separator").text("-").insertAfter(t)},init:function(t){t.element.parent().find(".time").change((function(e){t.element.triggerHandler("change")}))},handler:function(t){var e=!u(t.widget.value),n=!u(r.value);e&&!Ae(t.widget.element.val())&&(e=!1,bt(v("Validation.DateInvalid"),"",null),t.widget.element.val("")),
n&&!Ae(r.element.val())&&(n=!1,bt(v("Validation.DateInvalid"),"",null),r.element.val("")),t.active=e||n,e&&(t.request.Criteria=di.join(t.request.Criteria,"and",[[t.field],">=",t.widget.value])),n&&(t.request.Criteria=di.join(t.request.Criteria,"and",[[t.field],"<=",r.value]))},displayText:function(t,e){var n,i=_i.getDisplayText(t),o=_i.getDisplayText(r);if(l(i)&&l(o))return null;var a=e+" >= "+i,s=e+" <= "+o;return l(i)||l(o)?l(i)?s:a:a+" "+(null!==(n=b("Controls.FilterPanel.And"))&&void 0!==n?n:"and")+" "+s},saveState:function(t){return[_i.getValue(t),_i.getValue(r)]},loadState:function(t,e){null!=e&&i(e)&&2===e.length||(e=[null,null]),_i.setValue(t,e[0]),_i.setValue(r,e[1])},options:null==n?null:{useUtc:n}}},e.prototype.addBoolean=function(t,e,i,r){return this.add(n.boolean(t,e,i,r))},e.boolean=function(t,e,n,i){var r={},o=[],a=n;null==a&&(a=v("Controls.FilterPanel.OperatorNames.true")),o.push(["1",a]);var s=i;return null==s&&(s=v("Controls.FilterPanel.OperatorNames.false")),
o.push(["0",s]),r.items=o,{field:t,type:Yi,title:e,options:r,handler:function(t){t.equalityFilter[t.field]=null==t.value||l(t.value.toString())?null:!!Se(t.value)}}},e.prototype.destroy=function(){this.submitHandlers=null,t.prototype.destroy.call(this)},e.prototype.onSubmit=function(t){this.submitHandlers&&this.submitHandlers(t)},e.prototype.add_submitHandlers=function(t){this.submitHandlers=Y(this.submitHandlers,t)},e.prototype.remove_submitHandlers=function(t){this.submitHandlers=Z(this.submitHandlers,t)},e.prototype.clear_submitHandlers=function(){},e.prototype.find=function(t,e){return $("#"+this.options.idPrefix+e).getWidget(t)},e.prototype.tryFind=function(t,e){var n=$("#"+this.options.idPrefix+e);return n.length?n.tryGetWidget(t):null},e=n=S([In.registerClass("Serenity.QuickFilterBar"),In.element("<div/>")],e)}(vi),hr=function(t){function e(e,n){var i,r,o=t.call(this,e,n)||this
;e.attr("title",v("Controls.QuickSearch.Hint")).attr("placeholder",v("Controls.QuickSearch.Placeholder")),o.lastValue=h(null!==(i=e.val())&&void 0!==i?i:"");var a=o;if(o.element.bind("keyup."+o.uniqueName,(function(){a.checkIfValueChanged()})),o.element.bind("change."+o.uniqueName,(function(){a.checkIfValueChanged()})),$("<span><i></i></span>").addClass("quick-search-icon").insertBefore(e),T(o.options.fields)&&o.options.fields.length>0){for(var l=$("<a/>").addClass("quick-search-field").attr("title",v("Controls.QuickSearch.FieldSelection")).insertBefore(e),s=$("<ul></ul>").css("width","120px"),u=0,c=o.options.fields;u<c.length;u++){var d=c[u],p={$:d};$("<li><a/></li>").appendTo(s).children().attr("href","#").text(null!==(r=d.title)&&void 0!==r?r:"").click(function(t){t.preventDefault(),this.$this.fieldChanged=a.field!==this.field.$,a.field=this.field.$,this.$this.updateInputPlaceHolder(),this.$this.checkIfValueChanged()}.bind({field:p,$this:o}))}new Si(l,{positionMy:"right top",
positionAt:"right bottom",menu:s}),o.field=o.options.fields[0],o.updateInputPlaceHolder()}return o.element.bind("execute-search."+o.uniqueName,(function(t){var e;o.timer&&window.clearTimeout(o.timer),o.searchNow(h(null!==(e=o.element.val())&&void 0!==e?e:""))})),o}return _(e,t),e.prototype.checkIfValueChanged=function(){var t;if(!this.element.hasClass("ignore-change")){var e=this.get_value();if(e!=this.lastValue||this.fieldChanged&&!l(e)){this.fieldChanged=!1,this.timer&&window.clearTimeout(this.timer);var n=this;this.timer=window.setTimeout((function(){n.searchNow(e)}),null!==(t=this.options.typeDelay)&&void 0!==t?t:500),this.lastValue=e}else this.fieldChanged=!1}},e.prototype.get_value=function(){var t;return h(null!==(t=this.element.val())&&void 0!==t?t:"")},e.prototype.get_field=function(){return this.field},e.prototype.set_field=function(t){this.field!==t&&(this.fieldChanged=!0,this.field=t,this.updateInputPlaceHolder(),this.checkIfValueChanged())},
e.prototype.updateInputPlaceHolder=function(){var t=this.element.prevAll(".quick-search-field");this.field?t.text(this.field.title):t.text("")},e.prototype.restoreState=function(t,e){this.fieldChanged=!1,this.field=e;t=h(null!=t?t:"");this.element.val(t),this.lastValue=t,this.timer&&(window.clearTimeout(this.timer),this.timer=null),this.updateInputPlaceHolder()},e.prototype.searchNow=function(t){var e,n,i,r=this;this.element.parent().toggleClass(null!==(e=this.options.filteredParentClass)&&void 0!==e?e:"s-QuickSearchFiltered",!!(t.length>0)),this.element.parent().addClass(null!==(n=this.options.loadingParentClass)&&void 0!==n?n:"s-QuickSearchLoading").addClass(null!==(i=this.options.loadingParentClass)&&void 0!==i?i:"s-QuickSearchLoading");var o=function(t){var e,n;r.element.removeClass(null!==(e=r.options.loadingParentClass)&&void 0!==e?e:"s-QuickSearchLoading").parent().removeClass(null!==(n=r.options.loadingParentClass)&&void 0!==n?n:"s-QuickSearchLoading"),
t||r.element.closest(".s-QuickSearchBar").find(".quick-search-icon i").effect("shake",{distance:2})};null!=this.options.onSearch?this.options.onSearch(null==this.field||l(this.field.name)?null:this.field.name,t,o):o(!0)},e}(vi);"undefined"!=typeof $&&$.fn&&($.fn.flexHeightOnly=function(t){return void 0===t&&(t=1),this.flexWidthHeight(0,t)},$.fn.flexWidthOnly=function(t){return void 0===t&&(t=1),this.flexWidthHeight(t,0)},$.fn.flexWidthHeight=function(t,e){return void 0===t&&(t=1),void 0===e&&(e=1),this.addClass("flexify").data("flex-x",t).data("flex-y",e)},$.fn.flexX=function(t){return this.data("flex-x",t)},$.fn.flexY=function(t){return this.data("flex-y",t)});var fr,gr=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.xDifference=0,i.yDifference=0,We.executeOnceWhenShown(e,(function(){i.storeInitialSize()})),i}return _(e,t),e.prototype.storeInitialSize=function(){var t=this;if(!this.element.data("flexify-init")){var e=this.options.designWidth
;null==e&&(e=this.element.width()),this.element.data("flexify-width",e);var n=this.options.designHeight;null==n&&(n=this.element.height()),this.element.data("flexify-height",n),this.element.data("flexify-init",!0),this.element.on("resize."+this.uniqueName,(function(){return t.resizeElements()})),this.element.on("resizestop."+this.uniqueName,(function(){return t.resizeElements()}));var i=this.element.find(".ui-tabs");i.length>0&&i.on("tabsactivate."+this.uniqueName,(function(){return t.resizeElements()})),null==this.options.designWidth&&null==this.options.designHeight||this.resizeElements()}},e.prototype.getXFactor=function(t){var e=null;return null!=this.options.getXFactor&&(e=this.options.getXFactor(t)),null==e&&(e=t.data("flex-x")),null!=e?e:1},e.prototype.getYFactor=function(t){var e=null;return null!=this.options.getYFactor&&(e=this.options.getYFactor(t)),null==e&&(e=t.data("flex-y")),null!=e?e:0},e.prototype.resizeElements=function(){
var t=this,e=this.element.width(),n=this.element.data("flexify-width");null==n&&(this.element.data("flexify-width",e),n=e);var i=this.element.height(),r=this.element.data("flexify-height");null==r&&(this.element.data("flexify-height",i),r=i),this.xDifference=e-n,this.yDifference=i-r;var o=this.element,a=this.element.find(".ui-tabs-panel");a.length>0&&(o=a.filter(":visible")),o.find(".flexify").add(a.filter(".flexify:visible")).each((function(e,n){t.resizeElement($(n))}))},e.prototype.resizeElement=function(t){var e=this.getXFactor(t);if(0!==e){var n=t.data("flexify-width");if(null==n){var i=t.width();t.data("flexify-width",i),n=i}t.width(n+e*this.xDifference|0)}var r=this.getYFactor(t);if(0!==r){var o=t.data("flexify-height");if(null==o){var a=t.height();t.data("flexify-height",a),o=a}t.height(o+r*this.yDifference|0)}t.hasClass("require-layout")&&t.triggerHandler("layout")},e}(vi);!function(t){t.dialogResizable=function(t,e,n,i,r){var o=t.dialog()
;return o.dialog("option","resizable",!0),null!=i&&o.dialog("option","minWidth",i),null!=e&&o.dialog("option","width",e),null!=r&&o.dialog("option","minHeight",r),null!=n&&o.dialog("option","height",n),t},t.dialogMaximizable=function(t){return t.dialogExtend({closable:!0,maximizable:!0,dblclick:"maximize",icons:{maximize:"ui-icon-maximize-window"}}),t},t.dialogFlexify=function(t){return new gr(t.closest(".ui-dialog"),{}),t}}(fr||(fr={}));var mr,yr=function(t){function e(e){var n=t.call(this,At().addClass("s-TemplatedDialog hidden"),e)||this;return n.element.attr("id",n.uniqueName),n.initValidator(),n.initTabs(),n.initToolbar(),n}var n;return _(e,t),n=e,Object.defineProperty(e.prototype,"isMarkedAsPanel",{get:function(){var t=j(R(this),Un,!0);return t.length>0&&!1!==t[t.length-1].value},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isResponsive",{get:function(){return St.responsiveDialogs||j(R(this),Jn,!0).length>0},enumerable:!1,configurable:!0}),
e.getCssSize=function(t,e){var n=t.css(e);if(null==n)return null;if(!a(n,"px"))return null;var i=we(n=n.substr(0,n.length-2));return null==i||isNaN(i)||0==i?null:i},e.applyCssSizes=function(t,e){var i,r=$("<div/>").hide().addClass(e).appendTo(document.body);try{var o=$("<div/>").addClass("size").appendTo(r);null!=(i=n.getCssSize(o,"minWidth"))&&(t.minWidth=i),null!=(i=n.getCssSize(o,"width"))&&(t.width=i),null!=(i=n.getCssSize(o,"height"))&&(t.height=i),null!=(i=n.getCssSize(o,"minHeight"))&&(t.minHeight=i)}finally{r.remove()}},e.prototype.destroy=function(){if(this.tabs&&this.tabs.tabs("destroy"),this.tabs=null,this.toolbar&&this.toolbar.destroy(),this.toolbar=null,this.validator&&this.byId("Form").remove(),this.validator=null,null!=this.element&&this.element.hasClass("ui-dialog-content"))this.element.dialog("destroy"),this.element.removeClass("ui-dialog-content");else if(null!=this.element&&this.element.hasClass("modal-body")){
var e=this.element.closest(".modal").data("bs.modal",null);this.element&&this.element.removeClass("modal-body"),window.setTimeout((function(){return e.remove()}),0)}$(window).unbind("."+this.uniqueName),t.prototype.destroy.call(this)},e.prototype.initDialog=function(){var t=this;if(!this.element.hasClass("ui-dialog-content")){this.element.removeClass("hidden"),this.element.dialog(this.getDialogOptions()),this.element.closest(".ui-dialog").on("resize",(function(e){return t.arrange()}));var e=R(this);this.isResponsive?(fr.dialogResizable(this.element),$(window).bind("resize."+this.uniqueName,(function(e){t.element&&t.element.is(":visible")&&t.handleResponsive()})),this.element.closest(".ui-dialog").addClass("flex-layout")):fr.dialogFlexify&&j(e,On,!0).length>0&&(fr.dialogFlexify(this.element),fr.dialogResizable(this.element)),j(e,Ln,!0).length>0&&fr.dialogMaximizable(this.element);var n=this;this.element.bind("dialogopen."+this.uniqueName,(function(){
$(document.body).addClass("modal-dialog-open"),t.isResponsive&&t.handleResponsive(),n.onDialogOpen()})),this.element.bind("dialogclose."+this.uniqueName,(function(){$(document.body).toggleClass("modal-dialog-open",$(".ui-dialog:visible").length>0),n.onDialogClose()}))}},e.prototype.getModalOptions=function(){return{backdrop:!1,keyboard:!1,size:"lg",modalClass:this.getCssClass()}},e.prototype.initModal=function(){var t,e,n=this;if(!this.element.hasClass("modal-body")){var i=null!==(e=null!==(t=this.element.data("dialogtitle"))&&void 0!==t?t:this.getDialogTitle())&&void 0!==e?e:"",r=this.getModalOptions();r.show=!1;var o="s-Modal";r.modalClass&&(o+=" "+r.modalClass);var a=zt(i,"",o),l=$(a).eq(0).appendTo(document.body).addClass("flex-layout");l.one("shown.bs.modal."+this.uniqueName,(function(){n.element.triggerHandler("shown.bs.modal"),n.onDialogOpen()})),l.one("hidden.bs.modal."+this.uniqueName,(function(){
$(document.body).toggleClass("modal-open",$(".modal.show").length+$(".modal.in").length>0),n.onDialogClose()})),r.size&&l.find(".modal-dialog").addClass("modal-"+r.size);var s=l.find(".modal-footer"),u=this.getDialogButtons();if(null!=u)for(var c=0,d=u;c<d.length;c++){var p=d[c];$(Ht(p)).appendTo(s).click(p.click)}else s.hide();l.modal(r),l.find(".modal-body").replaceWith(this.element.removeClass("hidden").addClass("modal-body")),$(window).on("resize."+this.uniqueName,this.arrange.bind(this))}},e.prototype.initToolbar=function(){var t=this.byId("Toolbar");if(0!==t.length){var e=this.element.closest(".ui-dialog");0===e.length&&0==(e=this.element.closest(".modal")).length&&(e=this.element);var n={buttons:this.getToolbarButtons(),hotkeyContext:e[0]};this.toolbar=new Ii(t,n)}},e.prototype.getToolbarButtons=function(){return[]},e.prototype.getValidatorOptions=function(){return{}},e.prototype.initValidator=function(){var t=this.byId("Form");if(t.length>0){var e=this.getValidatorOptions()
;this.validator=t.validate(an(e))}},e.prototype.resetValidation=function(){this.validator&&this.validator.resetAll()},e.prototype.validateForm=function(){return null==this.validator||!!this.validator.form()},e.prototype.dialogOpen=function(t){var e=this;(t=null!=t?t:this.isMarkedAsPanel)?(this.element.hasClass("s-Panel")||(this.element.on("panelopen."+this.uniqueName,(function(){e.onDialogOpen()})),this.element.on("panelclose."+this.uniqueName,(function(){e.onDialogClose()}))),n.openPanel(this.element,this.uniqueName),this.setupPanelTitle()):this.useBSModal()?(this.initModal(),this.element.closest(".modal").modal("show")):(this.initDialog(),this.element.dialog("open"))},e.prototype.useBSModal=function(){return!($.ui&&$.ui.dialog&&!n.bootstrapModal)},e.openPanel=function(t,e){var n=$(".panels-container");n.length||(n=$("section.content")),t.data("paneluniquename",e),n.length&&((n=n.last()).children().not(t).not(".panel-hidden").addClass("panel-hidden panel-hidden-"+e),
t[0].parentElement!==n[0]&&t.appendTo(n)),$(".ui-dialog:visible, .ui-widget-overlay:visible, .modal.show, .modal.in").not(t).addClass("panel-hidden panel-hidden-"+e),t.removeClass("hidden").removeClass("panel-hidden").addClass("s-Panel").trigger("panelopen")},e.closePanel=function(t,e){return Zt(t,e)},e.prototype.onDialogOpen=function(){$(document.documentElement).hasClass("mobile-device")||$(":input",this.element).not("button").eq(0).focus(),this.arrange(),this.tabs&&this.tabs.tabs("option","active",0)},e.prototype.arrange=function(){this.element.find(".require-layout").filter(":visible").each((function(t,e){$(e).triggerHandler("layout")}))},e.prototype.onDialogClose=function(){var t=this;$(document).trigger("click"),$.qtip&&$(document.body).children(".qtip").each((function(t,e){$(e).qtip("hide")})),window.setTimeout((function(){var e=t.element;t.destroy(),e.remove(),_t(!1,null)}),0)},e.prototype.addCssClass=function(){this.isMarkedAsPanel&&(t.prototype.addCssClass.call(this),
this.isResponsive&&this.element.addClass("flex-layout"))},e.prototype.getDialogButtons=function(){},e.prototype.getDialogOptions=function(){var t,e,i={},r="s-Dialog "+this.getCssClass();i.dialogClass=r;var o=this.getDialogButtons();null!=o&&(i.buttons=o.map(jt)),i.width=920,n.applyCssSizes(i,r),i.autoOpen=!1;var a=R(this);return i.resizable=j(a,Yn,!0).length>0,i.modal=!0,i.position={my:"center",at:"center",of:$(window.window)},i.title=null!==(e=null!==(t=this.element.data("dialogtitle"))&&void 0!==t?t:this.getDialogTitle())&&void 0!==e?e:"",i},e.prototype.getDialogTitle=function(){return""},e.prototype.dialogClose=function(){this.element.hasClass("ui-dialog-content")?this.element.dialog().dialog("close"):this.element.hasClass("modal-body")?this.element.closest(".modal").modal("hide"):this.element.hasClass("s-Panel")&&!this.element.hasClass("hidden")&&n.closePanel(this.element)},Object.defineProperty(e.prototype,"dialogTitle",{get:function(){
return this.element.hasClass("ui-dialog-content")?this.element.dialog("option","title"):this.element.hasClass("modal-body")?this.element.closest(".modal").find(".modal-header").children("h5").text():this.element.data("dialogtitle")},set:function(t){var e=this.dialogTitle;this.element.data("dialogtitle",t),this.element.hasClass("ui-dialog-content")?this.element.dialog("option","title",t):this.element.hasClass("modal-body")?this.element.closest(".modal").find(".modal-header").children("h5").text(null!=t?t:""):this.element.hasClass("s-Panel")&&e!=this.dialogTitle&&(this.setupPanelTitle(),this.arrange())},enumerable:!1,configurable:!0}),e.prototype.setupPanelTitle=function(){var t,e=this,i=null!==(t=this.dialogTitle)&&void 0!==t?t:this.getDialogTitle(),r=this.element.children(".panel-titlebar");l(i)?r.remove():(this.element.children(".panel-titlebar").length||(r=$("<div class='panel-titlebar'><div class='panel-titlebar-text'></div></div>").prependTo(this.element)),
r.children(".panel-titlebar-text").text(i),this.element.hasClass("s-Panel")&&(r.children(".panel-titlebar-close").length||$('<button class="panel-titlebar-close">&nbsp;</button>').prependTo(r).click((function(t){n.closePanel(e.element,t)}))))},e.prototype.set_dialogTitle=function(t){this.dialogTitle=t},e.prototype.initTabs=function(){var t=this,e=this.byId("Tabs");0!==e.length&&(this.tabs=e.tabs({}),this.tabs.bind("tabsactivate",(function(){return t.arrange()})))},e.prototype.handleResponsive=function(){var t=this.element.dialog(),e=this.element.closest(".ui-dialog");if($(document.documentElement).hasClass("mobile-device")){var n=this.element.data("responsiveData");if(!n){(n={}).draggable=t.dialog("option","draggable"),n.resizable=t.dialog("option","resizable"),n.position=t.css("position");var i=e.position();n.left=i.left,n.top=i.top,n.width=e.width(),n.height=e.height(),n.contentHeight=this.element.height(),this.element.data("responsiveData",n),t.dialog("option","draggable",!1),
t.dialog("option","resizable",!1)}e.addClass("mobile-layout"),e.css({left:"0px",top:"0px",width:$(window).width()+"px",height:$(window).height()+"px",position:"fixed"}),$(document.body).scrollTop(0),sn(this.element)}else{var r=this.element.data("responsiveData");r&&(t.dialog("option","draggable",r.draggable),t.dialog("option","resizable",r.resizable),this.element.closest(".ui-dialog").css({left:"0px",top:"0px",width:r.width+"px",height:r.height+"px",position:r.position}),this.element.height(r.contentHeight),e.removeClass("mobile-layout"),this.element.removeData("responsiveData"))}},e=n=S([In.registerClass([ri])],e)}(wi),vr=function(t){function e(e){var n=t.call(this,e)||this;return n.initPropertyGrid(),n.loadInitialEntity(),n}return _(e,t),e.prototype.destroy=function(){this.propertyGrid&&(this.propertyGrid.destroy(),this.propertyGrid=null),this.validator&&(this.byId("Form").remove(),this.validator=null),t.prototype.destroy.call(this)},e.prototype.getDialogOptions=function(){
var e=t.prototype.getDialogOptions.call(this);return e.width=400,e},e.prototype.getDialogButtons=function(){var e=this;return t.prototype.getDialogButtons.call(this),[{text:v("Dialogs.OkButton"),cssClass:"btn btn-primary",click:function(){return e.okClick()}},{text:v("Dialogs.CancelButton"),click:function(){return e.cancelClick()}}]},e.prototype.okClick=function(){this.validateBeforeSave()&&this.okClickValidated()},e.prototype.okClickValidated=function(){this.dialogClose()},e.prototype.cancelClick=function(){this.dialogClose()},e.prototype.initPropertyGrid=function(){var t=this.byId("PropertyGrid");if(!(t.length<=0)){var e=this.getPropertyGridOptions();this.propertyGrid=new Ei(t,e).init(null),this.element.closest(".ui-dialog").hasClass("s-Flexify")&&this.propertyGrid.element.children(".categories").flexHeightOnly(1)}},e.prototype.getFormKey=function(){var t=j(R(this),Dn,!0);if(t.length>=1)return t[0].value;var e=V(R(this)),n=e.indexOf(".");return n>=0&&(e=e.substring(n+1)),
a(e,"Dialog")?e=e.substr(0,e.length-6):a(e,"Panel")&&(e=e.substr(0,e.length-5)),e},e.prototype.getPropertyGridOptions=function(){return{idPrefix:this.idPrefix,items:this.getPropertyItems(),mode:1,useCategories:!1,localTextPrefix:"Forms."+this.getFormKey()+"."}},e.prototype.getPropertyItems=function(){return qe(this.getFormKey())},e.prototype.getSaveEntity=function(){var t=new Object;return this.propertyGrid&&this.propertyGrid.save(t),t},e.prototype.loadInitialEntity=function(){this.propertyGrid&&this.propertyGrid.load(new Object)},e.prototype.get_entity=function(){return this._entity},e.prototype.set_entity=function(t){this._entity=null!=t?t:new Object},e.prototype.get_entityId=function(){return this._entityId},e.prototype.set_entityId=function(t){this._entityId=t},e.prototype.validateBeforeSave=function(){return this.validator.form()},e.prototype.updateTitle=function(){},e.prototype.getFallbackTemplate=function(){
return'<div>\n    <div class="s-Form">\n        <form id="~_Form" action="">\n            <div class="fieldset">\n                <div id="~_PropertyGrid"></div>\n                <div class="clear"></div>\n            </div>\n        </form> \n    </div>\n</div>'},e=S([In.registerClass("Serenity.PropertyDialog")],e)}(yr),br=function(t){function n(e){var n=t.call(this,e)||this;return n.initPropertyGrid(),n.initLocalizationGrid(),n}var r;return _(n,t),r=n,n.prototype.destroy=function(){this.propertyGrid&&(this.propertyGrid.destroy(),this.propertyGrid=null),this.localizationGrid&&(this.localizationGrid.destroy(),this.localizationGrid=null),this.undeleteButton=null,this.applyChangesButton=null,this.deleteButton=null,this.saveAndCloseButton=null,this.editButton=null,this.cloneButton=null,this.toolbar=null,t.prototype.destroy.call(this)},n.prototype.get_entity=function(){return this.entity},n.prototype.set_entity=function(t){this.entity=t||new Object},n.prototype.get_entityId=function(){
return this.entityId},n.prototype.set_entityId=function(t){this.entityId=t},n.prototype.getEntityNameFieldValue=function(){var t;return(null!==(t=this.get_entity()[this.getNameProperty()])&&void 0!==t?t:"").toString()},n.prototype.getEntityTitle=function(){var t;if(this.isEditMode()){var e=this.isViewMode()||this.readOnly||!this.hasSavePermission()?v("Controls.EntityDialog.ViewRecordTitle"):v("Controls.EntityDialog.EditRecordTitle"),n=null!==(t=this.getEntityNameFieldValue())&&void 0!==t?t:"";return me(e,this.getEntitySingular(),l(n)?"":" ("+n+")")}return me(v("Controls.EntityDialog.NewRecordTitle"),this.getEntitySingular())},n.prototype.updateTitle=function(){this.dialogTitle=this.getEntityTitle()},n.prototype.isCloneMode=function(){return!1},n.prototype.isEditMode=function(){return null!=this.get_entityId()&&!this.isCloneMode()},n.prototype.isDeleted=function(){if(null==this.get_entityId())return!1;var t=this.getIsDeletedProperty();if(t)return!!this.get_entity()[t]
;var e=this.get_entity()[this.getIsActiveProperty()];return null!=e&&e<0},n.prototype.isNew=function(){return null==this.get_entityId()},n.prototype.isNewOrDeleted=function(){return this.isNew()||this.isDeleted()},n.prototype.getDeleteOptions=function(t){return{}},n.prototype.deleteHandler=function(t,e){oe(t)},n.prototype.doDelete=function(t){var e=this,n=this,i={EntityId:this.get_entityId()},r=P({service:this.getService()+"/Delete",request:i,onSuccess:function(r){n.onDeleteSuccess(r),null!=t&&t(r),n.element.triggerHandler("ondatachange",[{entityId:i.EntityId,entity:e.entity,type:"delete"}])}},this.getDeleteOptions(t));this.deleteHandler(r,t)},n.prototype.onDeleteSuccess=function(t){},n.prototype.attrs=function(t){return j(R(this),t,!0)},n.prototype.getEntityType=function(){if(null!=this.entityType)return this.entityType;var t=this.attrs(Fn);if(1===t.length)return this.entityType=t[0].value;var e=V(R(this)),n=e.indexOf(".");return n>=0&&(e=e.substring(n+1)),
a(e,"Dialog")||a(e,"Control")?e=e.substr(0,e.length-6):a(e,"Panel")&&(e=e.substr(0,e.length-5)),this.entityType=e},n.prototype.getFormKey=function(){if(null!=this.formKey)return this.formKey;var t=this.attrs(Dn);return t.length>=1?this.formKey=t[0].value:this.formKey=this.getEntityType()},n.prototype.getLocalTextDbPrefix=function(){var t;return null!=this.localTextDbPrefix||(this.localTextDbPrefix=null!==(t=this.getLocalTextPrefix())&&void 0!==t?t:"",this.localTextDbPrefix.length>0&&!a(this.localTextDbPrefix,".")&&(this.localTextDbPrefix="Db."+this.localTextDbPrefix+".")),this.localTextDbPrefix},n.prototype.getLocalTextPrefix=function(){var t=this.attrs(Rn);return t.length>=1?t[0].value:this.getEntityType()},n.prototype.getEntitySingular=function(){if(null!=this.entitySingular)return this.entitySingular;var t=this.attrs(Mn);if(t.length>=1)this.entitySingular=t[0].value,this.entitySingular=C.getDefault(this.entitySingular,this.entitySingular);else{
var e=b(this.getLocalTextDbPrefix()+"EntitySingular");null==e&&(e=this.getEntityType()),this.entitySingular=e}return this.entitySingular},n.prototype.getNameProperty=function(){if(null!=this.nameProperty)return this.nameProperty;var t=this.attrs(Gn);return t.length>=1?this.nameProperty=t[0].value:this.nameProperty="Name",this.nameProperty},n.prototype.getIdProperty=function(){if(null!=this.idProperty)return this.idProperty;var t=this.attrs(Nn);return t.length>=1?this.idProperty=t[0].value:this.idProperty="ID",this.idProperty},n.prototype.getIsActiveProperty=function(){if(null!=this.isActiveProperty)return this.isActiveProperty;var t=this.attrs(Vn);return t.length>=1?this.isActiveProperty=t[0].value:this.isActiveProperty="IsActive",this.isActiveProperty},n.prototype.getIsDeletedProperty=function(){return null},n.prototype.getService=function(){if(null!=this.service)return this.service;var t=this.attrs(Xn)
;return t.length>=1?this.service=t[0].value:this.service=m(this.getEntityType(),".","/"),this.service},n.prototype.load=function(t,e,n){var i=this,r=function(){if(null==t)return i.loadResponse({}),void(e&&e());var n=typeof t;if("string"!==n&&"number"!==n){var r=t||new Object;i.loadResponse({Entity:r}),e&&e()}else{var o=t;i.loadById(o,(function(t){e&&window.setTimeout(e,0)}),null)}};if(null!=n)try{r()}catch(t){n(pt.wrap(t))}else r()},n.prototype.loadNewAndOpenDialog=function(t){this.loadResponse({}),this.dialogOpen(t)},n.prototype.loadEntityAndOpenDialog=function(t,e){this.loadResponse({Entity:t}),this.dialogOpen(e)},n.prototype.loadResponse=function(t){t=t||{},this.onLoadingData(t);var e=t.Entity||new Object;this.beforeLoadEntity(e),this.loadEntity(e),this.set_entity(e),this.afterLoadEntity()},n.prototype.loadEntity=function(t){var e=this.getIdProperty();null!=e&&this.set_entityId(t[e]),this.set_entity(t),null!=this.propertyGrid&&(this.propertyGrid.set_mode(this.isEditMode()?2:1),
this.propertyGrid.load(t))},n.prototype.beforeLoadEntity=function(t){this.localizationPendingValue=null,this.localizationLastValue=null},n.prototype.afterLoadEntity=function(){this.updateInterface(),this.updateTitle()},n.prototype.loadByIdAndOpenDialog=function(t,e){var n=this;this.loadById(t,(function(t){return window.setTimeout((function(){return n.dialogOpen(e)}),0)}),(function(){n.element.is(":visible")||n.element.remove()}))},n.prototype.onLoadingData=function(t){},n.prototype.getLoadByIdOptions=function(t,e){return{}},n.prototype.getLoadByIdRequest=function(t){var e={};return e.EntityId=t,e},n.prototype.reloadById=function(){this.loadById(this.get_entityId())},n.prototype.loadById=function(t,e,n){var i=this,r=P({service:this.getService()+"/Retrieve",blockUI:!0,request:this.getLoadByIdRequest(t),onSuccess:function(t){i.loadResponse(t),e&&e(t)},onCleanup:function(){null!=i.validator&&on(i.validator)}},this.getLoadByIdOptions(t,e));this.loadByIdHandler(r,e,n)},
n.prototype.loadByIdHandler=function(t,e,n){var i=oe(t);n&&i.fail(n)},n.prototype.initLocalizationGrid=function(){if(!(this.byId("PropertyGrid").length<=0)){var t=this.getPropertyGridOptions();this.initLocalizationGridCommon(t)}},n.prototype.initLocalizationGridCommon=function(t){var n=this.byId("PropertyGrid");if(e(t.items,(function(t){return!0===t.localizable}))){var i=$("<div/>").attr("id",this.idPrefix+"LocalizationGrid").hide().insertAfter(n);t.idPrefix=this.idPrefix+"Localization_";for(var r=[],o=0,a=t.items;o<a.length;o++){var l=a[o],s=null;if(!0===l.localizable){var u=P({},l);u.oneWay=!0,u.readOnly=!0,u.required=!1,u.defaultValue=null,r.push(u),null==s&&(s=this.getLangs());for(var c=0,d=s;c<d.length;c++){var p=d[c];(u=P({},l)).name=p[0]+"$"+u.name,u.title=p[1],u.cssClass=[u.cssClass,"translation"].join(" "),u.insertable=!0,u.updatable=!0,u.oneWay=!1,u.required=!1,u.localizable=!1,u.defaultValue=null,r.push(u)}}}t.items=r,this.localizationGrid=new Ei(i,t).init(null),
i.addClass("s-LocalizationGrid")}},n.prototype.isLocalizationMode=function(){return null!=this.localizationButton&&this.localizationButton.hasClass("pressed")},n.prototype.isLocalizationModeAndChanged=function(){if(!this.isLocalizationMode())return!1;var t=this.getLocalizationGridValue();return JSON.stringify(this.localizationLastValue)!=JSON.stringify(t)},n.prototype.localizationButtonClick=function(){if(!this.isLocalizationMode()||this.validateForm()){if(this.isLocalizationModeAndChanged()){var t=this.getLocalizationGridValue();this.localizationLastValue=t,this.localizationPendingValue=t}this.localizationButton.toggleClass("pressed"),this.updateInterface(),this.isLocalizationMode()&&this.loadLocalization()}},n.prototype.getLanguages=function(){return null!=r.defaultLanguageList&&r.defaultLanguageList()||[]},n.prototype.getLangs=function(){var t=this.getLanguages(),e=G(t,Array);return null!=e&&0!==e.length&&null!=e[0]&&i(e[0])||(e=Array.prototype.slice.call(t.map((function(t){
return[t.item1,t.item2]})))),e},n.prototype.loadLocalization=function(){var t=this;return null==this.localizationLastValue&&this.isNew()?(this.localizationGrid.load({}),this.setLocalizationGridCurrentValues(),void(this.localizationLastValue=this.getLocalizationGridValue())):null!=this.localizationLastValue?(this.localizationGrid.load(this.localizationLastValue),void this.setLocalizationGridCurrentValues()):void oe({service:this.getService()+"/Retrieve",blockUI:!0,request:{EntityId:this.get_entityId(),ColumnSelection:"keyOnly",IncludeColumns:["Localizations"]},onSuccess:function(e){var n=P(new Object,t.get_entity());if(e.Localizations)for(var i=0,r=Object.keys(e.Localizations);i<r.length;i++)for(var o=r[i],a=e.Localizations[o],l=0,s=Object.keys(a);l<s.length;l++){var u=s[l];n[o+"$"+u]=a[u]}t.localizationGrid.load(n),t.setLocalizationGridCurrentValues(),t.localizationPendingValue=null,t.localizationLastValue=t.getLocalizationGridValue()}})},
n.prototype.setLocalizationGridCurrentValues=function(){var t=this,e={};this.localizationGrid.enumerateItems((function(n,i){n.name.indexOf("$")<0&&i.element.is(":input")&&(e[n.name]=t.byId(n.name).val(),i.element.val(e[n.name]))})),this.localizationGrid.enumerateItems((function(t,n){var i=t.name.indexOf("$");if(i>=0&&n.element.is(":input")){var r=e[t.name.substr(i+1)];null!=r&&r.length>0&&n.element.attr("title",r).attr("placeholder",r)}}))},n.prototype.getLocalizationGridValue=function(){var t={};this.localizationGrid.save(t);for(var e=0,n=Object.keys(t);e<n.length;e++){var i=n[e];i.indexOf("$")<0&&delete t[i]}return t},n.prototype.getPendingLocalizations=function(){if(null==this.localizationPendingValue)return null;for(var t={},e=this.getIdProperty(),n=0,i=this.getLangs();n<i.length;n++){var r=i[n][0],o={};null!=e&&(o[e]=this.get_entityId());for(var a=r+"$",l=0,s=Object.keys(this.localizationPendingValue);l<s.length;l++){var u=s[l]
;d(u,a)&&(o[u.substr(a.length)]=this.localizationPendingValue[u])}t[r]=o}return t},n.prototype.initPropertyGrid=function(){var t=this.byId("PropertyGrid");if(!(t.length<=0)){var e=this.getPropertyGridOptions();this.propertyGrid=new Ei(t,e).init(null),this.element.closest(".ui-dialog").hasClass("s-Flexify")&&this.propertyGrid.element.children(".categories").flexHeightOnly(1)}},n.prototype.getPropertyItems=function(){return qe(this.getFormKey())},n.prototype.getPropertyGridOptions=function(){return{idPrefix:this.idPrefix,items:this.getPropertyItems(),mode:1,localTextPrefix:"Forms."+this.getFormKey()+".",useCategories:!0}},n.prototype.validateBeforeSave=function(){return!0},n.prototype.getSaveOptions=function(t){var e=this,n={};return n.service=this.getService()+"/"+(this.isEditMode()?"Update":"Create"),n.onSuccess=function(i){e.onSaveSuccess(i),t&&t(i);var r={type:e.isEditMode()?"update":"create",entity:null==n.request?null:n.request.Entity,
entityId:e.isEditMode()?e.get_entityId():null==i?null:i.EntityId};e.element.triggerHandler("ondatachange",[r])},n.onCleanup=function(){e.validator&&on(e.validator)},n.request=this.getSaveRequest(),n},n.prototype.getSaveEntity=function(){var t=new Object;if(null!=this.propertyGrid&&this.propertyGrid.save(t),this.isEditMode()){var e=this.getIdProperty();null!=e&&null==t[e]&&(t[e]=this.get_entityId())}return t},n.prototype.getSaveRequest=function(){var t=this.getSaveEntity(),e={};(e.Entity=t,this.isEditMode())&&(null!=this.getIdProperty()&&(e.EntityId=this.get_entityId()));return null!=this.localizationPendingValue&&(e.Localizations=this.getPendingLocalizations()),e},n.prototype.onSaveSuccess=function(t){},n.prototype.save_submitHandler=function(t){var e=this.getSaveOptions(t);this.saveHandler(e,t)},n.prototype.save=function(t){var e=this;return xi.submit(this.byId("Form"),(function(){return e.validateBeforeSave()}),(function(){return e.save_submitHandler(t)}))},
n.prototype.saveHandler=function(t,e){oe(t)},n.prototype.initToolbar=function(){t.prototype.initToolbar.call(this),this.toolbar&&(this.saveAndCloseButton=this.toolbar.findButton("save-and-close-button"),this.applyChangesButton=this.toolbar.findButton("apply-changes-button"),this.deleteButton=this.toolbar.findButton("delete-button"),this.undeleteButton=this.toolbar.findButton("undo-delete-button"),this.editButton=this.toolbar.findButton("edit-button"),this.cloneButton=this.toolbar.findButton("clone-button"),this.localizationButton=this.toolbar.findButton("localization-button"))},n.prototype.showSaveSuccessMessage=function(t){Ct(v("Controls.EntityDialog.SaveSuccessMessage"),"",null)},n.prototype.getToolbarButtons=function(){var t=this,e=[];return e.push({title:v("Controls.EntityDialog.SaveButton"),cssClass:"save-and-close-button",hotkey:"alt+s",onClick:function(){t.save((function(e){t.dialogClose()}))},visible:function(){return!t.isDeleted()&&!t.isViewMode()},disabled:function(){
return!t.hasSavePermission()||t.readOnly}}),e.push({title:"",hint:v("Controls.EntityDialog.ApplyChangesButton"),cssClass:"apply-changes-button",hotkey:"alt+a",onClick:function(){t.save((function(e){if(t.isEditMode()){var n=e.EntityId;null==n&&(n=t.get_entityId()),t.loadById(n)}else t.loadById(e.EntityId);t.showSaveSuccessMessage(e)}))},visible:function(){return!t.isDeleted()&&!t.isViewMode()},disabled:function(){return!t.hasSavePermission()||t.readOnly}}),e.push({title:v("Controls.EntityDialog.DeleteButton"),cssClass:"delete-button",hotkey:"alt+x",onClick:function(){Jt(v("Controls.EntityDialog.DeleteConfirmation"),(function(){t.doDelete((function(){return t.dialogClose()}))}))},visible:function(){return t.isEditMode()&&!t.isDeleted()&&!t.isViewMode()},disabled:function(){return!t.hasDeletePermission()||t.readOnly}}),e.push({title:v("Controls.EntityDialog.UndeleteButton"),cssClass:"undo-delete-button",onClick:function(){
t.isDeleted()&&Jt(v("Controls.EntityDialog.UndeleteConfirmation"),(function(){t.undelete((function(){return t.loadById(t.get_entityId())}))}))},visible:function(){return t.isEditMode()&&t.isDeleted()&&!t.isViewMode()},disabled:function(){return!t.hasDeletePermission()||t.readOnly}}),this.useViewMode()&&e.push({title:v("Controls.EntityDialog.EditButton"),cssClass:"edit-button",icon:"fa-edit",onClick:function(){t.isEditMode()&&(t.editClicked=!0,t.updateInterface(),t.updateTitle())},visible:function(){return t.isViewMode()},disabled:function(){return!t.hasSavePermission()||t.readOnly}}),e.push({title:v("Controls.EntityDialog.LocalizationButton"),cssClass:"localization-button",onClick:function(){return t.localizationButtonClick()}}),e.push({title:v("Controls.EntityDialog.CloneButton"),cssClass:"clone-button",onClick:function(){if(t.isEditMode()){var e=t.getCloningEntity();vi.create({type:R(t),init:function(n){
return bi.bubbleDataChange(bi.cascade(n,t.element),t,!0).loadEntityAndOpenDialog(e,null)}})}},visible:function(){return!1},disabled:function(){return!t.hasInsertPermission()||t.readOnly}}),e},n.prototype.getCloningEntity=function(){var t=new Object;t=P(t,this.get_entity());var e=this.getIdProperty();l(e)||delete t[e];var n=this.getIsActiveProperty();l(n)||delete t[n];var i=this.getIsDeletedProperty();return l(i)||delete t[i],t},n.prototype.updateInterface=function(){_i.setContainerReadOnly(this.byId("Form"),!1);var t=this.isLocalizationMode(),e=this.hasSavePermission(),n=this.isViewMode(),i=this.readOnly;if(this.toolbar.updateInterface(),null!=this.tabs&&Pi.setDisabled(this.tabs,"Log",this.isNewOrDeleted()),null!=this.propertyGrid&&this.propertyGrid.element.toggle(!t),null!=this.localizationGrid&&this.localizationGrid.element.toggle(t),null!=this.localizationButton&&(this.localizationButton.toggle(null!=this.localizationGrid),
this.localizationButton.find(".button-inner").text(this.isLocalizationMode()?v("Controls.EntityDialog.LocalizationBack"):v("Controls.EntityDialog.LocalizationButton"))),t)return null!=this.toolbar&&this.toolbar.findButton("tool-button").not(".localization-hidden").addClass(".localization-hidden").hide(),void(this.localizationButton&&this.localizationButton.show());this.toolbar.findButton("localization-hidden").removeClass("localization-hidden").show(),(!e||n||i)&&_i.setContainerReadOnly(this.byId("Form"),!0)},n.prototype.getUndeleteOptions=function(t){return{}},n.prototype.undeleteHandler=function(t,e){oe(t)},n.prototype.undelete=function(t){var e=this,n={};n.service=this.getService()+"/Undelete";var i={};i.EntityId=this.get_entityId(),n.request=i,n.onSuccess=function(n){t&&t(n),e.element.triggerHandler("ondatachange",[{entityId:e.get_entityId(),entity:e.entity,type:"undelete"}])};var r=P(n,this.getUndeleteOptions(t));this.undeleteHandler(r,t)},
Object.defineProperty(n.prototype,"readOnly",{get:function(){return this.get_readOnly()},set:function(t){this.set_readOnly(t)},enumerable:!1,configurable:!0}),n.prototype.get_readOnly=function(){return!!this._readonly},n.prototype.set_readOnly=function(t){!!this._readonly!=!!t&&(this._readonly=!!t,this.updateInterface(),this.updateTitle())},n.prototype.getInsertPermission=function(){return null},n.prototype.getUpdatePermission=function(){return null},n.prototype.getDeletePermission=function(){return null},n.prototype.hasDeletePermission=function(){var t=this.getDeletePermission();return null==t||Fe.hasPermission(t)},n.prototype.hasInsertPermission=function(){var t=this.getInsertPermission();return null==t||Fe.hasPermission(t)},n.prototype.hasUpdatePermission=function(){var t=this.getUpdatePermission();return null==t||Fe.hasPermission(t)},n.prototype.hasSavePermission=function(){return this.isNew()?this.hasInsertPermission():this.hasUpdatePermission()},n.prototype.isViewMode=function(){
return this.useViewMode()&&this.isEditMode()&&!this.editClicked},n.prototype.useViewMode=function(){return!1},n.prototype.getFallbackTemplate=function(){return'<div class="s-DialogContent">\n    <div id="~_Toolbar" class="s-DialogToolbar">\n    </div>\n    <div class="s-Form">\n        <form id="~_Form" action="">\n            <div class="fieldset">\n                <div id="~_PropertyGrid"></div>\n                <div class="clear"></div>\n            </div>\n        </form> \n    </div>\n</div>'},n=r=S([In.registerClass("Serenity.EntityDialog",[oi,li])],n)}(yr);!function(t){t.isTrue="true",t.isFalse="false",t.contains="contains",t.startsWith="startswith",t.EQ="eq",t.NE="ne",t.GT="gt",t.GE="ge",t.LT="lt",t.LE="le",t.BW="bw",t.IN="in",t.isNull="isnull",t.isNotNull="isnotnull",t.toCriteriaOperator={eq:"=",ne:"!=",gt:">",ge:">=",lt:"<",le:"<="}}(mr||(mr={}));var Cr=function(){function t(t){if(this.items=[],null==t)throw new ft("source");this.fields=t.slice(),
this.get_fields().sort((function(t,e){var n=b(t.title);null==n&&null==(n=t.title)&&(n=t.name);var i=b(e.title);return null==i&&null==(i=e.title)&&(i=e.name),de.stringCompare(n,i)})),this.fieldByName={};for(var e=0,n=t;e<n.length;e++){var i=n[e];this.get_fieldByName()[i.name]=i}}var e;return e=t,t.getCriteriaFor=function(t){if(null==t)return[""];for(var e=!1,n=[""],i=!1,r=[""],o=0;o<t.length;o++){var a=t[o];(a.leftParen||e&&a.rightParen)&&(di.isEmpty(n)||(e&&(n=di.paren(n)),r=i?di.join(r,"or",n):di.join(r,"and",n),n=[""]),e=!1),a.leftParen&&(i=a.isOr,e=!0),n=a.isOr?di.join(n,"or",a.criteria):di.join(n,"and",a.criteria)}return di.isEmpty(n)||(r=i?di.join(r,"or",di.paren(n)):di.join(r,"and",di.paren(n))),r},t.getDisplayTextFor=function(t){if(null==t)return"";for(var e=!1,n="",i=0;i<t.length;i++){var r=t[i];e&&(r.rightParen||r.leftParen)&&(n+=")",e=!1),n.length>0&&(n+=" "+v("Controls.FilterPanel."+(r.isOr?"Or":"And"))+" "),r.leftParen&&(n+="(",e=!0),n+=r.displayText}return e&&(n+=")"),n},
t.prototype.get_fields=function(){return this.fields},t.prototype.get_fieldByName=function(){return this.fieldByName},t.prototype.get_items=function(){return this.items},t.prototype.raiseChanged=function(){this.displayText=null,this.changed&&this.changed(this,{})},t.prototype.add_changed=function(t){this.changed=Y(this.changed,t)},t.prototype.remove_changed=function(t){this.changed=Z(this.changed,t)},t.prototype.get_activeCriteria=function(){return e.getCriteriaFor(this.items)},t.prototype.get_displayText=function(){return null==this.displayText&&(this.displayText=e.getDisplayTextFor(this.items)),this.displayText},t=e=S([In.registerClass("FilterStore")],t)}(),wr=function(){function t(){}return t=S([In.registerInterface("Serenity.IFiltering")],t)}(),_r=function(){function t(){}return t=S([In.registerInterface("Serenity.IQuickFiltering")],t)}(),Sr=function(){function t(){}return t.prototype.get_field=function(){return this.field},t.prototype.set_field=function(t){this.field=t},
t.prototype.get_container=function(){return this.container},t.prototype.set_container=function(t){this.container=t},t.prototype.get_operator=function(){return this.operator},t.prototype.set_operator=function(t){this.operator=t},t.prototype.appendNullableOperators=function(t){return this.isNullable()?(t.push({key:mr.isNotNull}),t.push({key:mr.isNull}),t):t},t.prototype.appendComparisonOperators=function(t){return t.push({key:mr.EQ}),t.push({key:mr.NE}),t.push({key:mr.LT}),t.push({key:mr.LE}),t.push({key:mr.GT}),t.push({key:mr.GE}),t},t.prototype.isNullable=function(){return!0!==this.get_field().required},t.prototype.createEditor=function(){switch(this.get_operator().key){case"true":case"false":case"isnull":case"isnotnull":return;case"contains":case"startswith":case"eq":case"ne":case"lt":case"le":case"gt":case"ge":return void this.get_container().html('<input type="text"/>')}throw new pt(me("Filtering '{0}' has no editor for '{1}' operator",M(R(this)),this.get_operator().key))},
t.prototype.operatorFormat=function(t){var e,n;return null!==(n=null!==(e=t.format)&&void 0!==e?e:b("Controls.FilterPanel.OperatorFormats."+t.key))&&void 0!==n?n:t.key},t.prototype.getTitle=function(t){var e,n;return null!==(e=b(t.title))&&void 0!==e?e:null!==(n=t.title)&&void 0!==n?n:t.name},t.prototype.displayText=function(t,e){return e&&0!==e.length?1===e.length?me(this.operatorFormat(t),this.getTitle(this.field),e[0]):me(this.operatorFormat(t),this.getTitle(this.field),e[0],e[1]):me(this.operatorFormat(t),this.getTitle(this.field))},t.prototype.getCriteriaField=function(){return this.field.name},t.prototype.getCriteria=function(){var t,e={};switch(this.get_operator().key){case"true":return e.displayText=this.displayText(this.get_operator(),[]),e.criteria=[[this.getCriteriaField()],"=",!0],e;case"false":return e.displayText=this.displayText(this.get_operator(),[]),e.criteria=[[this.getCriteriaField()],"=",!1],e;case"isnull":
return e.displayText=this.displayText(this.get_operator(),[]),e.criteria=["is null",[this.getCriteriaField()]],e;case"isnotnull":return e.displayText=this.displayText(this.get_operator(),[]),e.criteria=["is not null",[this.getCriteriaField()]],e;case"contains":return t=this.getEditorText(),e.displayText=this.displayText(this.get_operator(),[t]),e.criteria=[[this.getCriteriaField()],"like","%"+t+"%"],e;case"startswith":return t=this.getEditorText(),e.displayText=this.displayText(this.get_operator(),[t]),e.criteria=[[this.getCriteriaField()],"like",t+"%"],e;case"eq":case"ne":case"lt":case"le":case"gt":case"ge":return t=this.getEditorText(),e.displayText=this.displayText(this.get_operator(),[t]),e.criteria=[[this.getCriteriaField()],mr.toCriteriaOperator[this.get_operator().key],this.getEditorValue()],e}throw new pt(me("Filtering '{0}' has no handler for '{1}' operator",M(R(this)),this.get_operator().key))},t.prototype.loadState=function(t){
this.get_container().find(":input").first().val(t)},t.prototype.saveState=function(){switch(this.get_operator().key){case"contains":case"startswith":case"eq":case"ne":case"lt":case"le":case"gt":case"ge":return this.get_container().find(":input").first().val()}return null},t.prototype.argumentNull=function(){return new ft("value",v("Controls.FilterPanel.ValueRequired"))},t.prototype.validateEditorValue=function(t){if(0===t.length)throw this.argumentNull();return t},t.prototype.getEditorValue=function(){var t,e,n=this.get_container().find(":input").not(".select2-focusser").first();if(1!==n.length)throw new pt(me("Couldn't find input in filter container for {0}",null!==(t=this.field.title)&&void 0!==t?t:this.field.name));return e=(null!=(e=null!=n.data("select2")?n.select2("val"):n.val())?e:"").trim(),this.validateEditorValue(e)},t.prototype.getEditorText=function(){var t,e=this.get_container().find(":input").not(".select2-focusser").not(".select2-input").first()
;return 0===e.length?this.get_container().text().trim():null!=e.data("select2")?(null!==(t=e.select2("data"))&&void 0!==t?t:{}).text:e.val()},t.prototype.initQuickFilter=function(t){t.field=this.getCriteriaField(),t.type=Ai,t.title=this.getTitle(this.field),t.options=O(this.get_field().quickFilterParams)},t=S([In.registerClass("Serenity.BaseFiltering",[wr,_r])],t)}();function kr(t){return In.registerClass("Serenity."+t+"Filtering")}var Ir,xr=function(t){function e(e){var n=t.call(this)||this;return n.editorType=e,n}return _(e,t),e.prototype.useEditor=function(){switch(this.get_operator().key){case"eq":case"ne":case"lt":case"le":case"gt":case"ge":return!0}return!1},e.prototype.createEditor=function(){this.useEditor()?this.editor=vi.create({type:this.editorType,container:this.get_container(),options:this.getEditorOptions(),init:null}):(this.editor=null,t.prototype.createEditor.call(this))},e.prototype.useIdField=function(){return!1},e.prototype.getCriteriaField=function(){
return this.useEditor()&&this.useIdField()&&!l(this.get_field().filteringIdField)?this.get_field().filteringIdField:t.prototype.getCriteriaField.call(this)},e.prototype.getEditorOptions=function(){var t=O(this.get_field().editorParams||{});return delete t.cascadeFrom,P(t,this.get_field().filteringParams)},e.prototype.loadState=function(e){if(this.useEditor()){if(null==e)return;_i.setValue(this.editor,e)}else t.prototype.loadState.call(this,e)},e.prototype.saveState=function(){return this.useEditor()?_i.getValue(this.editor):t.prototype.saveState.call(this)},e.prototype.getEditorValue=function(){if(this.useEditor()){var e=_i.getValue(this.editor);if(null==e||"string"==typeof e&&0===e.trim().length)throw this.argumentNull();return e}return t.prototype.getEditorValue.call(this)},e.prototype.initQuickFilter=function(e){t.prototype.initQuickFilter.call(this,e),e.type=this.editorType,e.options=P(P({},O(this.getEditorOptions())),O(this.get_field().quickFilterParams))},
e=S([kr("BaseEditor")],e)}(Sr),Tr=function(t){function e(){return t.call(this,qi)||this}return _(e,t),e.prototype.getOperators=function(){return this.appendNullableOperators(this.appendComparisonOperators([]))},e=S([kr("Date")],e)}(xr),Fr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.getOperators=function(){return this.appendNullableOperators([{key:mr.isTrue},{key:mr.isFalse}])},e=S([kr("Boolean")],e)}(Sr),Pr=function(t){function e(){return t.call(this,zi)||this}return _(e,t),e.prototype.getOperators=function(){return this.appendNullableOperators(this.appendComparisonOperators([]))},e.prototype.getCriteria=function(){var e={};switch(this.get_operator().key){case"eq":case"ne":case"lt":case"le":case"gt":case"ge":var n=this.getEditorText();e.displayText=this.displayText(this.get_operator(),[n]);var i=De(this.getEditorValue());i=new Date(i.getFullYear(),i.getMonth(),i.getDate())
;var r=new Date(i.getFullYear(),i.getMonth(),i.getDate()+1),o=[this.getCriteriaField()],a=Ie(i,"yyyy-MM-dd"),l=Ie(r,"yyyy-MM-dd");switch(this.get_operator().key){case"eq":return e.criteria=di.join([o,">=",a],"and",[o,"<",l]),e;case"ne":return e.criteria=di.paren(di.join([o,"<",a],"or",[o,">",l])),e;case"lt":return e.criteria=[o,"<",a],e;case"le":return e.criteria=[o,"<",l],e;case"gt":return e.criteria=[o,">=",l],e;case"ge":return e.criteria=[o,">=",a],e}}return t.prototype.getCriteria.call(this)},e=S([kr("DateTime")],e)}(xr),Or=function(t){function e(){return t.call(this,Mi)||this}return _(e,t),e.prototype.getOperators=function(){return this.appendNullableOperators(this.appendComparisonOperators([]))},e=S([kr("Decimal")],e)}(xr),Dr=function(t){function e(){return t.call(this,vi)||this}return _(e,t),e.prototype.getOperators=function(){var t=[];return t.push({key:mr.EQ}),t.push({key:mr.NE}),this.useRelative&&(t.push({key:mr.LT}),t.push({key:mr.LE}),t.push({key:mr.GT}),t.push({key:mr.GE
})),this.useLike&&(t.push({key:mr.contains}),t.push({key:mr.startsWith})),this.appendNullableOperators(t),t},e.prototype.useEditor=function(){var t=this.get_operator().key;return t===mr.EQ||t===mr.NE||this.useRelative&&(t===mr.LT||t===mr.LE||t===mr.GT||t===mr.GE)},e.prototype.getEditorOptions=function(){var e,n=t.prototype.getEditorOptions.call(this);return this.useEditor()&&this.editorType===(null!==(e=this.get_field().editorType)&&void 0!==e?e:"String")&&(n=P(n,this.get_field().editorParams)),n},e.prototype.createEditor=function(){var e=this;if(this.useEditor()){var n=hi.get(this.editorType);this.editor=vi.create({type:n,element:function(t){return t.appendTo(e.get_container())},options:this.getEditorOptions()})}else t.prototype.createEditor.call(this)},e.prototype.useIdField=function(){return this.useEditor()},e.prototype.initQuickFilter=function(e){t.prototype.initQuickFilter.call(this,e),e.type=hi.get(this.editorType)},S([In.option()],e.prototype,"editorType",void 0),
S([In.option()],e.prototype,"useRelative",void 0),S([In.option()],e.prototype,"useLike",void 0),e=S([kr("Editor")],e)}(xr),Er=function(t){function e(){return t.call(this,Xi)||this}return _(e,t),e.prototype.getOperators=function(){var t=[{key:mr.EQ},{key:mr.NE}];return this.appendNullableOperators(t)},e=S([kr("Enum")],e)}(xr),$r=function(t){function e(){return t.call(this,Ri)||this}return _(e,t),e.prototype.getOperators=function(){return this.appendNullableOperators(this.appendComparisonOperators([]))},e=S([kr("Integer")],e)}(xr),Ar=function(t){function e(){return t.call(this,tr)||this}return _(e,t),e.prototype.getOperators=function(){var t=[{key:mr.EQ},{key:mr.NE},{key:mr.contains},{key:mr.startsWith}];return this.appendNullableOperators(t)},e.prototype.useEditor=function(){var t=this.get_operator().key;return t==mr.EQ||t==mr.NE},e.prototype.useIdField=function(){return this.useEditor()},e.prototype.getEditorText=function(){
return this.useEditor()?this.editor.text:t.prototype.getEditorText.call(this)},e=S([kr("Lookup")],e)}(xr),Nr=function(t){function e(){return t.call(this,nr)||this}return _(e,t),e.prototype.getOperators=function(){var t=[{key:mr.EQ},{key:mr.NE},{key:mr.contains},{key:mr.startsWith}];return this.appendNullableOperators(t)},e.prototype.useEditor=function(){var t=this.get_operator().key;return t==mr.EQ||t==mr.NE},e.prototype.useIdField=function(){return this.useEditor()},e.prototype.getEditorText=function(){return this.useEditor()?this.editor.text:t.prototype.getEditorText.call(this)},e=S([kr("ServiceLookup")],e)}(xr),Br=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.getOperators=function(){var t=[{key:mr.contains},{key:mr.startsWith},{key:mr.EQ},{key:mr.NE}];return this.appendNullableOperators(t)},e.prototype.validateEditorValue=function(e){return 0===e.length?e:t.prototype.validateEditorValue.call(this,e)},e=S([kr("String")],e)}(Sr)
;!function(t){var e;function n(){if(null==e){e={};for(var t=0,n=K();t<n.length;t++){var i=n[t];if(L(wr,i)){var r=V(i).toLowerCase();e[r]=i;for(var o=0,s=St.rootNamespaces;o<s.length;o++){var u=s[o];if(d(r,u.toLowerCase()+".")){var c=r.substr(u.length+1).toLowerCase();null==e[c]&&(e[c]=i)}}}}!function(){for(var t="filtering",n=0,i=Object.keys(e);n<i.length;n++){var r=i[n];if(a(r,t)){var o=r.substr(0,r.length-t.length);l(o)||null==e[o]&&(e[o]=e[r])}}}()}}t.get=function(t){if(l(t))throw new ft("key");n();var i=e[t.toLowerCase()];if(null==i)throw new pt(me("Can't find {0} filter handler type!",t));return i}}(Ir||(Ir={}));var Vr=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.store=new Cr([]),i.onFilterStoreChanged=function(){return i.filterStoreChanged()},i.store.add_changed(i.onFilterStoreChanged),i}return _(e,t),e.prototype.destroy=function(){this.store&&(this.store.remove_changed(this.onFilterStoreChanged),this.onFilterStoreChanged=null,this.store=null),
t.prototype.destroy.call(this)},e.prototype.filterStoreChanged=function(){},e.prototype.get_store=function(){return this.store},e.prototype.set_store=function(t){this.store!==t&&(null!=this.store&&this.store.remove_changed(this.onFilterStoreChanged),this.store=t||new Cr([]),this.store.add_changed(this.onFilterStoreChanged),this.filterStoreChanged())},e=S([In.registerClass("Serenity.FilterWidgetBase")],e)}(wi),Mr=function(t){function e(e,n){for(var i,r,o=t.call(this,e)||this,a=0,l=n;a<l.length;a++){var s=l[a];o.addOption(s.name,null!==(r=null!==(i=b(s.title))&&void 0!==i?i:s.title)&&void 0!==r?r:s.name,s)}return o}return _(e,t),e.prototype.emptyItemText=function(){return l(this.value)?v("Controls.FilterPanel.SelectField"):null},e.prototype.getSelect2Options=function(){var e=t.prototype.getSelect2Options.call(this);return e.allowClear=!1,e},e=S([In.registerClass("Serenity.FilterFieldSelect")],e)}(Qi),Rr=function(t){function e(e,n){
for(var i,r,o=t.call(this,e)||this,a=0,l=n;a<l.length;a++){var s=l[a],u=null!==(i=s.title)&&void 0!==i?i:null!==(r=b("Controls.FilterPanel.OperatorNames."+s.key))&&void 0!==r?r:s.key;o.addOption(s.key,u,s)}return n.length&&n[0]&&(o.value=n[0].key),o}return _(e,t),e.prototype.emptyItemText=function(){return null},e.prototype.getSelect2Options=function(){var e=t.prototype.getSelect2Options.call(this);return e.allowClear=!1,e},e=S([In.registerClass("Serenity.FilterOperatorSelect")],e)}(Qi),Lr=function(t){function e(e){var n=t.call(this,e)||this;return n.element.addClass("s-FilterPanel"),n.rowsDiv=n.byId("Rows"),n.initButtons(),n.updateButtons(),n}return _(e,t),e.prototype.get_showInitialLine=function(){return this.showInitialLine},e.prototype.set_showInitialLine=function(t){this.showInitialLine!==t&&(this.showInitialLine=t,this.showInitialLine&&0===this.rowsDiv.children().length&&this.addEmptyRow(!1))},e.prototype.filterStoreChanged=function(){t.prototype.filterStoreChanged.call(this),
this.updateRowsFromStore()},e.prototype.updateRowsFromStore=function(){this.rowsDiv.empty();for(var t=0,e=this.get_store().get_items();t<e.length;t++){var n=e[t];this.addEmptyRow(!1);var i=this.rowsDiv.children().last(),r=i.children("div.l");r.children(".leftparen").toggleClass("active",!!n.leftParen),r.children(".rightparen").toggleClass("active",!!n.rightParen),r.children(".andor").toggleClass("or",!!n.isOr).text(v(n.isOr?"Controls.FilterPanel.Or":"Controls.FilterPanel.And")),i.children("div.f").find("input.field-select").getWidget(Mr).value=n.field,this.rowFieldChange(i),i.children("div.o").find("input.op-select").getWidget(Rr).set_value(n.operator),this.rowOperatorChange(i);var o=this.getFilteringFor(i);null!=o&&(o.set_operator({key:n.operator}),o.loadState(n.state))}this.get_showInitialLine()&&0===this.rowsDiv.children().length&&this.addEmptyRow(!1),this.updateParens()},e.prototype.get_showSearchButton=function(){return this.showSearchButton},
e.prototype.set_showSearchButton=function(t){this.showSearchButton!==t&&(this.showSearchButton=t,this.updateButtons())},e.prototype.get_updateStoreOnReset=function(){return this.updateStoreOnReset},e.prototype.set_updateStoreOnReset=function(t){this.updateStoreOnReset!==t&&(this.updateStoreOnReset=t)},e.prototype.getTemplate=function(){return"<div id='~_Rows' class='filter-lines'></div><div id='~_Buttons' class='buttons'><button id='~_AddButton' class='btn btn-primary add'></button><button id='~_SearchButton' class='btn btn-success search'></button><button id='~_ResetButton' class='btn btn-danger reset'></button></div><div style='clear: both'></div>"},e.prototype.initButtons=function(){var t=this;this.byId("AddButton").text(v("Controls.FilterPanel.AddFilter")).click((function(e){return t.addButtonClick(e)})),this.byId("SearchButton").text(v("Controls.FilterPanel.SearchButton")).click((function(e){return t.searchButtonClick(e)})),
this.byId("ResetButton").text(v("Controls.FilterPanel.ResetButton")).click((function(e){return t.resetButtonClick(e)}))},e.prototype.searchButtonClick=function(t){t.preventDefault(),this.search()},e.prototype.get_hasErrors=function(){return this.rowsDiv.children().children("div.v").children("span.error").length>0},e.prototype.search=function(){this.rowsDiv.children().children("div.v").children("span.error").remove();for(var t=[],e=null,n=null,i=0;i<this.rowsDiv.children().length;i++){n=this.rowsDiv.children().eq(i);var r=this.getFilteringFor(n);if(null!=r){var o=this.getFieldFor(n),a=n.children("div.o").find("input.op-select").getWidget(Rr).value;if(null==a||0===a.length){e=v("Controls.FilterPanel.InvalidOperator");break}var l={};l.field=o.name,l.operator=a,l.isOr=n.children("div.l").children("a.andor").hasClass("or"),l.leftParen=n.children("div.l").children("a.leftparen").hasClass("active"),l.rightParen=n.children("div.l").children("a.rightparen").hasClass("active"),r.set_operator({
key:a});var s=r.getCriteria();l.criteria=s.criteria,l.state=r.saveState(),l.displayText=s.displayText,t.push(l)}}if(null!=e)return $("<span/>").addClass("error").attr("title",e).appendTo(n.children("div.v")),void n.children("div.v").find("input:first").focus();var u=this.get_store().get_items();u.length=0,u.push.apply(u,t),this.get_store().raiseChanged()},e.prototype.addButtonClick=function(t){this.addEmptyRow(!0),t.preventDefault()},e.prototype.resetButtonClick=function(t){t.preventDefault(),this.get_updateStoreOnReset()&&this.get_store().get_items().length>0&&(this.get_store().get_items().length=0,this.get_store().raiseChanged()),this.rowsDiv.empty(),this.updateButtons(),this.get_showInitialLine()&&this.addEmptyRow(!1)},e.prototype.findEmptyRow=function(){var t=null;return this.rowsDiv.children().each((function(e,n){var i=$(n).children("div.f").children("input.field-select").first();if(0===i.length)return!0;var r=i.val();return null!=r&&0!==r.length||(t=$(n),!1)})),t},
e.prototype.addEmptyRow=function(t){var e=this,n=this.findEmptyRow();if(null!=n)return n.find("input.field-select").select2("focus"),t&&n.find("input.field-select").select2("open"),n;var i=this.rowsDiv.children().last().children("a.andor").hasClass("or"),r=$("<div class='filter-line'><a class='delete'><span></span></a><div class='l'><a class='rightparen' href='#'>)</a><a class='andor' href='#'></a><a class='leftparen' href='#'>(</a></div><div class='f'><input type='hidden' class='field-select'></div><div class='o'></div><div class='v'></div><div style='clear: both'></div></div>").appendTo(this.rowsDiv),o=r.children("div.l").hide();o.children("a.leftparen, a.rightparen").click((function(t){return e.leftRightParenClick(t)}));var a=o.children("a.andor").attr("title",v("Controls.FilterPanel.ChangeAndOr"));i?a.addClass("or").text(v("Controls.FilterPanel.Or")):a.text(v("Controls.FilterPanel.And")),a.click((function(t){return e.andOrClick(t)})),
r.children("a.delete").attr("title",v("Controls.FilterPanel.RemoveField")).click((function(t){return e.deleteRowClick(t)}));new Mr(r.children("div.f").children("input"),this.get_store().get_fields()).changeSelect2((function(t){return e.onRowFieldChange(t)}));return this.updateParens(),this.updateButtons(),r.find("input.field-select").select2("focus"),t&&r.find("input.field-select").select2("open"),r},e.prototype.onRowFieldChange=function(t){var e=$(t.target).closest("div.filter-line");this.rowFieldChange(e),e.children("div.o").find("input.op-select").select2("focus")},e.prototype.rowFieldChange=function(t){t.removeData("Filtering");t.children("div.f").find("input.field-select").getWidget(Mr).get_value();this.removeFiltering(t),this.populateOperatorList(t),this.rowOperatorChange(t),this.updateParens(),this.updateButtons()},e.prototype.removeFiltering=function(t){t.data("Filtering",null),t.data("FilteringField",null)},e.prototype.populateOperatorList=function(t){var e=this
;t.children("div.o").html("");var n=this.getFilteringFor(t);if(null!=n){var i=t.children("div.o").html("<input/>").children().attr("type","hidden").addClass("op-select"),r=n.getOperators();new Rr(i,r).changeSelect2((function(t){return e.onRowOperatorChange(t)}))}},e.prototype.getFieldFor=function(t){if(0===t.length)return null;var e=t.children("div.f").find("input.field-select").getWidget(Mr);return l(e.value)?null:this.get_store().get_fieldByName()[e.get_value()]},e.prototype.getFilteringFor=function(t){var e,n=this.getFieldFor(t);if(null==n)return null;var i=z(t.data("Filtering"),wr);if(null!=i)return i;var r=Ir.get(null!==(e=n.filteringType)&&void 0!==e?e:"String"),o=t.children("div.v");return i=new r,Oi.set(i,n.filteringParams),i.set_container(o),i.set_field(n),t.data("Filtering",i),i},e.prototype.onRowOperatorChange=function(t){var e=$(t.target).closest("div.filter-line");this.rowOperatorChange(e);var n=e.children("div.v").find(":input:visible").first();try{n.focus()}catch(t){}},
e.prototype.rowOperatorChange=function(t){if(0!==t.length){t.children("div.v").html("");var e=this.getFilteringFor(t);if(null!=e){var n=t.children("div.o").find("input.op-select").getWidget(Rr);if(!l(n.get_value())){var i=e.getOperators().filter((function(t){return t.key===n.value})),r=i.length>0?i[0]:null;null!=r&&(e.set_operator(r),e.createEditor())}}}},e.prototype.deleteRowClick=function(t){t.preventDefault(),$(t.target).closest("div.filter-line").remove(),0===this.rowsDiv.children().length&&this.search(),this.updateParens(),this.updateButtons()},e.prototype.updateButtons=function(){this.byId("SearchButton").toggle(this.rowsDiv.children().length>=1&&this.showSearchButton),this.byId("ResetButton").toggle(this.rowsDiv.children().length>=1)},e.prototype.andOrClick=function(t){t.preventDefault();var e=$(t.target).toggleClass("or");e.text(v("Controls.FilterPanel."+(e.hasClass("or")?"Or":"And")))},e.prototype.leftRightParenClick=function(t){t.preventDefault(),
$(t.target).toggleClass("active"),this.updateParens()},e.prototype.updateParens=function(){var t=this.rowsDiv.children();if(0!==t.length){t.removeClass("paren-start"),t.removeClass("paren-end"),t.children("div.l").css("display",1===t.length?"none":"block"),t.first().children("div.l").children("a.rightparen, a.andor").css("visibility","hidden");for(var e=1;e<t.length;e++){t.eq(e).children("div.l").css("display","block").children("a.lefparen, a.andor").css("visibility","visible")}for(var n=!1,i=0;i<t.length;i++){var r=t.eq(i),o=r.children("div.l"),a=o.children("a.leftparen");o.children("a.rightparen").hasClass("active")&&n&&(n=!1,i>0&&t.eq(i-1).addClass("paren-end")),a.hasClass("active")&&(n=!0,i>0&&r.addClass("paren-start"))}}},e}(Vr),qr=function(t){function e(){var e=t.call(this)||this;return e.filterPanel=new Lr(e.byId("FilterPanel")),e.filterPanel.set_showInitialLine(!0),e.filterPanel.set_showSearchButton(!1),e.filterPanel.set_updateStoreOnReset(!1),
e.dialogTitle=v("Controls.FilterPanel.DialogTitle"),e}return _(e,t),e.prototype.get_filterPanel=function(){return this.filterPanel},e.prototype.getTemplate=function(){return'<div id="~_FilterPanel"/>'},e.prototype.getDialogButtons=function(){var t=this;return[{text:v("Dialogs.OkButton"),click:function(){t.filterPanel.search(),t.filterPanel.get_hasErrors()?wt(v("Controls.FilterPanel.FixErrorsMessage"),"",null):t.dialogClose()}},{text:v("Dialogs.CancelButton"),click:function(){return t.dialogClose()}}]},e=S([In.registerClass("Serenity.FilterDialog")],e)}(yr),Gr=function(t){function e(e){var n=t.call(this,e)||this;n.element.find(".cap").text(v("Controls.FilterPanel.EffectiveFilter")),n.element.find(".edit").text(v("Controls.FilterPanel.EditFilter")),n.element.find(".reset").attr("title",v("Controls.FilterPanel.ResetFilterHint"));var i=function(t){t.preventDefault();var e=new qr;e.get_filterPanel().set_store(n.get_store()),e.dialogOpen(null)};return n.element.find(".edit").click(i),
n.element.find(".txt").click(i),n.element.find(".reset").click((function(t){t.preventDefault(),n.get_store().get_items().length=0,n.get_store().raiseChanged()})),n}return _(e,t),e.prototype.filterStoreChanged=function(){t.prototype.filterStoreChanged.call(this);var e=g(this.get_store().get_displayText());this.element.find(".current").toggle(null!=e),this.element.find(".reset").toggle(null!=e),null==e&&(e=v("Controls.FilterPanel.EffectiveEmpty")),this.element.find(".txt").text("["+e+"]")},e.prototype.getTemplate=function(){return"<div><a class='reset'></a><a class='edit'></a><div class='current'><span class='cap'></span><a class='txt'></a></div></div>"},e=S([In.registerClass("Serenity.FilterDisplayBar")],e)}(Vr),zr=function(t){function e(e,n){var i=t.call(this,e,P({showRowsPerPage:!0,rowsPerPageOptions:[20,100,500,2e3]},n))||this,r=(n=i.options).view;if(!r)throw"SlickPager requires view option to be set!"
;i.element.addClass("s-SlickPager slick-pg").html('<div class="slick-pg-in"><div class="slick-pg-grp"><div class="slick-pg-first slick-pg-btn"><span class="slick-pg-btn-span"></span></div><div class="slick-pg-prev slick-pg-btn"><span class="slick-pg-btn-span"></span></div></div><div class="slick-pg-sep"></div><div class="slick-pg-grp"><span class="slick-pg-control">&nbsp;'+v("Controls.Pager.Page")+'&nbsp;<input class="slick-pg-current" type="text" size="4" value="1" /> / <span class="slick-pg-total"> 1 </span></span></div><div class="slick-pg-sep"></div><div class="slick-pg-grp"><div class="slick-pg-next slick-pg-btn"><span class="slick-pg-btn-span"></span></div><div class="slick-pg-last slick-pg-btn"><span class="slick-pg-btn-span"></span></div></div><div class="slick-pg-sep"></div><div class="slick-pg-grp"><div class="slick-pg-reload slick-pg-btn"><span class="slick-pg-btn-span"></span></div></div><div class="slick-pg-sep"></div><div class="slick-pg-grp"><span class="slick-pg-stat"></span></div></div>')
;var o=i;if($(".slick-pg-reload",i.element).click((function(){r.populate()})),$(".slick-pg-first",i.element).click((function(){o._changePage("first")})),$(".slick-pg-prev",i.element).click((function(){o._changePage("prev")})),$(".slick-pg-next",i.element).click((function(){o._changePage("next")})),$(".slick-pg-last",i.element).click((function(){o._changePage("last")})),$(".slick-pg-current",i.element).keydown((function(t){13==t.keyCode&&o._changePage("input")})),o.options.showRowsPerPage){for(var a="",l="",s=0;s<n.rowsPerPageOptions.length;s++)l=r.rowsPerPage==n.rowsPerPageOptions[s]?'selected="selected"':"",a+="<option value='"+n.rowsPerPageOptions[s]+"' "+l+" >"+n.rowsPerPageOptions[s]+"&nbsp;&nbsp;</option>";$(".slick-pg-in",i.element).prepend('<div class="slick-pg-grp"><select class="slick-pg-size" name="rp">'+a+'</select></div><div class="slick-pg-sep"></div>'),$("select.slick-pg-size",i.element).change((function(){
n.onRowsPerPageChange?n.onRowsPerPageChange(+this.value):(r.newp=1,r.setPagingOptions({page:1,rowsPerPage:+this.value}))}))}return r.onPagingInfoChanged.subscribe((function(){o._updatePager()})),i}return _(e,t),e.prototype._changePage=function(t){var e=this.options.view;if(!e||e.loading)return!0;var n,i=e.getPagingInfo(),r=i.rowsPerPage&&i.totalCount?Math.ceil(i.totalCount/i.rowsPerPage):1;switch(t){case"first":n=1;break;case"prev":i.page>1&&(n=parseInt(i.page)-1);break;case"next":i.page<r&&(n=parseInt(i.page)+1);break;case"last":n=r;break;case"input":var o=parseInt($("input.slick-pg-current",this.element).val());isNaN(o)||o<1?o=1:o>r&&(o=r),$(".slick-pg-current",this.element).val(o),n=o}if(n==i.page)return!1;this.options.onChangePage?this.options.onChangePage(n):e.setPagingOptions({page:n})},e.prototype._updatePager=function(){var t=this.options.view.getPagingInfo(),e=t.rowsPerPage&&t.totalCount?Math.ceil(t.totalCount/t.rowsPerPage):1;$(".slick-pg-current",this.element).val(t.page),
$(".slick-pg-total",this.element).html(e);var n,i=(t.page-1)*t.rowsPerPage+1,r=i+t.rowsPerPage-1;t.totalCount<r&&(r=t.totalCount),n=t.loading?v("Controls.Pager.LoadingStatus"):t.error?t.error:t.totalCount>0?(n=(n=(n=v("Controls.Pager.PageStatus")).replace(/{from}/,i)).replace(/{to}/,r)).replace(/{total}/,t.totalCount):v("Controls.Pager.NoRowStatus"),$(".slick-pg-stat",this.element).html(n),$(".slick-pg-size",this.element).val((t.rowsPerPage||0).toString())},e}(vi),Hr=function(){function t(){}return t=S([In.registerInterface("Serenity.IInitializeColumn")],t)}();function jr(t,e){return In.registerFormatter("Serenity."+t+"Formatter",e)}var Ur,Wr=function(){function t(){}return t.prototype.format=function(t){var e,n,i;return null==t.value?"":(t.value?null==(i=b(this.trueText))&&null==(i=this.trueText)&&(i=null!==(e=b("Dialogs.YesButton"))&&void 0!==e?e:"Yes"):null==(i=b(this.falseText))&&null==(i=this.falseText)&&(i=null!==(n=b("Dialogs.NoButton"))&&void 0!==n?n:"No"),$t(i))},
S([In.option()],t.prototype,"falseText",void 0),S([In.option()],t.prototype,"trueText",void 0),t=S([jr("Boolean")],t)}(),Kr=function(){function t(){}return t.prototype.format=function(t){return'<span class="check-box no-float readonly '+(t.value?" checked":"")+'"></span>'},t=S([jr("Checkbox")],t)}(),Qr=function(){function t(){this.displayFormat=de.dateFormat}var e;return e=t,t.format=function(t,e){if(null==t)return"";var n;if(t instanceof Date)n=t;else{if("string"!=typeof t)return t.toString();if(null==(n=De(t)))return $t(t)}return $t(Ie(n,e))},t.prototype.format=function(t){return e.format(t.value,this.displayFormat)},S([In.option()],t.prototype,"displayFormat",void 0),t=e=S([jr("Date")],t)}(),Yr=function(t){function e(){var e=t.call(this)||this;return e.displayFormat=de.dateTimeFormat,e}return _(e,t),e=S([jr("DateTime")],e)}(Qr),Jr=function(){function t(){}var e;return e=t,t.prototype.format=function(t){return e.format(fi.get(this.enumKey),t.value)},t.format=function(t,n){
if(null==n)return"";var i=D.toString(t,n),r=j(t,gn,!1),o=r.length>0?r[0].value:V(t);return e.getText(o,i)},t.getText=function(t,e){var n;return l(e)?"":$t(null!==(n=b("Enums."+t+"."+e))&&void 0!==n?n:e)},t.getName=function(t,e){return null==e?"":D.toString(t,e)},S([In.option()],t.prototype,"enumKey",void 0),t=e=S([jr("Enum")],t)}(),Xr=function(){function t(){}var e;return e=t,t.prototype.format=function(t){var n,i=G(t.value,String);if(l(i))return"";var r=e.dbFileUrl(i),o=l(this.originalNameProperty)?null:G(t.item[this.originalNameProperty],String);o=null!=o?o:"";var a=me(null!==(n=this.displayFormat)&&void 0!==n?n:"{0}",o,i,r);return"<a class='file-download-link' target='_blank' href='"+Dt(r)+"'>"+$t(a)+"</a>"},t.dbFileUrl=function(t){return t=m(null!=t?t:"","\\","/"),se("~/upload/")+t},t.prototype.initializeColumn=function(t){t.referencedFields=t.referencedFields||[],l(this.originalNameProperty)||t.referencedFields.push(this.originalNameProperty)},
S([In.option()],t.prototype,"displayFormat",void 0),S([In.option()],t.prototype,"originalNameProperty",void 0),t=e=S([jr("FileDownload",[ct,Hr])],t)}(),Zr=function(){function t(){}var e;return e=t,t.prototype.format=function(t){return e.format(t.value)},t.format=function(t){var e=Math.floor(t/60),n=t-60*e;return null==t||isNaN(t)?"":me("{0}:{1}",e<10?"0"+e:e.toString(),n<10?"0"+n:n.toString())},t=e=S([jr("Minute")],t)}(),to=function(){function t(){}var e;return e=t,t.prototype.format=function(t){return e.format(t.value,this.displayFormat)},t.format=function(t,e){return e=null!=e?e:"0.##",null==t?"":"number"==typeof t?isNaN(t)?"":$t(Ce(t,e)):null==_e(t.toString())?"":$t(t.toString())},S([In.option()],t.prototype,"displayFormat",void 0),t=e=S([jr("Number")],t)}(),eo=function(){function t(){}return t.prototype.format=function(t){var e,n,i,r,o=l(this.urlProperty)?(null!==(n=t.value)&&void 0!==n?n:"").toString():(null!==(e=t.item[this.urlProperty])&&void 0!==e?e:"").toString()
;if(l(o))return"";l(this.urlFormat)||(o=me(this.urlFormat,o)),null!=o&&d(o,"~/")&&(o=se(o));var a=l(this.displayProperty)?(null!==(r=t.value)&&void 0!==r?r:"").toString():(null!==(i=t.item[this.displayProperty])&&void 0!==i?i:"").toString();l(this.displayFormat)||(a=me(this.displayFormat,a));var s="<a href='"+Dt(o)+"'";return l(this.target)||(s+=" target='"+this.target+"'"),s+=">"+$t(a)+"</a>"},t.prototype.initializeColumn=function(t){t.referencedFields=t.referencedFields||[],l(this.displayProperty)?l(this.urlProperty)||t.referencedFields.push(this.urlProperty):t.referencedFields.push(this.displayProperty)},S([In.option()],t.prototype,"displayProperty",void 0),S([In.option()],t.prototype,"displayFormat",void 0),S([In.option()],t.prototype,"urlProperty",void 0),S([In.option()],t.prototype,"urlFormat",void 0),S([In.option()],t.prototype,"target",void 0),t=S([jr("Url",[ct,Hr])],t)}();!function(t){var e;function n(){if(!e){e={};for(var t=0,n=K();t<n.length;t++){var i=n[t];if(L(ct,i)){
var r=V(i).toLowerCase();e[r]=i;for(var o=0,s=St.rootNamespaces;o<s.length;o++){var u=s[o];if(d(r,u.toLowerCase()+".")){var c=r.substr(u.length+1).toLowerCase();null==e[c]&&(e[c]=i)}}}}!function(){for(var t="formatter",n=0,i=Object.keys(e);n<i.length;n++){var r=i[n];if(a(r,t)){var o=r.substr(0,r.length-t.length);l(o)||null==e[o]&&(e[o]=e[r])}}}()}}t.get=function(t){if(l(t))throw new ft("key");n();var i=e[t.toLowerCase()];if(null==i)throw new pt(me("Can't find {0} formatter type!",t));return i},t.reset=function(){e=null}}(Ur||(Ur={}));var no,io,ro,oo,ao,lo,so=function(){function t(t,e){var n=this;this.include={},this.grid=t,this.idField=t.getView().idField,this.options=e||{},t.getGrid().onClick.subscribe((function(e,i){if($(e.target).hasClass("select-item")){e.preventDefault();var r=t.getView().getItem(i.row)[n.idField].toString();n.include[r]?delete n.include[r]:n.include[r]=!0;for(var o=0;o<t.getView().getLength();o++)t.getGrid().updateRow(o);n.updateSelectAll()}})),
t.getGrid().onHeaderClick.subscribe((function(e,i){if(!e.isDefaultPrevented()&&$(e.target).hasClass("select-all-items")){e.preventDefault();t.getView();if(Object.keys(n.include).length>0)Q(n.include);else for(var r=0,o=t.getView().getItems().filter(n.isSelectable.bind(n));r<o.length;r++){var a=o[r][n.idField];n.include[a]=!0}n.updateSelectAll(),t.getView().setItems(t.getView().getItems(),!0)}})),t.getView().onRowsChanged.subscribe((function(){return n.updateSelectAll()}))}return t.prototype.updateSelectAll=function(){var t=this.grid.getElement().find(".select-all-header .slick-column-name .select-all-items");if(t){var e=Object.keys(this.include);t.toggleClass("checked",e.length>0&&this.grid.getView().getItems().filter(this.isSelectable.bind(this)).length<=e.length)}},t.prototype.clear=function(){Q(this.include),this.updateSelectAll()},t.prototype.resetCheckedAndRefresh=function(){this.include={},this.updateSelectAll(),this.grid.getView().populate()},t.prototype.selectKeys=function(t){
for(var e=0,n=t;e<n.length;e++){var i=n[e];this.include[i]=!0}this.updateSelectAll()},t.prototype.getSelectedKeys=function(){return Object.keys(this.include)},t.prototype.getSelectedAsInt32=function(){return Object.keys(this.include).map((function(t){return parseInt(t,10)}))},t.prototype.getSelectedAsInt64=function(){return Object.keys(this.include).map((function(t){return parseInt(t,10)}))},t.prototype.setSelectedKeys=function(t){this.clear();for(var e=0,n=t;e<n.length;e++){var i=n[e];this.include[i]=!0}this.updateSelectAll()},t.prototype.isSelectable=function(t){return t&&(null==this.options.selectable||this.options.selectable(t))},t.createSelectColumn=function(t){return{name:'<span class="select-all-items check-box no-float "></span>',toolTip:" ",field:"__select__",width:27,minWidth:27,headerCssClass:"select-all-header",sortable:!1,format:function(e){var n=e.item,i=t()
;return i&&i.isSelectable(n)?'<span class="select-item check-box no-float '+(i.include[e.item[i.idField]]?" checked":"")+'"></span>':""}}},t=S([In.registerClass("Serenity.GridRowSelectionMixin")],t)}(),uo=function(){function t(t,e){var n=this;this.include={},this.grid=t,this.idField=t.getView().idField,this.options=e||{},t.getGrid().onClick.subscribe((function(e,i){if($(e.target).hasClass("rad-select-item")){e.preventDefault();var r=t.getView().getItem(i.row);if(!n.isSelectable(r))return;var o=r[n.idField].toString();1==n.include[o]?Q(n.include):(Q(n.include),n.include[o]=!0);for(var a=0;a<t.getView().getLength();a++)t.getGrid().updateRow(a)}}))}return t.prototype.isSelectable=function(t){return t&&(null==this.options.selectable||this.options.selectable(t))},t.prototype.clear=function(){Q(this.include)},t.prototype.resetCheckedAndRefresh=function(){this.include={},this.grid.getView().populate()},t.prototype.getSelectedKey=function(){var t=Object.keys(this.include)
;return null!=t&&t.length>0?t[0]:null},t.prototype.getSelectedAsInt32=function(){var t=Object.keys(this.include).map((function(t){return parseInt(t,10)}));return null!=t&&t.length>0?t[0]:null},t.prototype.getSelectedAsInt64=function(){var t=Object.keys(this.include).map((function(t){return parseInt(t,10)}));return null!=t&&t.length>0?t[0]:null},t.prototype.setSelectedKey=function(t){this.clear(),this.include[t]=!0},t.createSelectColumn=function(t){return{name:"",toolTip:" ",field:"__select__",width:27,minWidth:27,headerCssClass:"",sortable:!1,formatter:function(e,n,i,r,o){var a=t();return a&&a.isSelectable(o)?'<input type="radio" name="radio-selection-group" class="rad-select-item no-float" style="cursor: pointer;width: 13px; height:13px;" '+(a.include[o[a.idField]]?" checked":"")+" /> ":""}}},t=S([In.registerClass("GridRadioSelectionMixin")],t)}();!function(t){t.update=function(t,e){var n=t.element.children(".s-Toolbar");if(0!==n.length){
var i=n.getWidget(Ii).findButton("select-all-button"),r=t.getView().getItems();i.toggleClass("checked",r.length>0&&!r.some((function(t){return!e(t)})))}},t.define=function(t,e,n,i,r,o){var a;return null==r&&(r=null!==(a=b("Controls.CheckTreeEditor.SelectAll"))&&void 0!==a?a:"Select All"),{title:r,cssClass:"select-all-button",onClick:function(){var n=t(),r=n.getView(),a=n.element.children(".s-Toolbar").getWidget(Ii).findButton("select-all-button"),l=!a.hasClass("checked");r.beginUpdate();try{for(var s=0,u=r.getItems();s<u.length;s++){var c=u[s];i(c,l),r.updateItem(e(c),c)}o&&o()}finally{r.endUpdate()}a.toggleClass("checked",l)}}}}(no||(no={})),function(t){function e(t,e,n,i,r){var o=$('<div><a href="#"></a></div>').addClass("s-ToggleButton").addClass(e).prependTo(t);o.children("a").click((function(t){t.preventDefault(),o.toggleClass("pressed");var e=o.hasClass("pressed");n&&n(e)})).attr("title",null!=i?i:""),r&&o.addClass("pressed")}function n(t,e,n){
var i=$('<div><input type="text"/></div>').addClass("s-QuickSearchBar").prependTo(t);return null!=n&&n.length>0&&i.addClass("has-quick-search-fields"),new hr(i.children(),{fields:n,onSearch:e})}function i(t,e){var n=new Slick.RowMoveManager({cancelEditOnDrag:!0});n.onBeforeMoveRows.subscribe((function(t,e){for(var n=0;n<e.rows.length;n++)if(e.rows[n]===e.insertBefore||e.rows[n]===e.insertBefore-1)return t.stopPropagation(),!1;return!0})),n.onMoveRows.subscribe((function(n,i){e(i.rows,i.insertBefore);try{t.setSelectedRows([])}catch(t){}})),t.registerPlugin(n)}t.addToggleButton=e,t.addIncludeDeletedToggle=function(t,n,i,r){var o=!1,a=n.onSubmit;n.onSubmit=function(t){return t.params.IncludeDeleted=o,null==a||a(t)},null==i&&(i=v("Controls.EntityGrid.IncludeDeletedToggle")),e(t,"s-IncludeDeletedToggle",(function(t){o=t,n.seekToPage=1,n.populate()}),i,r),t.bind("remove",(function(){n.onSubmit=null,a=null}))},t.addQuickSearchInput=function(t,e,i,r){var o,a=e.onSubmit;e.onSubmit=function(t){
var e;if(o){var n=o.get_value();n&&n.length>0?t.params.ContainsText=n:delete t.params.ContainsText;var i=null===(e=o.get_field())||void 0===e?void 0:e.name;null!=i&&i.length>0?t.params.ContainsField=i:delete t.params.ContainsField}return null==a||a(t)};var l=null;o=n(t,(function(t,n,i){r&&r(),e.seekToPage=1,l=i,e.populate()}),i),e.onDataLoaded.subscribe((function(t,n){null!=l&&(l(e.getLength()>0),l=null)}))},t.addQuickSearchInputCustom=n,t.makeOrderable=i,t.makeOrderableWithUpdateRequest=function(t,e,n,r,o){i(t.getGrid(),(function(i,a){var l,s;if(0!==i.length){var u;a<0?u=1:a>=t.getGrid().getDataLength()?0===(u=null!==(l=n(t.getGrid().getDataItem(t.getGrid().getDataLength()-1)))&&void 0!==l?l:0)?u=a+1:u+=1:0===(u=null!==(s=n(t.getGrid().getDataItem(a)))&&void 0!==s?s:0)&&(u=a+1);var c=0,d=null;(d=function(){oe({service:r,request:o(e(t.getGrid().getDataItem(i[c])),u++),onSuccess:function(e){++c<i.length?d():t.getView().populate()}})})()}}))}}(io||(io={})),function(t){
t.toSlickColumns=function(e){var n=[];if(null==e)return n;for(var i=0;i<e.length;i++)n.push(t.toSlickColumn(e[i]));return n},t.toSlickColumn=function(t){var e,n,i={field:t.name,sourceItem:t,cssClass:t.cssClass,headerCssClass:t.headerCssClass,sortable:!1!==t.sortable,sortOrder:null!==(e=t.sortOrder)&&void 0!==e?e:0,width:null!=t.width?t.width:80,minWidth:null!==(n=t.minWidth)&&void 0!==n?n:30,maxWidth:null==t.maxWidth||0===t.maxWidth?null:t.maxWidth,resizable:null==t.resizable||!!t.resizable};i.visible=!1!==t.visible&&!0!==t.filterOnly&&(null==t.readPermission||Fe.hasPermission(t.readPermission));var r=b(t.title);if(null==r&&(r=t.title),i.name=r,null!=t.alignment&&t.alignment.length>0&&(l(i.cssClass)?i.cssClass="align-"+t.alignment:i.cssClass+=" align-"+t.alignment),null!=t.formatterType&&t.formatterType.length>0){var o=new(Ur.get(t.formatterType));null!=t.formatterParams&&Oi.set(o,t.formatterParams);var a=G(o,Hr);null!=a&&a.initializeColumn(i),i.format=function(t){return o.format(t)}}
return i}}(ro||(ro={})),function(t){function e(t,e,n,i,r){return"<a"+(null!=e?' href="#'+m(t,".","-")+"/"+e+'"':"")+' data-item-type="'+Dt(t)+'" data-item-id="'+Dt(e)+'" class="s-EditLink s-'+m(t,".","-")+"Link"+(l(i)?"":" "+i)+'">'+(r?$t(null!=n?n:""):null!=n?n:"")+"</a>"}t.getEnumText=function(t,e){return Jr.getText(t,e)},t.treeToggle=function(t,e,n){return function(i){var r,o,a=n(i),l=t(),s=null!==(r=i.item._indent)&&void 0!==r?r:0,u='<span class="s-TreeIndent" style="width:'+15*s+'px"></span>',c=e(i.item),d=l.getIdxById(c),p=l.getItemByIdx(d+1);if(null!=p&&(null!==(o=p._indent)&&void 0!==o?o:0)>s)return i.item._collapsed?u+'<span class="s-TreeToggle s-TreeExpand"></span>'+a:u+'<span class="s-TreeToggle s-TreeCollapse"></span>'+a;return u+'<span class="s-TreeToggle"></span>'+a}},t.date=function(t){return null==t&&(t=de.dateFormat),function(e){return $t(Qr.format(e.value,t))}},t.dateTime=function(t){return null==t&&(t=de.dateTimeFormat),function(e){return $t(Qr.format(e.value,t))}},
t.checkBox=function(){return function(t){return'<span class="check-box no-float '+(t.value?" checked":"")+'"></span>'}},t.number=function(t){return function(e){return to.format(e.value,t)}},t.getItemType=function(t){return t.data("item-type")},t.getItemId=function(t){var e=t.data("item-id");return null==e?null:e.toString()},t.itemLinkText=e,t.itemLink=function(t,n,i,r,o){return function(a){var l,s,u=null!==(l=null==i?a.value:i(a))&&void 0!==l?l:"";return(null===(s=a.item)||void 0===s?void 0:s.__nonDataRow)?o?$t(u):u:e(t,a.item[n],null==i?a.value:i(a),null==r?"":r(a),o)}}}(oo||(oo={})),function(t){function e(t){return null==t?null:function(e,n,i,r,o){return t({row:e,cell:n,value:i,column:r,item:o})}}t.setDefaults=function(t,n){for(var i=0,r=t;i<r.length;i++){var o=r[i];o.sortable=null==o.sortable||o.sortable;var a=o.id;if(null==a&&(a=o.field),o.id=a,null!=n&&null!=o.id&&(null==o.name||d(o.name,"~"))){var l=null!=o.name?o.name.substr(1):o.id;o.name=v(n+l)}
null==o.formatter&&null!=o.format?o.formatter=e(o.format):null==o.formatter&&(o.formatter=function(t,e,n,i,r){return $t(n)})}return t},t.convertToFormatter=e}(ao||(ao={})),function(t){function e(t,e){for(var n=e(t),i=0;null!=n;){if(n._collapsed)return!1;if(n=e(n),i++>1e3)throw new Error("Possible infinite loop, check parents has no circular reference!")}return!0}function n(t,e){if(null!=t)for(var n=0,i=t;n<i.length;n++){i[n]._collapsed=e}}t.filterCustom=e,t.filterById=function(t,n,i){return e(t,(function(t){var e=i(t);return null==e?null:n.getItemById(e)}))},t.setCollapsed=n,t.setCollapsedFlag=function(t,e){t._collapsed=e},t.setIndents=function(t,e,n,i){for(var r=0,o={},a=0;a<t.length;a++){var l=t[a];if(a>0){var s=n(l);null!=s&&s===e(t[a-1])?r+=1:null==s?r=0:s!==n(t[a-1])&&(r=null!=o[s]?o[s]+1:0)}o[e(l)]=r,l._indent=r,null!=i&&(l._collapsed=i)}},t.toggleClick=function(t,e,i,r,o){var a=$(t.target)
;if(a.hasClass("s-TreeToggle")&&(a.hasClass("s-TreeCollapse")||a.hasClass("s-TreeExpand"))){var l=r.getItem(e);if(null!=l&&(l._collapsed?l._collapsed=!1:l._collapsed=!0,r.updateItem(o(l),l)),t.shiftKey){r.beginUpdate();try{n(r.getItems(),!!l._collapsed),r.setItems(r.getItems(),!0)}finally{r.endUpdate()}}}}}(lo||(lo={}));var co,po=function(t){var e,n,i,r,o,a,l,s,u,c,d=this,p=[],h=[],f={},g=null,m=null,y=null,b=0,C=!0,w={},_={},S=[],k=[],I={getter:null,formatter:null,comparer:function(t,e){return t.value===e.value?0:t.value>e.value?1:-1},predefinedValues:[],aggregateEmpty:!1,aggregateCollapsed:!1,aggregateChildGroups:!1,collapsed:!1,displayTotalsRow:!0,lazyTotalsCalculation:!1},x={},T=[],F=[],D=[],E=":|:",A=1,N=0,B=new Slick.Event,V=new Slick.Event,M=new Slick.Event,R=new Slick.Event,L=new Slick.Event,q=new Slick.Event,G=new Slick.Event,z=new Slick.Event,H=new Slick.Event,j=!1,U=null,W=0,K=0,Q=null,Y=null!==(e=null==t?void 0:t.localSort)&&void 0!==e&&e;function J(t){
for(var e,i=t=t||0,r=p.length;i<r;i++){if(void 0===(e=p[i][n])){var o="Each data element must implement a unique '"+n+"' property. Object at index '"+i+"' has no identity value: ";throw o+=$.toJSON(p[i])}f[e]=i}}function X(t,e){null!=e&&"string"==typeof e&&(n=e),p=S=t,Y&&p.sort(tt()),f={},g=null,x.totals={},J(),function(){for(var t,e=0,i=p.length;e<i;e++)if(void 0===(t=p[e][n])||f[t]!==e){var r="Each data element must implement a unique '"+n+"' property. Object at index '"+e+"' ";throw(r+=null==t?"has no identity value: ":"has repeated identity value '"+t+"': ")+$.toJSON(p[e])}}(),b?kt(p):It(),B.notify({dataView:d},null,d)}function Z(){return{rowsPerPage:c.rowsPerPage,page:A,totalCount:Q,loading:j,error:U,dataView:c}}function tt(){if(null!=r)return r;for(var t=[],e=[],n=0,i=c.sortBy||[];n<i.length;n++){var o=i[n];null!=o&&(o.length>5&&" desc"==o.toLowerCase().substr(o.length-5).toLowerCase()?(e.push(!1),t.push(o.substr(0,o.length-5))):(e.push(!0),t.push(o)))}return function(n,i){
for(var r=0,o=t.length;r<o;r++){var a=t[r],l=e[r]?1:-1,s=n[a],u=i[a],c=(s==u?0:s>u?1:-1)*l;if(0!=c)return c}return 0}}function et(t,e){C=e,i=null,!1===e&&p.reverse(),r=t,p.sort(tt()),!1===e&&p.reverse(),f={},J(),It()}function nt(t,e){C=e,i=t,r=null;var n=Object.prototype.toString;Object.prototype.toString="function"==typeof t?t:function(){return this[t]},!1===e&&p.reverse(),p.sort(),Object.prototype.toString=n,!1===e&&p.reverse(),f={},J(),It()}function it(e){t.groupItemMetadataProvider||(t.groupItemMetadataProvider=new Slick.Data.GroupItemMetadataProvider),F=[],D=[],T=(e=e||[])instanceof Array?e:[e];for(var n=0;n<T.length;n++){var i=T[n]=P(P({},I),O(T[n]));i.aggregators=i.aggregators||x.aggregators||[],i.getterIsAFn="function"==typeof i.getter,i.compiledAccumulators=[];for(var r=i.aggregators.length;r--;)i.compiledAccumulators[r]=bt(i.aggregators[r]);D[n]={}}It()}function rt(){if(!g){g={};for(var t=0,e=h.length;t<e;t++)g[h[t][n]]=t}}function ot(t){return p[f[t]]}function at(t,e){
if(void 0===f[t])throw new Error("Invalid id");if(t!==e[n]){var i=e[n];if(null==i)throw new Error("Cannot update item to associate with a null id");if(void 0!==f[i])throw new Error("Cannot update item to associate with a non-unique id");f[i]=f[t],delete f[t],y&&y[t]&&delete y[t],t=i}p[f[t]]=e,y||(y={}),y[t]=!0,It()}function lt(t,e){p.splice(t,0,e),J(t),It()}function st(t){var e=f[t];if(void 0===e)throw"Invalid id";delete f[t],p.splice(e,1),J(e),It()}function ut(t){lt(function(t){for(var e=0,n=p.length,i=tt();e<n;){var r=e+n>>>1;-1===i(p[r],t)?e=r+1:n=r}return e}(t),t)}function ct(t,e){if(null==t)for(var n=0;n<T.length;n++)D[n]={},T[n].collapsed=e,!0===e?L.notify({level:n,groupingKey:null}):R.notify({level:n,groupingKey:null});else D[t]={},T[t].collapsed=e,!0===e?L.notify({level:t,groupingKey:null}):R.notify({level:t,groupingKey:null});It()}function dt(t,e){var n=function(t){var e=t[0];return 1===t.length&&-1!==e.indexOf(E)?{level:e.split(E).length-1,groupingKey:e}:{level:t.length-1,
groupingKey:t.join(E)}}(t);D[n.level][n.groupingKey]=T[n.level].collapsed^e,e?L.notify({level:n.level,groupingKey:n.groupingKey}):R.notify({level:n.level,groupingKey:n.groupingKey}),It()}function pt(t,e,n,i,r){var o=t[e];return o||((o=new Slick.Group).value=e,o.level=n,o.groupingKey=(i?i.groupingKey+E:"")+e,r[r.length]=o,t[e]=o),o}function ht(t,e){for(var n,i,r=[],o={},a=e?e.level+1:0,l=T[a],s=0,u=l.predefinedValues.length;s<u;s++)n=pt(o,l.predefinedValues[s],a,e,r);for(s=0,u=t.length;s<u;s++)i=t[s],(n=pt(o,l.getterIsAFn?l.getter(i):i[l.getter],a,e,r)).rows[n.count++]=i;if(a<T.length-1)for(s=0;s<r.length;s++)(n=r[s]).groups=ht(n.rows,n);return r.length&&mt(r,a),r.sort(T[a].comparer),r}function ft(t){var e,n=t.group,i=T[n.level],r=n.level==T.length,o=i.aggregators.length;if(!r&&i.aggregateChildGroups)for(var a=n.groups.length;a--;)n.groups[a].totals.initialized||ft(n.groups[a].totals);for(;o--;)(e=i.aggregators[o]).init(),
!r&&i.aggregateChildGroups?i.compiledAccumulators[o].call(e,n.groups):i.compiledAccumulators[o].call(e,n.rows),e.storeResult(t);t.initialized=!0}function gt(t){var e=T[t.level],n=new Slick.GroupTotals;n.group=t,t.totals=n,e.lazyTotalsCalculation||ft(n)}function mt(t,e){for(var n,i=T[e=e||0],r=i.collapsed,o=D[e],a=t.length;a--;)(n=t[a]).collapsed&&!i.aggregateCollapsed||(n.groups&&mt(n.groups,e+1),i.aggregators.length&&(i.aggregateEmpty||n.rows.length||n.groups&&n.groups.length)&&gt(n),n.collapsed=r^o[n.groupingKey],n.title=i.formatter?i.formatter(n):n.value)}function yt(t,e){for(var n,i,r=T[e=e||0],o=[],a=0,l=0,s=t.length;l<s;l++){if(i=t[l],o[a++]=i,!i.collapsed)for(var u=0,c=(n=i.groups?yt(i.groups,e+1):i.rows).length;u<c;u++)o[a++]=n[u];i.totals&&r.displayTotalsRow&&(!i.collapsed||r.aggregateCollapsed)&&(o[a++]=i.totals)}return o}function vt(t){var e=t.toString().match(/^function[^(]*\(([^)]*)\)\s*{([\s\S]*)}$/);return{params:e[1].split(","),body:e[2]}}function bt(t){
var e=vt(t.accumulate);return new Function("_items","for (var "+e.params[0]+", _i=0, _il=_items.length; _i<_il; _i++) {"+e.params[0]+" = _items[_i]; "+e.body+"}")}function Ct(t,e){for(var n=[],i=0,r=0,o=t.length;r<o;r++)m(t[r],e)&&(n[i++]=t[r]);return n}function _t(t,e,n){for(var i,r=[],o=0,a=0,l=t.length;a<l;a++)i=t[a],n[a]?r[o++]=i:m(i,e)&&(r[o++]=i,n[a]=!0);return r}function St(e){if(m){var n=t.inlineFilters?a:Ct,i=t.inlineFilters?l:_t;w.isFilterNarrowing?S=n(S,o):w.isFilterExpanding?S=i(e,o,k):w.isFilterUnchanged||(S=n(e,o))}else S=e.concat();return{totalRows:S.length,rows:S}}function kt(t){g=null,w.isFilterNarrowing==_.isFilterNarrowing&&w.isFilterExpanding==_.isFilterExpanding||(k=[]);var e=St(t);N=e.totalRows;var i=e.rows;x.totals={},F=[],T.length&&(F=ht(i)).length&&(i=yt(F));var r=function(t,e){var i,r,o,a=[],l=0,s=e.length;w&&w.ignoreDiffsBefore&&(l=Math.max(0,Math.min(e.length,w.ignoreDiffsBefore))),w&&w.ignoreDiffsAfter&&(s=Math.min(e.length,Math.max(0,w.ignoreDiffsAfter)))
;for(var u=l,c=t.length;u<s;u++)u>=c?a[a.length]=u:(i=e[u],r=t[u],(T.length&&(o=i.__nonDataRow||r.__nonDataRow)&&i.__group!==r.__group||i.__group&&!i.equals(r)||o&&(i.__groupTotals||r.__groupTotals)||i[n]!=r[n]||y&&y[i[n]])&&(a[a.length]=u));return a}(h,i);return h=i,r}function It(){if(!b){var t=h.length,e=N,n=kt(p);y=null,_=w,w={},e!==N&&q.notify(Z(),null,d),t!==h.length&&G.notify({previous:t,current:h.length,dataView:d},null,d),n.length>0&&z.notify({rows:n,dataView:d},null,d),(t!==h.length||n.length>0)&&H.notify({rowsDiff:n,previousRowCount:t,currentRowCount:h.length,rowCountChanged:t!==h.length,rowsChanged:n.length>0,dataView:d},null,d)}}function xt(t){if(c.onProcessData&&t&&(t=c.onProcessData(t,c)||t),U=null,j&&j.abort(),j=!1,!t)return U=c.errormsg,q.notify(Z()),!1;t.TotalCount=t.TotalCount||0,t.Entities=t.Entities||[],t.Skip&&(c.rowsPerPage||t.Take)?t.Page=Math.ceil(t.Skip/(t.Take||c.rowsPerPage))+1:t.Page=1,A=t.Page,Q=t.TotalCount,X(t.Entities),q.notify(Z())}function Tt(){
if(W>0)K++;else{if(K=0,j&&j.abort(),c.onSubmit&&!1===c.onSubmit(c))return!1;if(V.notify(this),!c.url)return!1;c.seekToPage||(c.seekToPage=1);var t={},e=(c.seekToPage-1)*c.rowsPerPage;e&&(t.Skip=e),c.rowsPerPage&&(t.Take=c.rowsPerPage),c.sortBy&&c.sortBy.length&&("string"!=typeof c.sortBy?t.Sort=c.sortBy:t.Sort=[c.sortBy]),c.params&&(t=P(t,c.params));var n=u,i={cache:!1,type:c.method,contentType:s,url:c.url,data:t,dataType:n,success:function(t){j=!1,t.Error?wt(t.Error.Message||t.Error.Code):xt(t),M.notify(this)},error:function(t,e,n){if(j=!1,(t.getResponseHeader("content-type")||"").toLowerCase().indexOf("application/json")>=0){var i=$.parseJSON(t.responseText);if(null!=i&&null!=i.Error)return wt(i.Error.Message||i.Error.Code),q.notify(Z()),void M.notify(this)}U=t.errormsg,q.notify(Z()),M.notify(this)},complete:function(){j=!1}};if(c.onAjaxCall&&!1===c.onAjaxCall(this,i))return j=!1,q.notify(Z()),!1;i.data=$.toJSON(i.data),q.notify(Z()),j=$.ajax(i)}}return n=t.idField||"id",
s=t.contentType||"application/json",u=t.dataType||"json",m=t.filter||null,c={beginUpdate:function(){b++},endUpdate:function(){--b<=0&&It()},setPagingOptions:function(t){var e,n=!1;null!=t.rowsPerPage&&c.rowsPerPage!=t.rowsPerPage&&(c.rowsPerPage=t.rowsPerPage,n=!0),null!=t.page&&((e=c.rowsPerPage?null==Q?t.page:Math.min(t.page,Math.ceil(Q/c.rowsPerPage)+1):1)<1&&(e=1),e!=A&&(c.seekToPage=e,n=!0)),n&&Tt()},getPagingInfo:Z,getIdPropertyName:function(){return n},getRows:function(){return h},getItems:function(){return p},setItems:X,getFilter:function(){return m},getFilteredItems:function(){return S},setFilter:function(e){m=e,t.inlineFilters&&(a=function(){
var t=vt(m),e=t.body.replace(/return false\s*([;}]|$)/gi,"{ continue _coreloop; }$1").replace(/return true\s*([;}]|$)/gi,"{ _retval[_idx++] = $item$; continue _coreloop; }$1").replace(/return ([^;}]+?)\s*([;}]|$)/gi,"{ if ($1) { _retval[_idx++] = $item$; }; continue _coreloop; }$2"),n=["var _retval = [], _idx = 0; ","var $item$, $args$ = _args; ","_coreloop: ","for (var _i = 0, _il = _items.length; _i < _il; _i++) { ","$item$ = _items[_i]; ","$filter$; ","} ","return _retval; "].join("");n=(n=(n=n.replace(/\$filter\$/gi,e)).replace(/\$item\$/gi,t.params[0])).replace(/\$args\$/gi,t.params[1]);var i=new Function("_items,_args",n);return i.displayName=i.name="compiledFilter",i}(),l=function(){
var t=vt(m),e=t.body.replace(/return false\s*([;}]|$)/gi,"{ continue _coreloop; }$1").replace(/return true\s*([;}]|$)/gi,"{ _cache[_i] = true;_retval[_idx++] = $item$; continue _coreloop; }$1").replace(/return ([^;}]+?)\s*([;}]|$)/gi,"{ if ((_cache[_i] = $1)) { _retval[_idx++] = $item$; }; continue _coreloop; }$2"),n=["var _retval = [], _idx = 0; ","var $item$, $args$ = _args; ","_coreloop: ","for (var _i = 0, _il = _items.length; _i < _il; _i++) { ","$item$ = _items[_i]; ","if (_cache[_i]) { ","_retval[_idx++] = $item$; ","continue _coreloop; ","} ","$filter$; ","} ","return _retval; "].join("");n=(n=(n=n.replace(/\$filter\$/gi,e)).replace(/\$item\$/gi,t.params[0])).replace(/\$args\$/gi,t.params[1]);var i=new Function("_items,_args,_cache",n),r="compiledFilterWithCaching";return i.displayName=r,i.name=function(t,e){try{Object.defineProperty(t,"name",{writable:!0,value:e})}catch(n){t.name=e}}(i,r),i}()),It()},sort:et,fastSort:nt,reSort:function(){i?nt(i,C):et(r,C)},
getLocalSort:function(){return Y},setLocalSort:function(t){Y!=t&&(Y=t,et())},setSummaryOptions:function(t){t=t||{},x.aggregators=t.aggregators||[],x.compiledAccumulators=[],x.totals={};for(var e=x.aggregators.length;e--;)x.compiledAccumulators[e]=bt(x.aggregators[e]);it(T||[])},getGrandTotals:function(){if(x.totals=x.totals||{},!x.totals.initialized){x.aggregators=x.aggregators||[],x.compiledAccumulators=x.compiledAccumulators||[];for(var t,e=x.aggregators.length;e--;)(t=x.aggregators[e]).init(),x.compiledAccumulators[e].call(t,p),t.storeResult(x.totals);x.totals.initialized=!0}return x.totals},setGrouping:it,getGrouping:function(){return T},collapseAllGroups:function(t){ct(t,!0)},expandAllGroups:function(t){ct(t,!1)},collapseGroup:function(t){var e=Array.prototype.slice.call(arguments);dt(e,!0)},expandGroup:function(t){var e=Array.prototype.slice.call(arguments);dt(e,!1)},getGroups:function(){return F},getIdxById:function(t){return f[t]},getRowByItem:function(t){return rt(),g[t[n]]},
getRowById:function(t){return rt(),g[t]},getItemById:ot,getItemByIdx:function(t){return p[t]},mapItemsToRows:function(t){var e=[];rt();for(var i=0,r=t.length;i<r;i++){var o=g[t[i][n]];null!=o&&(e[e.length]=o)}return e},mapRowsToIds:function(t){for(var e=[],i=0,r=t.length;i<r;i++)t[i]<h.length&&(e[e.length]=h[t[i]][n]);return e},mapIdsToRows:function(t){var e=[];rt();for(var n=0,i=t.length;n<i;n++){var r=g[t[n]];null!=r&&(e[e.length]=r)}return e},setRefreshHints:function(t){w=t},setFilterArgs:function(t){o=t},refresh:It,updateItem:at,insertItem:lt,addItem:function(t){p.push(t),J(p.length-1),It()},deleteItem:st,sortedAddItem:ut,sortedUpdateItem:function(t,e){if(void 0===f[t]||t!==e[n])throw new Error("Invalid or non-matching id "+f[t]);0!==tt()(ot(t),e)?(st(t),ut(e)):at(t,e)},syncGridSelection:function(t,e,n){var i,r=this,o=r.mapRowsToIds(t.getSelectedRows()),a=new Slick.Event;function l(e){o.join(",")!=e.join(",")&&(o=e,a.notify({grid:t,ids:o,dataView:r},new Slick.EventData,r))}
function s(){if(o.length>0){i=!0;var n=r.mapIdsToRows(o);e||l(r.mapRowsToIds(n)),t.setSelectedRows(n),i=!1}}return t.onSelectedRowsChanged.subscribe((function(e,a){if(!i){var s=r.mapRowsToIds(t.getSelectedRows());n&&t.getOptions().multiSelect?l($.grep(o,(function(t){return void 0===r.getRowById(t)})).concat(s)):l(s)}})),this.onRowsChanged.subscribe(s),this.onRowCountChanged.subscribe(s),a},syncGridCellCssStyles:function(t,e){var i,r;function o(t){for(var e in i={},t){var r=h[e][n];i[r]=t[e]}}function a(){if(i){r=!0,rt();var n={};for(var o in i){var a=g[o];null!=a&&(n[a]=i[o])}t.setCellCssStyles(e,n),r=!1}}o(t.getCellCssStyles(e));var l=function(n,i){r||e==i.key&&(i.hash?o(i.hash):(t.onCellCssStylesChanged.unsubscribe(l),H.unsubscribe(a)))};t.onCellCssStylesChanged.subscribe(l),H.subscribe(a)},getLength:function(){return h.length},getItem:function(t){var e=h[t];if(e&&e.__group&&e.totals&&!e.totals.initialized){var n=T[e.level];n.displayTotalsRow||(ft(e.totals),
e.title=n.formatter?n.formatter(e):e.value)}else e&&e.__groupTotals&&!e.initialized&&ft(e);return e},getItemMetadata:function(e){var n=h[e];return void 0===n?null:n.__group?t.groupItemMetadataProvider.getGroupRowMetadata(n):n.__groupTotals?t.groupItemMetadataProvider.getTotalsRowMetadata(n):t.getItemMetadata&&t.getItemMetadata(n,e)||null},onRowCountChanged:G,onRowsChanged:z,onRowsOrCountChanged:H,onPagingInfoChanged:q,onGroupExpanded:R,onGroupCollapsed:L,addData:xt,populate:Tt,populateLock:function(){0==W&&(K=0),W++},populateUnlock:function(){W>0&&0==--W&&K>0&&Tt()},onDataChanged:B,onDataLoaded:M,onDataLoading:V,params:t.params||{},onSubmit:t.onSubmit||null,url:t.url||null,rowsPerPage:t.rowsPerPage||0,seekToPage:t.seekToPage||1,onAjaxCall:t.onAjaxCall||null,onProcessData:t.onProcessData||null,method:t.method||"POST",errormsg:v("Controls.Pager.DefaultLoadError"),sortBy:"string"==typeof t.sortBy?[t.sortBy]:t.sortBy||[],idField:n},t.url&&t.autoLoad&&Tt(),c},ho=function(t){function e(e,n){
var i=t.call(this,e,n)||this;i.restoringSettings=0;var r=i;i.element.addClass("s-DataGrid").html(""),i.element.addClass("s-"+M(R(i)));var o=function(){r.layout(),null!=r.layoutTimer&&Pe.store(r.layoutTimer)};i.element.addClass("require-layout").on("layout."+i.uniqueName,o),i.useLayoutTimer()&&(i.layoutTimer=Pe.onSizeChange((function(){return i.element&&i.element[0]}),He(o,50))),i.setTitle(i.getInitialTitle());var a=i.getButtons();return null!=a&&i.createToolbar(a),i.slickContainer=i.createSlickContainer(),i.view=i.createView(),i.slickGrid=i.createSlickGrid(),i.enableFiltering()&&i.createFilterBar(),i.usePager()&&i.createPager(),i.bindToSlickEvents(),i.bindToViewEvents(),null!=a&&i.createToolbarExtensions(),i.createQuickFilters(),i.updateDisabledState(),i.updateInterface(),i.initialSettings=i.getCurrentSettings(null),i.restoreSettings(null,null),window.setTimeout((function(){return i.initialPopulate()}),0),i}var i;return _(e,t),i=e,e.prototype.useLayoutTimer=function(){return!0},
e.prototype.attrs=function(t){return j(R(this),t,!0)},e.prototype.layout=function(){if(this.element&&this.element.is(":visible")&&null!=this.slickContainer){var t=this.element.hasClass("responsive-height"),e=null!=this.slickGrid&&this.slickGrid.getOptions().autoHeight;t&&window.innerWidth<768?(this.element[0]&&"auto"!=this.element[0].style.height&&(this.element[0].style.height="auto"),e||(this.slickContainer.css("height","auto").children(".slick-pane").each((function(t,e){null!=e.style.height&&"auto"!=e.style.height&&(e.style.height="auto")})),this.slickGrid.setOptions({autoHeight:!0}))):(e&&(this.slickContainer.children(".slick-viewport").css("height","auto"),this.slickGrid.setOptions({autoHeight:!1})),sn(this.slickContainer)),this.slickGrid.resizeCanvas()}},e.prototype.getInitialTitle=function(){return null},e.prototype.createToolbarExtensions=function(){},e.prototype.ensureQuickFilterBar=function(){return null==this.quickFiltersDiv&&this.createQuickFilters([]),this.quickFiltersBar},
e.prototype.createQuickFilters=function(t){var e=this;null==this.quickFiltersDiv&&(null!=t||(t=this.getQuickFilters())&&null!=t&&t.length)&&(this.quickFiltersDiv=$("<div/>").addClass("quick-filters-bar"),this.toolbar?($("<div/>").addClass("clear").appendTo(this.toolbar.element),this.quickFiltersDiv.appendTo(this.toolbar.element)):this.quickFiltersDiv.appendTo($("<div/>").addClass("s-Toolbar").insertBefore(this.slickContainer)),this.quickFiltersBar=new pr(this.quickFiltersDiv,{filters:t,getTitle:function(t){return e.determineText((function(e){return e+t.field}))},idPrefix:this.uniqueName+"_QuickFilter_"}),this.quickFiltersBar.onChange=function(t){return e.quickFilterChange(t)})},e.prototype.getQuickFilters=function(){return this.allColumns.filter((function(t){return t.sourceItem&&!0===t.sourceItem.quickFilter&&(null==t.sourceItem.readPermission||Fe.hasPermission(t.sourceItem.readPermission))})).map((function(t){return i.propertyItemToQuickFilter(t.sourceItem)})).filter((function(t){
return null!=t}))},e.propertyItemToQuickFilter=function(t){var e,n,i={},r=t.name,o=b(t.title);null==o&&null==(o=t.title)&&(o=r);var a=Ir.get(null!==(e=t.filteringType)&&void 0!==e?e:"String");if(a===Tr)i=pr.dateRange(r,o);else if(a===Pr)i=pr.dateTimeRange(r,o,null===(n=t.editorParams)||void 0===n?void 0:n.useUtc);else if(a===Fr){var l=t.quickFilterParams||{},s=t.filteringParams||{},u=l.trueText;null==u&&(u=s.trueText);var c=l.falseText;null==c&&(c=s.falseText),i=pr.boolean(r,o,u,c)}else{var d=new a;if(!d||!q(d,_r))return null;Oi.set(d,t.filteringParams),d.set_field(t),d.set_operator({key:mr.EQ}),d.initQuickFilter(i),i.options=P(O(i.options),t.quickFilterParams)}return t.quickFilterSeparator&&(i.separator=!0),i.cssClass=t.quickFilterCssClass,i},e.prototype.findQuickFilter=function(t,e){return null!=this.quickFiltersBar?this.quickFiltersBar.find(t,e):$("#"+this.uniqueName+"_QuickFilter_"+e).getWidget(t)},e.prototype.tryFindQuickFilter=function(t,e){
if(null!=this.quickFiltersBar)return this.quickFiltersBar.tryFind(t,e);var n=$("#"+this.uniqueName+"_QuickFilter_"+e);return n.length?n.tryGetWidget(t):null},e.prototype.createIncludeDeletedButton=function(){l(this.getIsActiveProperty())&&l(this.getIsDeletedProperty())||io.addIncludeDeletedToggle(this.toolbar.element,this.view,null,!1)},e.prototype.getQuickSearchFields=function(){return null},e.prototype.createQuickSearchInput=function(){var t=this;io.addQuickSearchInput(this.toolbar.element,this.view,this.getQuickSearchFields(),(function(){return t.persistSettings(null)}))},e.prototype.destroy=function(){this.layoutTimer&&(this.layoutTimer=Pe.off(this.layoutTimer)),this.quickFiltersBar&&(this.quickFiltersBar.destroy(),this.quickFiltersBar=null),this.toolbar&&(this.toolbar.destroy(),this.toolbar=null),this.slickGrid&&(this.slickGrid.onClick.clear(),this.slickGrid.onSort.clear(),this.slickGrid.onColumnsResized.clear(),this.slickGrid.onColumnsReordered.clear(),this.slickGrid.destroy(),
this.slickGrid=null),this.view&&(this.view.onDataChanged.clear(),this.view.onSubmit=null,this.view.setFilter(null),this.view=null),this.titleDiv=null,t.prototype.destroy.call(this)},e.prototype.getItemCssClass=function(t,e){var n=this.getIsActiveProperty(),i=this.getIsDeletedProperty();if(l(n)&&l(i))return null;if(!n)return t[i]?"deleted":null;var r=t[n];if(null==r)return null;if("number"==typeof r){if(r<0)return"deleted";if(0===r)return"inactive"}else if("boolean"==typeof r&&!1===r)return"deleted";return null},e.prototype.getItemMetadata=function(t,e){var n=this.getItemCssClass(t,e);return l(n)?new Object:{cssClasses:n}},e.prototype.postProcessColumns=function(t){ao.setDefaults(t,this.getLocalTextDbPrefix());var e=this.getColumnWidthDelta(),n=this.getColumnWidthScale();if(n<0&&(n=1),0!==e||1!==n)for(var i=0,r=t;i<r.length;i++){var o=r[i];"number"==typeof o.width&&(o.width=o.width*n+e),"number"==typeof o.minWidth&&(o.minWidth=o.minWidth*n+e),
"number"==typeof o.maxWidth&&(o.maxWidth=o.maxWidth*n+e)}return t},e.prototype.getColumnWidthDelta=function(){var t;return null!==(t=i.defaultColumnWidthDelta)&&void 0!==t?t:0},e.prototype.getColumnWidthScale=function(){var t;return null!==(t=i.defaultColumnWidthScale)&&void 0!==t?t:1},e.prototype.initialPopulate=function(){var t=this;this.populateWhenVisible()?(We.executeEverytimeWhenShown(this.element,(function(){t.refreshIfNeeded()}),!1),this.element.is(":visible")&&this.view&&this.view.populate()):this.view&&this.view.populate()},e.prototype.canFilterColumn=function(t){return null!=t.sourceItem&&!0!==t.sourceItem.notFilterable&&(null==t.sourceItem.readPermission||Fe.hasPermission(t.sourceItem.readPermission))},e.prototype.initializeFilterBar=function(){var t=this;this.filterBar.set_store(new Cr(this.allColumns.filter((function(e){return t.canFilterColumn(e)})).map((function(t){return t.sourceItem})))),this.filterBar.get_store().add_changed((function(e,n){
t.restoringSettings<=0&&(t.persistSettings(null),t.view&&(t.view.seekToPage=1),t.refresh())}))},e.prototype.createSlickGrid=function(){this.allColumns=this.getColumns();var t=this.postProcessColumns(this.allColumns).filter((function(t){return!1!==t.visible})),e=this.getSlickOptions(),n=new Slick.Grid(this.slickContainer,this.view,t,e);return n.registerPlugin(new Slick.AutoTooltips({enableForHeaderCells:!0})),this.slickGrid=n,this.rows=this.slickGrid,this.setInitialSortOrder(),n},e.prototype.setInitialSortOrder=function(){var t=this.getDefaultSortBy();this.view&&(this.view.sortBy=Array.prototype.slice.call(t));var e=t.map((function(t){var e={};return t&&a(t.toLowerCase()," desc")?(e.columnId=p(t.substr(0,t.length-5)),e.sortAsc=!1):(e.columnId=t,e.sortAsc=!0),e}));this.slickGrid.setSortColumns(e)},e.prototype.itemAt=function(t){return this.slickGrid.getDataItem(t)},e.prototype.rowCount=function(){return this.slickGrid.getDataLength()},e.prototype.getItems=function(){
return this.view.getItems()},e.prototype.setItems=function(t){this.view.setItems(t,!0)},e.prototype.bindToSlickEvents=function(){var t=this,e=this;this.slickGridOnSort=function(n,i){e.view.populateLock();try{var r,o=[];if(i.multiColumnSort)for(var a=0;a<i.sortCols.length;a++){var l=i.sortCols[a];null==(r=l.sortCol)&&(r={}),o.push(r.field+(l.sortAsc?"":" DESC"))}else null==(r=i.sortCol)&&(r={}),o.push(r.field+(i.sortAsc?"":" DESC"));e.view.seekToPage=1,e.view.sortBy=o}finally{e.view.populateUnlock()}e.view.getLocalSort&&e.view.getLocalSort()?e.view.sort():e.view.populate(),t.persistSettings(null)},this.slickGrid.onSort.subscribe(this.slickGridOnSort),this.slickGridOnClick=function(t,n){e.onClick(t,n.row,n.cell)},this.slickGrid.onClick.subscribe(this.slickGridOnClick),this.slickGrid.onColumnsReordered.subscribe((function(e,n){return t.persistSettings(null)})),this.slickGrid.onColumnsResized.subscribe((function(e,n){return t.persistSettings(null)}))},
e.prototype.getAddButtonCaption=function(){var t;return null!==(t=b("Controls.DataGrid.NewButton"))&&void 0!==t?t:"New"},e.prototype.getButtons=function(){return[]},e.prototype.editItem=function(t){throw new Error("Not Implemented!")},e.prototype.editItemOfType=function(t,e){if(t!==this.getItemType())throw new Error("Not Implemented!");this.editItem(e)},e.prototype.onClick=function(t,e,n){if(!t.isDefaultPrevented()){var i=$(t.target);i.hasClass("s-EditLink")||(i=i.closest("a")),i.hasClass("s-EditLink")&&(t.preventDefault(),this.editItemOfType(oo.getItemType(i),oo.getItemId(i)))}},e.prototype.viewDataChanged=function(t,e){this.markupReady(),this.layout()},e.prototype.bindToViewEvents=function(){var t=this;this.view.onDataChanged.subscribe((function(e,n){return t.viewDataChanged(e,n)})),this.view.onSubmit=function(e){return t.onViewSubmit()},this.view.setFilter((function(e,n){return t.onViewFilter(e)})),this.view.onProcessData=function(e,n){return t.onViewProcessData(e)}},
e.prototype.onViewProcessData=function(t){return t},e.prototype.onViewFilter=function(t){return!0},e.prototype.getIncludeColumns=function(t){for(var e=0,n=this.slickGrid.getColumns();e<n.length;e++){var i=n[e];if(i.field&&(t[i.field]=!0),i.referencedFields)for(var r=0,o=i.referencedFields;r<o.length;r++){t[o[r]]=!0}}},e.prototype.setCriteriaParameter=function(){if(delete this.view.params.Criteria,this.filterBar){var t=this.filterBar.get_store().get_activeCriteria();di.isEmpty(t)||(this.view.params.Criteria=t)}},e.prototype.setEquality=function(t,e){ae(this.view.params,t,e)},e.prototype.setIncludeColumnsParameter=function(){var t={};this.getIncludeColumns(t);for(var e=[],n=0,i=Object.keys(t);n<i.length;n++){var r=i[n];e.push(r)}this.view.params.IncludeColumns=e},e.prototype.onViewSubmit=function(){return!(this.isDisabled||!this.getGridCanLoad())&&(this.setCriteriaParameter(),this.setIncludeColumnsParameter(),this.invokeSubmitHandlers(),!0)},e.prototype.markupReady=function(){},
e.prototype.createSlickContainer=function(){return $('<div class="grid-container"></div>').appendTo(this.element)},e.prototype.createView=function(){var t=this.getViewOptions();return new po(t)},e.prototype.getDefaultSortBy=function(){if(this.slickGrid){var t=this.slickGrid.getColumns().filter((function(t){return t.sortOrder&&0!==t.sortOrder}));if(t.length>0){t.sort((function(t,e){return t.sortOrder<e.sortOrder?-1:t.sortOrder>e.sortOrder?1:0}));for(var e=[],n=0;n<t.length;n++){var i=t[n];e.push(i.field+(i.sortOrder<0?" DESC":""))}return e}}return[]},e.prototype.usePager=function(){return!1},e.prototype.enableFiltering=function(){var t=this.attrs(Pn);return t.length>0&&t[0].value},e.prototype.populateWhenVisible=function(){return!1},e.prototype.createFilterBar=function(){var t=$("<div/>").appendTo(this.element);this.filterBar=new Gr(t),this.initializeFilterBar()},e.prototype.getPagerOptions=function(){return{view:this.view,rowsPerPage:20,rowsPerPageOptions:[20,100,500,2500]}},
e.prototype.createPager=function(){var t=$("<div></div>").appendTo(this.element);new zr(t,this.getPagerOptions())},e.prototype.getViewOptions=function(){var t=this,e={};return e.idField=this.getIdProperty(),e.sortBy=this.getDefaultSortBy(),this.usePager()?this.element.hasClass("responsive-height")?e.rowsPerPage=$(window.window).width()<768?20:100:e.rowsPerPage=100:e.rowsPerPage=0,e.getItemMetadata=function(e,n){return t.getItemMetadata(e,n)},e},e.prototype.createToolbar=function(t){var e=$('<div class="grid-toolbar"></div>').appendTo(this.element);this.toolbar=new Ii(e,{buttons:t,hotkeyContext:this.element[0]})},e.prototype.getTitle=function(){return this.titleDiv?this.titleDiv.children(".title-text").text():null},e.prototype.setTitle=function(t){t!==this.getTitle()&&(null==t?this.titleDiv&&(this.titleDiv.remove(),this.titleDiv=null):(this.titleDiv||(this.titleDiv=$('<div class="grid-title"><div class="title-text"></div></div>').prependTo(this.element)),
this.titleDiv.children(".title-text").text(t)),this.layout())},e.prototype.getItemType=function(){return"Item"},e.prototype.itemLink=function(t,e,n,i,r){return void 0===r&&(r=!0),null==t&&(t=this.getItemType()),null==e&&(e=this.getIdProperty()),oo.itemLink(t,e,n,i,r)},e.prototype.getColumnsKey=function(){var t=this.attrs(vn);return t&&t.length>0?t[0].value:null},e.prototype.getPropertyItems=function(){this.attrs(vn);var t=this.getColumnsKey();return l(t)?[]:Le(t)},e.prototype.getColumns=function(){var t=this.getPropertyItems();return this.propertyItemsToSlickColumns(t)},e.prototype.propertyItemsToSlickColumns=function(t){for(var e=ro.toSlickColumns(t),n=0;n<t.length;n++){var i=t[n],r=e[n];if(!0===i.editLink){var o={$:r.format},a={$:null!=i.editLinkCssClass?i.editLinkCssClass:null};r.format=this.itemLink(null!=i.editLinkItemType?i.editLinkItemType:null,null!=i.editLinkIdField?i.editLinkIdField:null,function(t){return null!=this.oldFormat.$?this.oldFormat.$(t):$t(t.value)}.bind({
oldFormat:o}),function(t){var e;return null!==(e=this.css.$)&&void 0!==e?e:""}.bind({css:a}),!1),l(i.editLinkIdField)||(r.referencedFields=r.referencedFields||[],r.referencedFields.push(i.editLinkIdField))}}return e},e.prototype.getSlickOptions=function(){var t={multiSelect:!1,multiColumnSort:!0,enableCellNavigation:!1};return t.headerRowHeight=i.defaultHeaderHeight,t.rowHeight=i.defaultRowHeight,t},e.prototype.populateLock=function(){this.view.populateLock()},e.prototype.populateUnlock=function(){this.view.populateUnlock()},e.prototype.getGridCanLoad=function(){return!0},e.prototype.refresh=function(){if(this.populateWhenVisible())return this.slickContainer.is(":visible")?(this.slickContainer.data("needsRefresh",!1),void this.internalRefresh()):void this.slickContainer.data("needsRefresh",!0);this.internalRefresh()},e.prototype.refreshIfNeeded=function(){this.slickContainer.data("needsRefresh")&&(this.slickContainer.data("needsRefresh",!1),this.internalRefresh())},
e.prototype.internalRefresh=function(){this.view.populate()},e.prototype.setIsDisabled=function(t){this.isDisabled!==t&&(this.isDisabled=t,this.isDisabled&&this.view.setItems([],!0),this.updateDisabledState())},Object.defineProperty(e.prototype,"readOnly",{get:function(){return this.get_readOnly()},set:function(t){this.set_readOnly(t)},enumerable:!1,configurable:!0}),e.prototype.get_readOnly=function(){return!!this._readonly},e.prototype.set_readOnly=function(t){!!this._readonly!=!!t&&(this._readonly=!!t,this.updateInterface())},e.prototype.updateInterface=function(){this.toolbar&&this.toolbar.updateInterface()},e.prototype.getLocalTextDbPrefix=function(){var t;return null==this.localTextDbPrefix&&(this.localTextDbPrefix=null!==(t=this.getLocalTextPrefix())&&void 0!==t?t:"",this.localTextDbPrefix.length>0&&!a(this.localTextDbPrefix,".")&&(this.localTextDbPrefix="Db."+this.localTextDbPrefix+".")),this.localTextDbPrefix},e.prototype.getLocalTextPrefix=function(){var t=this.attrs(Rn)
;return t.length>=1?t[0].value:""},e.prototype.getIdProperty=function(){if(null==this.idProperty){var t=this.attrs(Nn);1===t.length?this.idProperty=t[0].value:this.idProperty="ID"}return this.idProperty},e.prototype.getIsDeletedProperty=function(){return null},e.prototype.getIsActiveProperty=function(){if(null==this.isActiveProperty){var t=this.attrs(Vn);1===t.length?this.isActiveProperty=t[0].value:this.isActiveProperty=""}return this.isActiveProperty},e.prototype.updateDisabledState=function(){this.slickContainer.toggleClass("ui-state-disabled",!!this.isDisabled)},e.prototype.resizeCanvas=function(){this.slickGrid.resizeCanvas()},e.prototype.subDialogDataChange=function(){this.refresh()},e.prototype.addFilterSeparator=function(){this.ensureQuickFilterBar().addSeparator()},e.prototype.determineText=function(t){var e=this.getLocalTextDbPrefix();if(!l(e)){var n=b(t(e));if(null!=n)return n}return null},e.prototype.addQuickFilter=function(t){return this.ensureQuickFilterBar().add(t)},
e.prototype.addDateRangeFilter=function(t,e){return this.ensureQuickFilterBar().addDateRange(t,e)},e.prototype.dateRangeQuickFilter=function(t,e){return pr.dateRange(t,e)},e.prototype.addDateTimeRangeFilter=function(t,e){return this.ensureQuickFilterBar().addDateTimeRange(t,e)},e.prototype.dateTimeRangeQuickFilter=function(t,e){return pr.dateTimeRange(t,e)},e.prototype.addBooleanFilter=function(t,e,n,i){return this.ensureQuickFilterBar().addBoolean(t,e,n,i)},e.prototype.booleanQuickFilter=function(t,e,n,i){return pr.boolean(t,e,n,i)},e.prototype.invokeSubmitHandlers=function(){null!=this.quickFiltersBar&&this.quickFiltersBar.onSubmit(this.view.params)},e.prototype.quickFilterChange=function(t){this.persistSettings(null),this.view&&(this.view.seekToPage=1),this.refresh()},e.prototype.getPersistanceStorage=function(){return i.defaultPersistanceStorage},e.prototype.getPersistanceKey=function(){var t="GridSettings:",e=window.location.pathname
;return l(e)||(t+=e.substr(1).split(String.fromCharCode(47)).slice(0,2).join("/")+":"),t+=V(R(this))},e.prototype.gridPersistanceFlags=function(){return{}},e.prototype.canShowColumn=function(t){if(null==t)return!1;var e=t.sourceItem;return null==e||!0!==e.filterOnly&&(null==e.readPermission||Fe.hasPermission(e.readPermission))},e.prototype.getPersistedSettings=function(){var t=this.getPersistanceStorage();if(null==t)return null;var e=g(t.getItem(this.getPersistanceKey()));return null!=e&&d(e,"{")&&a(e,"}")?JSON.parse(e):null},e.prototype.restoreSettings=function(t,e){var n=this;if(this.slickGrid&&(null!=t||null!=(t=this.getPersistedSettings()))){var i=this.slickGrid.getColumns(),r=null,o=function(t){r={};for(var e=0;e<t.length;e++){var n=t[e];r[n.id]=n}};this.view.beginUpdate(),this.restoringSettings++;try{if(e=e||this.gridPersistanceFlags(),null!=t.columns){if(!1!==e.columnVisibility){o(this.allColumns);for(var a=[],s=0;s<t.columns.length;s++){var u=t.columns[s]
;if(null!=u.id&&!0===u.visible){var c=r[u.id];this.canShowColumn(c)&&(c.visible=!0,a.push(c),delete r[u.id])}}for(var d=0;d<this.allColumns.length;d++){var p=this.allColumns[d];null!=r[p.id]&&(p.visible=!1,a.push(p))}this.allColumns=a,i=this.allColumns.filter((function(t){return!0===t.visible}))}if(!1!==e.columnWidths){o(i);for(var h=0;h<t.columns.length;h++){var f=t.columns[h];if(null!=f.id&&null!=f.width&&0!==f.width){var g=r[f.id];null!=g&&(g.width=f.width)}}}if(!1!==e.sortColumns){o(i);var m=[],y=t.columns.filter((function(t){var e;return null!=t.id&&0!==(null!==(e=t.sort)&&void 0!==e?e:0)}));y.sort((function(t,e){return Math.abs(t.sort)-Math.abs(e.sort)}));for(var v=0;v<y.length;v++){var b=y[v];null!=r[b.id]&&m.push({columnId:b.id,sortAsc:b.sort>0})}this.view.sortBy=m.map((function(t){return t.columnId+(!1===t.sortAsc?" DESC":"")})),this.slickGrid.setSortColumns(m)}this.slickGrid.setColumns(i),this.slickGrid.invalidate()}
if(null!=t.filterItems&&!1!==e.filterItems&&null!=this.filterBar&&null!=this.filterBar.get_store()){var C=this.filterBar.get_store().get_items();C.length=0,C.push.apply(C,t.filterItems),this.filterBar.get_store().raiseChanged()}if(null!=t.includeDeleted&&!1!==e.includeDeleted){var w=this.element.find(".s-IncludeDeletedToggle");!!t.includeDeleted!==w.hasClass("pressed")&&w.children("a").click()}if(null!=t.quickFilters&&!1!==e.quickFilters&&null!=this.quickFiltersDiv&&this.quickFiltersDiv.length>0&&this.quickFiltersDiv.find(".quick-filter-item").each((function(e,i){var r=$(i).data("qffield");if(!l(r)){var o=$("#"+n.uniqueName+"_QuickFilter_"+r).tryGetWidget(vi);if(null!=o){var a=t.quickFilters[r],s=$(i).data("qfloadstate");null!=s?s(o,a):_i.setValue(o,a)}}})),!0===e.quickSearch&&(void 0!==t.quickSearchField||void 0!==t.quickSearchText)){var _=this.toolbar.element.find(".s-QuickSearchInput").first();if(_.length>0){var S=_.tryGetWidget(hr)
;S&&S.restoreState(t.quickSearchText,t.quickSearchField)}}}finally{this.restoringSettings--,this.view.endUpdate()}}},e.prototype.persistSettings=function(t){var e=this.getPersistanceStorage();if(e){var n=this.getCurrentSettings(t);e.setItem(this.getPersistanceKey(),JSON.stringify(n))}},e.prototype.getCurrentSettings=function(t){var e=this;t=t||this.gridPersistanceFlags();var i={};if(!1!==t.columnVisibility||!1!==t.columnWidths||!1!==t.sortColumns){i.columns=[];for(var r=this.slickGrid.getSortColumns(),o=0,a=this.slickGrid.getColumns();o<a.length;o++){var s=a[o],u={id:s.id};if(!1!==t.columnVisibility&&(u.visible=!0),!1!==t.columnWidths&&(u.width=s.width),!1!==t.sortColumns){var c=n(r,(function(t){return t.columnId==s.id}));u.sort=c>=0?!1!==r[c].sortAsc?c+1:-c-1:0}i.columns.push(u)}}if(!1!==t.includeDeleted&&(i.includeDeleted=this.element.find(".s-IncludeDeletedToggle").hasClass("pressed")),
!1!==t.filterItems&&null!=this.filterBar&&null!=this.filterBar.get_store()&&(i.filterItems=this.filterBar.get_store().get_items().slice()),!0===t.quickSearch){var d=this.toolbar.element.find(".s-QuickSearchInput").first();if(d.length>0){var p=d.tryGetWidget(hr);null!=p&&(i.quickSearchField=p.get_field(),i.quickSearchText=p.element.val())}}return!1!==t.quickFilters&&null!=this.quickFiltersDiv&&this.quickFiltersDiv.length>0&&(i.quickFilters={},this.quickFiltersDiv.find(".quick-filter-item").each((function(n,r){var o,a=$(r).data("qffield");if(!l(a)){var s=$("#"+e.uniqueName+"_QuickFilter_"+a).tryGetWidget(vi);if(null!=s){var u=$(r).data("qfsavestate"),c=null!=u?u(s):_i.getValue(s);if(i.quickFilters[a]=c,!0===t.quickFilterText&&$(r).hasClass("quick-filter-active")){var d,p=$(r).data("qfdisplaytext"),h=$(r).find(".quick-filter-label").text()
;l(d=null!=p?p(s,h):h+" = "+_i.getDisplayText(s))||(l(i.quickFilterText)?i.quickFilterText=d:(i.quickFilterText+=" "+(null!==(o=b("Controls.FilterPanel.And"))&&void 0!==o?o:"and")+" ",i.quickFilterText+=d))}}}}))),i},e.prototype.getElement=function(){return this.element},e.prototype.getGrid=function(){return this.slickGrid},e.prototype.getView=function(){return this.view},e.prototype.getFilterStore=function(){return null==this.filterBar?null:this.filterBar.get_store()},e=i=S([In.registerClass("Serenity.DataGrid",[li]),In.element("<div/>")],e)}(vi),fo=function(t){function e(){var e=t.call(this)||this;return new hr(e.byId("Search"),{onSearch:function(t,n,i){null!=(n=g(n))&&(n=Select2.util.stripDiacritics(n.toLowerCase())),e.element.find("li").each((function(t,e){$(e).toggle(!n||Select2.util.stripDiacritics($(e).text().toLowerCase()).indexOf(n)>=0)})),i&&i(!0)}}),e.ulVisible=e.byId("VisibleCols"),e.ulHidden=e.byId("HiddenCols"),e.dialogTitle=v("Controls.ColumnPickerDialog.Title"),e}var n
;return _(e,t),n=e,e.createToolButton=function(t){function e(){var e=new n;if(e.allColumns=t.allColumns,t.initialSettings){var i=t.initialSettings;i.columns&&i.columns.length&&(e.defaultColumns=i.columns.map((function(t){return t.id})))}e.visibleColumns=t.getGrid().getColumns().map((function(t){return t.id})),e.done=function(){t.allColumns=e.allColumns;var n=e.allColumns.filter((function(t){return!0===t.visible}));t.getGrid().setColumns(n),t.persistSettings(),t.getView().populate()},Ue&&Ue.dialog&&Ue.dialog(t.element,e.element,(function(){return"columns"})),e.dialogOpen()}return t.element.on("handleroute."+t.uniqueName,(function(t,n){n&&!n.handled&&"columns"==n.route&&e()})),{hint:v("Controls.ColumnPickerDialog.Title"),cssClass:"column-picker-button",onClick:e}},e.prototype.getDialogButtons=function(){var t=this;return[{text:v("Controls.ColumnPickerDialog.RestoreDefaults"),click:function(){var e={};t.ulVisible.children().add(t.ulHidden.children()).each((function(t,n){var i=$(n)
;e[i.data("key")]=i}));for(var n=null,i=0,r=t.defaultColumns;i<r.length;i++){var o=r[i],a=e[o];if(a){null==n?a.prependTo(t.ulVisible):a.insertAfter(n),n=a;var l=a.data("key");delete e[l]}}for(var l in e)e[l].appendTo(t.ulHidden);t.updateListStates()}},{text:v("Dialogs.OkButton"),click:function(){for(var e=[],n=0,i=t.allColumns;n<i.length;n++){(a=i[n]).visible=!1}t.visibleColumns=t.ulVisible.children().toArray().map((function(n){var i=$(n).data("key"),r=t.colById[i];return r.visible=!0,e.push(r),i}));for(var r=0,o=t.allColumns;r<o.length;r++){var a;(a=o[r]).visible||e.push(a)}t.allColumns=e,t.done&&t.done(),t.dialogClose()}},{text:v("Dialogs.CancelButton"),click:function(){t.dialogClose()}}]},e.prototype.getDialogOptions=function(){var e=t.prototype.getDialogOptions.call(this);return e.width=600,e},e.prototype.getTitle=function(t){return"__select__"==t.id?"[x]":t.name||t.toolTip||t.id},e.prototype.allowHide=function(t){
return null==t.sourceItem||null==t.sourceItem.allowHide||t.sourceItem.allowHide},e.prototype.createLI=function(t){var e=this.allowHide(t);return $('\n<li data-key="'+t.id+'" class="'+(e?"":"cant-hide")+'">\n<span class="drag-handle">☰</span>\n'+$t(this.getTitle(t))+"\n"+(e?'<i class="js-hide" title="'+v("Controls.ColumnPickerDialog.HideHint")+'">✖</i>':"")+'\n<i class="js-show fa fa-eye" title="'+v("Controls.ColumnPickerDialog.ShowHint")+'"></i>\n</li>')},e.prototype.updateListStates=function(){this.ulVisible.children().removeClass("bg-info").addClass("bg-success"),this.ulHidden.children().removeClass("bg-success").addClass("bg-info")},e.prototype.setupColumns=function(){var t=this;this.allColumns=this.allColumns||[],this.visibleColumns=this.visibleColumns||[];for(var e={},n=0,i=this.visibleColumns;n<i.length;n++){e[f=i[n]]=!0}this.colById={};for(var r=0,o=this.allColumns;r<o.length;r++){var a=o[r];this.colById[a.id]=a}
null==this.defaultColumns&&(this.defaultColumns=this.visibleColumns.slice(0));for(var l=[],s=0,u=this.allColumns;s<u.length;s++){var c=u[s];e[c.id]||c.sourceItem&&(!0===c.sourceItem.filterOnly||null!=c.sourceItem.readPermission&&!Fe.hasPermission(c.sourceItem.readPermission))||l.push(c)}for(var d=l.sort((function(e,n){return de.stringCompare(t.getTitle(e),t.getTitle(n))})),p=0,h=this.visibleColumns;p<h.length;p++){var f=h[p],g=this.colById[f];g&&this.createLI(g).appendTo(this.ulVisible)}for(var m=0,y=d;m<y.length;m++){var v=y[m];this.createLI(v).appendTo(this.ulHidden)}this.updateListStates(),"undefined"!=typeof Sortable&&Sortable.create&&(Sortable.create(this.ulVisible[0],{group:this.uniqueName+"_group",filter:".js-hide",onFilter:function(e){$(e.item).appendTo(t.ulHidden),t.updateListStates()},onMove:function(e){return!$(e.dragged).hasClass("cant-hide")||e.from!=t.ulVisible[0]||e.to===e.from},onEnd:function(e){return t.updateListStates()}}),Sortable.create(this.ulHidden[0],{
group:this.uniqueName+"_group",sort:!1,filter:".js-show",onFilter:function(e){$(e.item).appendTo(t.ulVisible),t.updateListStates()},onEnd:function(e){return t.updateListStates()}}))},e.prototype.onDialogOpen=function(){t.prototype.onDialogOpen.call(this),this.element.find("input").removeAttr("disabled"),this.element.closest(".ui-dialog").children(".ui-dialog-buttonpane").find("button").eq(0).addClass("restore-defaults").next().focus(),this.setupColumns(),pn(this.element)},e.prototype.getTemplate=function(){return'\n<div class="search"><input id="~_Search" type="text" disabled /></div>\n<div class="columns-container">\n<div class="column-list visible-list bg-success">\n<h5><i class="fa fa-eye"></i> '+v("Controls.ColumnPickerDialog.VisibleColumns")+'</h5>\n<ul id="~_VisibleCols"></ul>\n</div>\n<div class="column-list hidden-list bg-info">\n<h5><i class="fa fa-list"></i> '+v("Controls.ColumnPickerDialog.HiddenColumns")+'</h5>\n<ul id="~_HiddenCols"></ul>\n</div>\n</div>'},
e=n=S([In.registerClass(),In.resizable(),In.responsive()],e)}(yr),go=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.element.addClass("route-handler").on("handleroute."+i.uniqueName,(function(t,e){if(!e.handled){if("new"===e.route)return e.handled=!0,void i.addButtonClick();var n=e.route.split("/");return 2===n.length&&"edit"===n[0]?(e.handled=!0,void i.editItem(n[1])):2===n.length&&"new"===n[1]?(e.handled=!0,void i.editItemOfType(z(n[0],String),null)):void(3===n.length&&"edit"===n[1]&&(e.handled=!0,i.editItemOfType(z(n[0],String),n[2])))}})),i}return _(e,t),e.prototype.usePager=function(){return!0},e.prototype.createToolbarExtensions=function(){this.createIncludeDeletedButton(),this.createQuickSearchInput()},e.prototype.getInitialTitle=function(){return this.getDisplayName()},e.prototype.getLocalTextPrefix=function(){var e=t.prototype.getLocalTextPrefix.call(this);return l(e)?this.getEntityType():e},e.prototype.getEntityType=function(){
if(null!=this.entityType)return this.entityType;var t=this.attrs(Fn);if(1===t.length)return this.entityType=t[0].value;var e=V(R(this)),n=e.indexOf(".");return n>=0&&(e=e.substring(n+1)),a(e,"Grid")?e=e.substr(0,e.length-4):a(e,"SubGrid")&&(e=e.substr(0,e.length-7)),this.entityType=e,this.entityType},e.prototype.getDisplayName=function(){if(null!=this.displayName)return this.displayName;var t=this.attrs(mn);return t.length>=1?(this.displayName=t[0].displayName,this.displayName=C.getDefault(this.displayName,this.displayName)):(this.displayName=b(this.getLocalTextDbPrefix()+"EntityPlural"),null==this.displayName&&(this.displayName=this.getEntityType())),this.displayName},e.prototype.getItemName=function(){if(null!=this.itemName)return this.itemName;var t=this.attrs(Mn);return t.length>=1?(this.itemName=t[0].value,this.itemName=C.getDefault(this.itemName,this.itemName)):(this.itemName=b(this.getLocalTextDbPrefix()+"EntitySingular"),
null==this.itemName&&(this.itemName=this.getEntityType())),this.itemName},e.prototype.getAddButtonCaption=function(){return me(v("Controls.EntityGrid.NewButton"),this.getItemName())},e.prototype.getButtons=function(){var t=this,e=[];return e.push({title:this.getAddButtonCaption(),cssClass:"add-button",hotkey:"alt+n",onClick:function(){t.addButtonClick()},disabled:function(){return!t.hasInsertPermission()||t.readOnly}}),e.push(this.newRefreshButton(!0)),e.push(fo.createToolButton(this)),e},e.prototype.newRefreshButton=function(t){var e=this;return{title:t?null:v("Controls.EntityGrid.RefreshButton"),hint:t?v("Controls.EntityGrid.RefreshButton"):null,cssClass:"refresh-button",onClick:function(){e.refresh()}}},e.prototype.addButtonClick=function(){this.editItem(new Object)},e.prototype.editItem=function(t){var e=this;this.createEntityDialog(this.getItemType(),(function(n){var i=G(n,oi);if(null==i)throw new Error(me("{0} doesn't implement IEditDialog!",V(R(n))));i.load(t,(function(){
i.dialogOpen(e.openDialogsAsPanel)}))}))},e.prototype.editItemOfType=function(t,e){var n=this;t!==this.getItemType()?this.createEntityDialog(t,(function(t){var i=G(t,oi);if(null==i)throw new Error(me("{0} doesn't implement IEditDialog!",V(R(t))));i.load(e,(function(){return i.dialogOpen(n.openDialogsAsPanel)}))})):this.editItem(e)},e.prototype.getService=function(){if(null!=this.service)return this.service;var t=this.attrs(Xn);return t.length>=1?this.service=t[0].value:this.service=m(this.getEntityType(),".","/"),this.service},e.prototype.getViewOptions=function(){var e=t.prototype.getViewOptions.call(this);return e.url=se("~/Services/"+this.getService()+"/List"),e},e.prototype.getItemType=function(){return this.getEntityType()},e.prototype.routeDialog=function(t,e){var n=this;Ue&&Ue.dialog&&Ue.dialog(this.element,e.element,(function(){var i="";return t!==n.getItemType()&&(i=t+"/"),null!=e&&null!=e.entityId?i+="edit/"+e.entityId.toString():i+="new",i}))},
e.prototype.getInsertPermission=function(){return null},e.prototype.hasInsertPermission=function(){return null==this.getInsertPermission()||Fe.hasPermission(this.getInsertPermission())},e.prototype.transferDialogReadOnly=function(t){this.readOnly&&_i.setReadOnly(t,!0)},e.prototype.initDialog=function(t){var e=this;bi.bindToDataChange(t,this,(function(t,n){e.subDialogDataChange()}),!0),this.transferDialogReadOnly(t),this.routeDialog(this.getItemType(),t)},e.prototype.initEntityDialog=function(t,e){var n=this;t!==this.getItemType()?(bi.bindToDataChange(e,this,(function(t,e){n.subDialogDataChange()}),!0),this.transferDialogReadOnly(e),this.routeDialog(t,e)):this.initDialog(e)},e.prototype.createEntityDialog=function(t,e){var n=this,i=this.getDialogTypeFor(t);return vi.create({type:i,options:this.getDialogOptionsFor(t),init:function(i){n.initEntityDialog(t,i),e&&e(i)}})},e.prototype.getDialogOptions=function(){return{}},e.prototype.getDialogOptionsFor=function(t){
return t===this.getItemType()?this.getDialogOptions():{}},e.prototype.getDialogTypeFor=function(t){return t===this.getItemType()?this.getDialogType():ei.get(t)},e.prototype.getDialogType=function(){if(null!=this.dialogType)return this.dialogType;var t=this.attrs(wn);return t.length>=1?this.dialogType=t[0].value:this.dialogType=ei.get(this.getEntityType()),this.dialogType},e=S([In.registerClass("Serenity.EntityGrid")],e)}(ho),mo=function(){function t(e){this.options=e;var n=this.dataGrid=e.grid,i=n.getIdProperty(),r=this.getId=function(t){return t[i]};n.element.find(".grid-container").on("click",(function(t){if($(t.target).hasClass("s-TreeToggle")){var e=n.slickGrid.getCellFromEvent(t);e.cell>=0&&e.row>=0&&lo.toggleClick(t,e.row,e.row,n.view,r)}}));var a=n.onViewFilter;n.onViewFilter=function(t){return!!a.apply(this,[t])&&lo.filterById(t,n.view,e.getParentId)};var l=n.onViewProcessData;if(n.onViewProcessData=function(n){
return(n=l.apply(this,[n])).Entities=t.applyTreeOrdering(n.Entities,r,e.getParentId),lo.setIndents(n.Entities,r,e.getParentId,e.initialCollapse&&e.initialCollapse()||!1),n},e.toggleField){var s=o(n.allColumns||n.slickGrid.getColumns()||[],(function(t){return t.field==e.toggleField}));s&&(s.format=oo.treeToggle((function(){return n.view}),r,s.format||function(t){return $t(t.value)}),s.formatter=ao.convertToFormatter(s.format))}}return t.prototype.toggleAll=function(){lo.setCollapsed(this.dataGrid.view.getItems(),!this.dataGrid.view.getItems().every((function(t){return 1==t._collapsed}))),this.dataGrid.view.setItems(this.dataGrid.view.getItems(),!0)},t.prototype.collapseAll=function(){lo.setCollapsed(this.dataGrid.view.getItems(),!0),this.dataGrid.view.setItems(this.dataGrid.view.getItems(),!0)},t.prototype.expandAll=function(){lo.setCollapsed(this.dataGrid.view.getItems(),!1),this.dataGrid.view.setItems(this.dataGrid.view.getItems(),!0)},t.applyTreeOrdering=function(t,e,n){
var i=[],o=r(t,e),a=r(t,n),l={};function s(t){if(!l[t]){l[t]=!0;for(var n=0,r=a[t]||[];n<r.length;n++){var o=r[n];i.push(o),s(e(o))}}}for(var u=0,c=t;u<c.length;u++){var d=c[u],p=n(d);null!=p&&(o[p]||[]).length||(i.push(d),s(e(d)))}return i},t}(),yo=function(t){function e(e,n){var i=t.call(this,e,n)||this;return e.addClass("s-CheckTreeEditor"),i.updateItems(),i}return _(e,t),e.prototype.getIdProperty=function(){return"id"},e.prototype.getTreeItems=function(){return[]},e.prototype.updateItems=function(){for(var t=this.getTreeItems(),e={},n=0;n<t.length;n++){var i=t[n];if(i.children=[],l(i.id)||(e[i.id]=i),!l(i.parentId)){var r=e[i.parentId];null!=r&&r.children.push(i)}}this.view.addData({Entities:t,Skip:0,Take:0,TotalCount:t.length}),this.updateSelectAll(),this.updateFlags()},e.prototype.getEditValue=function(t,e){this.getDelimited()?e[t.name]=this.get_value().join(","):e[t.name]=this.get_value()},e.prototype.setEditValue=function(t,e){var n=t[e.name];this.set_value(n)},
e.prototype.getButtons=function(){var t=this;if(l(this.getSelectAllText()))return null;var e=this,n=[];return n.push(no.define((function(){return e}),(function(t){return t.id}),(function(t){return t.isSelected}),(function(e,n){e.isSelected!==n&&(e.isSelected=n,t.itemSelectedChanged(e))}),null,(function(){t.updateFlags()}))),n},e.prototype.itemSelectedChanged=function(t){},e.prototype.getSelectAllText=function(){var t;return null!==(t=b("Controls.CheckTreeEditor.SelectAll"))&&void 0!==t?t:"Select All"},e.prototype.isThreeStateHierarchy=function(){return!1},e.prototype.createSlickGrid=function(){this.element.addClass("slick-no-cell-border").addClass("slick-no-odd-even");var e=t.prototype.createSlickGrid.call(this);return this.element.addClass("slick-hide-header"),e.resizeCanvas(),e},e.prototype.onViewFilter=function(e){if(!t.prototype.onViewFilter.call(this,e))return!1;var n=this.view.getItems(),i=this;return lo.filterCustom(e,(function(t){if(null==t.parentId)return null
;if(null==i.byId){i.byId={};for(var e=0;e<n.length;e++){var r=n[e];null!=r.id&&(i.byId[r.id]=r)}}return i.byId[t.parentId]}))},e.prototype.getInitialCollapse=function(){return!1},e.prototype.onViewProcessData=function(e){return e=t.prototype.onViewProcessData.call(this,e),this.byId=null,lo.setIndents(e.Entities,(function(t){return t.id}),(function(t){return t.parentId}),this.getInitialCollapse()),e},e.prototype.onClick=function(e,n,i){if(t.prototype.onClick.call(this,e,n,i),e.isDefaultPrevented()||lo.toggleClick(e,n,i,this.view,(function(t){return t.id})),!e.isDefaultPrevented()){var r=$(e.target);if(r.hasClass("check-box")){if(e.preventDefault(),this._readOnly)return;var o=r.hasClass("checked")||r.hasClass("partial"),a=this.itemAt(n),l=a.isSelected!==!o;this.view.beginUpdate();try{a.isSelected!==!o&&(a.isSelected=!o,this.view.updateItem(a.id,a),this.itemSelectedChanged(a)),l=this.setAllSubTreeSelected(a,a.isSelected)||l,this.updateSelectAll(),this.updateFlags()}finally{
this.view.endUpdate()}l&&this.element.triggerHandler("change")}}},e.prototype.updateSelectAll=function(){no.update(this,(function(t){return t.isSelected}))},e.prototype.updateFlags=function(){var t=this.view,e=t.getItems();if(this.isThreeStateHierarchy()){t.beginUpdate();try{for(var n=0;n<e.length;n++){var i=e[n];if(null!=i.children&&0!==i.children.length){var r=this.allDescendantsSelected(i),o=r||this.anyDescendantsSelected(i);if(r!==i.isAllDescendantsSelected||o!==i.isSelected){var a=i.isSelected!==o;i.isAllDescendantsSelected=r,i.isSelected=o,t.updateItem(i.id,i),a&&this.itemSelectedChanged(i)}}else{var l=this.getDescendantsSelected(i);l!==i.isAllDescendantsSelected&&(i.isAllDescendantsSelected=l,t.updateItem(i.id,i))}}}finally{t.endUpdate()}}},e.prototype.getDescendantsSelected=function(t){return!0},e.prototype.setAllSubTreeSelected=function(t,e){for(var n=!1,i=0;i<t.children.length;i++){var r=t.children[i];r.isSelected!==e&&(n=!0,r.isSelected=e,this.view.updateItem(r.id,r),
this.itemSelectedChanged(r)),r.children.length>0&&(n=this.setAllSubTreeSelected(r,e)||n)}return n},e.prototype.allItemsSelected=function(){for(var t=0;t<this.rowCount();t++){if(!this.itemAt(t).isSelected)return!1}return this.rowCount()>0},e.prototype.allDescendantsSelected=function(t){if(t.children.length>0)for(var e=0;e<t.children.length;e++){var n=t.children[e];if(!n.isSelected)return!1;if(!this.allDescendantsSelected(n))return!1}return!0},e.prototype.getDelimited=function(){return!!this.options.delimited},e.prototype.anyDescendantsSelected=function(t){if(t.children.length>0)for(var e=0;e<t.children.length;e++){var n=t.children[e];if(n.isSelected)return!0;if(this.anyDescendantsSelected(n))return!0}return!1},e.prototype.getColumns=function(){var t=this,e=this,n=[];return n.push({field:"text",name:"Kayıt",width:80,format:oo.treeToggle((function(){return e.view}),(function(t){return t.id}),(function(e){var n="check-box",i=e.item;if(i.hideCheckBox)return t.getItemText(e)
;var r=t.isThreeStateHierarchy();return i.isSelected&&(r&&!i.isAllDescendantsSelected?n+=" partial":n+=" checked"),t._readOnly&&(n+=" readonly"),'<span class="'+n+'"></span>'+t.getItemText(e)}))}),n},e.prototype.getItemText=function(t){return $t(t.value)},e.prototype.getSlickOptions=function(){var e=t.prototype.getSlickOptions.call(this);return e.forceFitColumns=!0,e},e.prototype.sortItems=function(){if(this.moveSelectedUp()){for(var t={},e=this.view.getItems(),n=0,i=0;i<e.length;i++){var r=e[i];t[r.id]=n++}e.sort((function(e,n){if(e.isSelected&&!n.isSelected)return-1;if(n.isSelected&&!e.isSelected)return 1;var i=de.stringCompare(e.text,n.text);return 0!==i?i:t[e.id]<t[n.id]?-1:t[e.id]>t[n.id]?1:0})),this.view.setItems(e,!0)}},e.prototype.moveSelectedUp=function(){return!1},e.prototype.get_readOnly=function(){return this._readOnly},e.prototype.set_readOnly=function(t){!!this._readOnly!=!!t&&(this._readOnly=!!t,this.view.refresh())},e.prototype.get_value=function(){
for(var t=[],e=this.view.getItems(),n=0;n<e.length;n++)e[n].isSelected&&t.push(e[n].id);return t},Object.defineProperty(e.prototype,"value",{get:function(){return this.get_value()},set:function(t){this.set_value(t)},enumerable:!1,configurable:!0}),e.prototype.set_value=function(t){var e={};if(null!=t){"string"==typeof t&&(t=t.split(",").map((function(t){return g(t)})).filter((function(t){return null!=t})));for(var n=0;n<t.length;n++)e[t[n]]=!0}this.view.beginUpdate();try{for(var i=this.view.getItems(),r=0;r<i.length;r++){var o=i[r],a=e[o.id];a!==o.isSelected&&(o.isSelected=a,this.view.updateItem(o.id,o))}this.updateSelectAll(),this.updateFlags(),this.sortItems()}finally{this.view.endUpdate()}},e=S([In.registerEditor("Serenity.CheckTreeEditor",[ai,si,li]),In.element("<div/>")],e)}(ho),vo=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.enableUpdateItems=!0,i.setCascadeFrom(i.options.cascadeFrom),i.updateItems(),
Te.bindToChange("Lookup."+i.getLookupKey(),i.uniqueName,(function(){return i.updateItems()})),i}return _(e,t),e.prototype.updateItems=function(){this.enableUpdateItems&&t.prototype.updateItems.call(this)},e.prototype.getLookupKey=function(){return this.options.lookupKey},e.prototype.getButtons=function(){var e;return null!==(e=t.prototype.getButtons.call(this))&&void 0!==e?e:this.options.hideSearch?null:[]},e.prototype.createToolbarExtensions=function(){var e=this;t.prototype.createToolbarExtensions.call(this),io.addQuickSearchInputCustom(this.toolbar.element,(function(t,n){e.searchText=Select2.util.stripDiacritics(n||"").toUpperCase(),e.view.setItems(e.view.getItems(),!0)}))},e.prototype.getSelectAllText=function(){return this.options.showSelectAll?t.prototype.getSelectAllText.call(this):null},e.prototype.cascadeItems=function(t){var e=this.get_cascadeValue();if(null==e||""===e)return l(this.get_cascadeField())?t:[];var n=e.toString(),i=this.get_cascadeField()
;return t.filter((function(t){var e,r=null!==(e=t[i])&&void 0!==e?e:ti.getPropertyValue(t,i);return!(null==r||r.toString()!==n)}))},e.prototype.filterItems=function(t){var e=this.get_filterValue();if(null==e||""===e)return t;var n=e.toString(),i=this.get_filterField();return t.filter((function(t){var e,r=null!==(e=t[i])&&void 0!==e?e:ti.getPropertyValue(t,i);return!(null==r||r.toString()!==n)}))},e.prototype.getLookupItems=function(t){return this.filterItems(this.cascadeItems(t.items))},e.prototype.getTreeItems=function(){var t=Ve(this.options.lookupKey);return this.getLookupItems(t).map((function(e){var n,i;return{id:(null!==(n=e[t.idField])&&void 0!==n?n:"").toString(),text:(null!==(i=e[t.textField])&&void 0!==i?i:"").toString(),source:e}}))},e.prototype.onViewFilter=function(e){return t.prototype.onViewFilter.call(this,e)&&(l(this.searchText)||Select2.util.stripDiacritics(e.text||"").toUpperCase().indexOf(this.searchText)>=0)},e.prototype.moveSelectedUp=function(){
return this.options.checkedOnTop},e.prototype.get_cascadeFrom=function(){return this.options.cascadeFrom},Object.defineProperty(e.prototype,"cascadeFrom",{get:function(){return this.get_cascadeFrom()},set:function(t){this.set_cascadeFrom(t)},enumerable:!1,configurable:!0}),e.prototype.getCascadeFromValue=function(t){return _i.getValue(t)},e.prototype.setCascadeFrom=function(t){var e=this;if(l(t))return null!=this.cascadeLink&&(this.cascadeLink.set_parentID(null),this.cascadeLink=null),void(this.options.cascadeFrom=null);this.cascadeLink=new Fi(vi,this,(function(t){e.set_cascadeValue(e.getCascadeFromValue(t))})),this.cascadeLink.set_parentID(t),this.options.cascadeFrom=t},e.prototype.set_cascadeFrom=function(t){t!==this.options.cascadeFrom&&(this.setCascadeFrom(t),this.updateItems())},e.prototype.get_cascadeField=function(){var t;return null!==(t=this.options.cascadeField)&&void 0!==t?t:this.options.cascadeFrom},Object.defineProperty(e.prototype,"cascadeField",{get:function(){
return this.get_cascadeField()},set:function(t){this.set_cascadeField(t)},enumerable:!1,configurable:!0}),e.prototype.set_cascadeField=function(t){this.options.cascadeField=t},e.prototype.get_cascadeValue=function(){return this.options.cascadeValue},Object.defineProperty(e.prototype,"cascadeValue",{get:function(){return this.get_cascadeValue()},set:function(t){this.set_cascadeValue(t)},enumerable:!1,configurable:!0}),e.prototype.set_cascadeValue=function(t){this.options.cascadeValue!==t&&(this.options.cascadeValue=t,this.value=[],this.updateItems())},e.prototype.get_filterField=function(){return this.options.filterField},Object.defineProperty(e.prototype,"filterField",{get:function(){return this.get_filterField()},set:function(t){this.set_filterField(t)},enumerable:!1,configurable:!0}),e.prototype.set_filterField=function(t){this.options.filterField=t},e.prototype.get_filterValue=function(){return this.options.filterValue},Object.defineProperty(e.prototype,"filterValue",{
get:function(){return this.get_filterValue()},set:function(t){this.set_filterValue(t)},enumerable:!1,configurable:!0}),e.prototype.set_filterValue=function(t){this.options.filterValue!==t&&(this.options.filterValue=t,this.value=null,this.updateItems())},e=S([In.registerEditor("Serenity.CheckLookupEditor")],e)}(yo);!function(t){var e=function(t){function e(e){var n=t.call(this,e)||this;return e.reportKey&&n.loadReport(e.reportKey),n}return _(e,t),e.prototype.createPropertyGrid=function(){this.propertyGrid&&(this.byId("PropertyGrid").html("").attr("class",""),this.propertyGrid=null),this.propertyGrid=new Ei(this.byId("PropertyGrid"),{idPrefix:this.idPrefix,useCategories:!0,items:this.propertyItems}).init(null)},e.prototype.loadReport=function(t){var e=this;oe({service:"Report/Retrieve",request:{ReportKey:t},onSuccess:function(n){var i;e.reportKey=null!==(i=n.ReportKey)&&void 0!==i?i:t,e.propertyItems=n.Properties||[],e.dialogTitle=n.Title,e.createPropertyGrid();var r=n.InitialSettings
;null==r&&(r=new Object),e.propertyGrid.load(r),e.toolbar.findButton("print-preview-button").toggle(!n.IsDataOnlyReport),e.toolbar.findButton("export-pdf-button").toggle(!n.IsDataOnlyReport),e.toolbar.findButton("export-docx-button").toggle(!n.IsDataOnlyReport),e.dialogOpen(null)}})},e.prototype.executeReport=function(t,e){if(this.validateForm()){var n=new Object;this.propertyGrid.save(n),le({service:"Report/Execute",request:{ReportKey:this.reportKey,DesignId:"Default",ExportType:e,Parameters:n},target:t})}},e.prototype.getToolbarButtons=function(){var t=this,e=[];return e.push({title:"Önizleme",cssClass:"print-preview-button",onClick:function(){t.executeReport("_blank",null)}}),e.push({title:"PDF",cssClass:"export-pdf-button",onClick:function(){t.executeReport("","Pdf")}}),e.push({title:"Excel",cssClass:"export-xlsx-button",onClick:function(){t.executeReport("","Xlsx")}}),e.push({title:"Word",cssClass:"export-docx-button",onClick:function(){t.executeReport("","Docx")}}),e},
e=S([In.registerClass("Serenity.Reporting.ReportDialog")],e)}(yr);t.ReportDialog=e;var n=function(t){function n(e){var n=t.call(this,e)||this;$(".report-link").click((function(t){return n.reportLinkClick(t)})),$("div.line").click((function(t){return n.categoryClick(t)}));var i=n;return new hr($("#QuickSearchInput"),{onSearch:function(t,e,n){i.updateMatchFlags(e),n(!0)}}),n}return _(n,t),n.prototype.updateMatchFlags=function(t){var e=$("#ReportList").find("li").removeClass("non-match");if(null==(t=g(t)))return e.children("ul").hide(),void e.show().removeClass("expanded");for(var n=t.replace(","," ").split(" "),i=0;i<n.length;i++)n[i]=g(Select2.util.stripDiacritics(n[i]).toUpperCase());var r=e.filter(".report-item");r.each((function(t,e){for(var i,r=$(e),o=Select2.util.stripDiacritics((null!==(i=r.text())&&void 0!==i?i:"").toUpperCase()),a=0;a<n.length;a++){var l=n[a];if(null!=l&&-1===o.indexOf(l)){r.addClass("non-match");break}}}));var o=r.not(".non-match"),a=o.parents("li").add(o)
;e.not(a).hide().addClass("non-match"),a.show(),a.length<=100&&(e.children("ul").show(),e.addClass("expanded"))},n.prototype.categoryClick=function(t){var e=$(t.target).closest("li");e.hasClass("expanded")?(e.find("ul").hide("fast"),e.removeClass("expanded"),e.find("li").removeClass("expanded")):(e.addClass("expanded"),e.children("ul").show("fast"),1!==e.children("ul").children("li").length||e.children("ul").children("li").hasClass("expanded")||e.children("ul").children("li").children(".line").click())},n.prototype.reportLinkClick=function(t){t.preventDefault();new e({reportKey:$(t.target).data("key")})},n=S([In.registerClass("Serenity.Reporting.ReportPage")],n)}(vi);t.ReportPage=n}(co||(co={}));var bo,Co=function(t){function e(e,n){return t.call(this,e,n)||this}return _(e,t),e.prototype.getLookupKey=function(){var e;return null!==(e=this.options.lookupKey)&&void 0!==e?e:t.prototype.getLookupKey.call(this)},e=S([In.registerEditor("Serenity.AsyncLookupEditor",[si,ai,ui,li])],e)
}(Zi),wo=function(){function t(){}return t=S([In.registerClass("Serenity.ScriptContext")],t)}(),_o=function(){function t(){}return t=S([In.registerInterface("Serenity.IAsyncInit")],t)}();!function(t){t.getWidget=function(t,e){return t.getWidget(e)},t.getWidgetName=vi.getWidgetName,t.hasOriginalEvent=function(t){return!(void 0===t.originalEvent)},t.change=function(t,e){t.change(e)},t.changeSelect2=function(t,e){t.changeSelect2(e)},t.getGridField=function(t){return t.getGridField()}}(bo||(bo={}));var So,ko=function(t){function e(e,n){var i,r,o,a,l,u,c,d=t.call(this,e,n)||this,p=null!==(i=new google.m)&&void 0!==i?i:s.LatLng(null!==(r=d.options.latitude)&&void 0!==r?r:0,null!==(o=d.options.longitude)&&void 0!==o?o:0),h=new Object;if(h.center=p,h.mapTypeId=null!==(a=d.options.mapTypeId)&&void 0!==a?a:"roadmap",h.zoom=null!==(l=d.options.zoom)&&void 0!==l?l:15,h.zoomControl=!0,d.map=new google.maps.Map(e[0],h),null!=d.options.markerTitle){var f=new Object,g=d.options.markerLatitude
;null==g&&(g=null!==(u=d.options.latitude)&&void 0!==u?u:0);var m=d.options.markerLongitude;null==m&&(m=null!==(c=d.options.longitude)&&void 0!==c?c:0),f.position=new google.maps.LatLng(g,m),f.map=d.map,f.title=d.options.markerTitle,f.animation=2,new google.maps.Marker(f)}return We.executeOnceWhenShown(e,(function(){google.maps.event.trigger(d.map,"resize",[]),d.map.setCenter(p)})),d}return _(e,t),e.prototype.get_map=function(){return this.map},e=S([In.registerEditor("Serenity.GoogleMap",[]),In.element("<div/>")],e)}(vi),Io=function(t){function e(e,n){var i=t.call(this,e,n)||this;i.pageSize=50;var r=i.emptyItemText();return null!=r&&e.attr("placeholder",r),e.select2(i.getSelect2Options()),e.attr("type","text"),e.on("change."+i.uniqueName,(function(t,n){!bo.hasOriginalEvent(t)&&n||null!=xi.getValidator(e)&&e.valid()})),i}return _(e,t),e.prototype.emptyItemText=function(){var t=this.element.attr("placeholder");return null==t&&(t=v("Controls.SelectEditor.EmptyItemText")),t},
e.prototype.getService=function(){throw new Error("Not implemented!")},e.prototype.query=function(t,e){var n={blockUI:!1,service:this.getService()+"/List",request:t,onSuccess:function(t){e(t)}};this.executeQuery(n)},e.prototype.executeQuery=function(t){oe(t)},e.prototype.queryByKey=function(t,e){var n={blockUI:!1,service:this.getService()+"/Retrieve",request:{EntityId:t},onSuccess:function(t){e(t.Entity)}};this.executeQueryByKey(n)},e.prototype.executeQueryByKey=function(t){oe(t)},e.prototype.getItemKey=function(t){return null},e.prototype.getItemText=function(t){return null},e.prototype.getTypeDelay=function(){return 200},e.prototype.getSelect2Options=function(){var t=this,e=this.emptyItemText(),n=0;return{minimumResultsForSearch:10,placeHolder:l(e)?null:e,allowClear:T(e),query:function(e){var i={ContainsText:g(e.term),Skip:(e.page-1)*t.pageSize,Take:t.pageSize+1};0!==n&&window.clearTimeout(n);var r=$(t.element).data("select2")
;r&&r.search&&r.search.removeClass("select2-active").parent().removeClass("select2-active"),n=window.setTimeout((function(){r&&r.search.addClass("select2-active").parent().addClass("select2-active"),t.query(i,(function(n){e.callback({results:n.Entities.slice(0,t.pageSize).map((function(e){return{id:t.getItemKey(e),text:t.getItemText(e),source:e}})),more:n.Entities.length>=t.pageSize})}))}),t.getTypeDelay())},initSelection:function(e,n){var i=e.val();l(i)?n(null):t.queryByKey(i,(function(e){n(null==e?null:{id:t.getItemKey(e),text:t.getItemText(e),source:e})}))}}},e.prototype.addInplaceCreate=function(t){var e=this;$("<a><b/></a>").addClass("inplace-button inplace-create").attr("title",t).insertAfter(this.element).click((function(t){e.inplaceCreateClick(t)})),this.get_select2Container().add(this.element).addClass("has-inplace-button")},e.prototype.inplaceCreateClick=function(t){},e.prototype.get_select2Container=function(){return this.element.prevAll(".select2-container")},
e.prototype.get_value=function(){return G(this.element.select2("val"),String)},Object.defineProperty(e.prototype,"value",{get:function(){return this.get_value()},set:function(t){this.set_value(t)},enumerable:!1,configurable:!0}),e.prototype.set_value=function(t){if(t!==this.get_value()){var e=this.element;e.select2("val",t),e.data("select2-change-triggered",!0);try{e.triggerHandler("change",[!0])}finally{e.data("select2-change-triggered",!1)}}},e=S([In.registerEditor("Serenity.Select2AjaxEditor",[ui]),In.element('<input type="hidden" />')],e)}(vi),xo={__proto__:null,IBooleanValue:ni,IDoubleValue:ii,IDialog:ri,IEditDialog:oi,IGetEditValue:ai,IReadOnly:li,ISetEditValue:si,IStringValue:ui,IValidateRequired:ci,ISlickFormatter:ct,EnumKeyAttribute:gn,DisplayNameAttribute:mn,CategoryAttribute:yn,ColumnsKeyAttribute:vn,CssClassAttribute:bn,DefaultValueAttribute:Cn,DialogTypeAttribute:wn,EditorAttribute:_n,EditorOptionAttribute:Sn,EditorTypeAttributeBase:kn,EditorTypeAttribute:xn,
ElementAttribute:Tn,EntityTypeAttribute:Fn,FilterableAttribute:Pn,FlexifyAttribute:On,FormKeyAttribute:Dn,GeneratedCodeAttribute:En,HiddenAttribute:$n,HintAttribute:An,IdPropertyAttribute:Nn,InsertableAttribute:Bn,IsActivePropertyAttribute:Vn,ItemNameAttribute:Mn,LocalTextPrefixAttribute:Rn,MaximizableAttribute:Ln,MaxLengthAttribute:qn,NamePropertyAttribute:Gn,OneWayAttribute:zn,OptionAttribute:Hn,OptionsTypeAttribute:jn,PanelAttribute:Un,PlaceholderAttribute:Wn,ReadOnlyAttribute:Kn,RequiredAttribute:Qn,ResizableAttribute:Yn,ResponsiveAttribute:Jn,ServiceAttribute:Xn,UpdatableAttribute:Zn,get Decorators(){return In},get Criteria(){return di},get ReflectionUtils(){return ti},get DialogTypeRegistry(){return ei},get EditorTypeRegistry(){return hi},get EnumTypeRegistry(){return fi},PrefixedContext:mi,reactPatch:yi,Widget:vi,TemplatedWidget:wi,get LazyLoadHelper(){return We},get SubDialogHelper(){return bi},get UploadHelper(){return Ci},PopupMenuButton:Si,PopupToolButton:ki,Toolbar:Ii,
get EditorUtils(){return _i},CascadedWidgetLink:Fi,get ValidationHelper(){return xi},get VX(){return Ti},TemplatedPanel:Di,get TabsExtensions(){return Pi},get ReflectionOptionsSetter(){return Oi},PropertyGrid:Ei,PropertyPanel:$i,StringEditor:Ai,PasswordEditor:Ni,TextAreaEditor:Bi,BooleanEditor:Vi,DecimalEditor:Mi,IntegerEditor:Ri,datePickerIconSvg:Li,DateEditor:qi,DateTimeEditor:zi,TimeEditor:Hi,EmailEditor:ji,EmailAddressEditor:Ui,URLEditor:Wi,RadioButtonEditor:Ki,Select2Editor:Qi,SelectEditor:Yi,DateYearEditor:Ji,EnumEditor:Xi,LookupEditorBase:Zi,LookupEditor:tr,ServiceLookupEditorBase:er,ServiceLookupEditor:nr,HtmlContentEditor:ir,HtmlNoteContentEditor:rr,HtmlReportContentEditor:or,MaskedEditor:ar,Recaptcha:lr,FileUploadEditor:sr,ImageUploadEditor:ur,MultipleFileUploadEditor:cr,MultipleImageUploadEditor:dr,QuickFilterBar:pr,QuickSearchInput:hr,get DialogExtensions(){return fr},TemplatedDialog:yr,PropertyDialog:vr,EntityDialog:br,get FilterOperators(){return mr},FilterStore:Cr,
IFiltering:wr,IQuickFiltering:_r,BaseFiltering:Sr,BaseEditorFiltering:xr,DateFiltering:Tr,BooleanFiltering:Fr,DateTimeFiltering:Pr,DecimalFiltering:Or,EditorFiltering:Dr,EnumFiltering:Er,IntegerFiltering:$r,LookupFiltering:Ar,ServiceLookupFiltering:Nr,StringFiltering:Br,get FilteringTypeRegistry(){return Ir},FilterWidgetBase:Vr,FilterPanel:Lr,FilterDialog:qr,FilterDisplayBar:Gr,SlickPager:zr,GridRowSelectionMixin:so,GridRadioSelectionMixin:uo,get GridSelectAllButtonHelper(){return no},get GridUtils(){return io},get PropertyItemSlickConverter(){return ro},get SlickFormatting(){return oo},get SlickHelper(){return ao},get SlickTreeHelper(){return lo},IInitializeColumn:Hr,BooleanFormatter:Wr,CheckboxFormatter:Kr,DateFormatter:Qr,DateTimeFormatter:Yr,EnumFormatter:Jr,FileDownloadFormatter:Xr,MinuteFormatter:Zr,NumberFormatter:to,UrlFormatter:eo,get FormatterTypeRegistry(){return Ur},DataGrid:ho,ColumnPickerDialog:fo,EntityGrid:go,TreeGridMixin:mo,CheckTreeEditor:yo,CheckLookupEditor:vo,
get Reporting(){return co},AsyncLookupEditor:Co,ScriptContext:wo,IAsyncInit:_o,get WX(){return bo},Flexify:gr,GoogleMap:ko,Select2AjaxEditor:Io};!function(t){t.Avg=function(t){this.field_=t,this.init=function(){this.count_=0,this.nonNullCount_=0,this.sum_=0},this.accumulate=function(t){var e=t[this.field_];this.count_++,null==e||""===e||isNaN(e)||(this.nonNullCount_++,this.sum_+=parseFloat(e))},this.storeResult=function(t){t.avg||(t.avg={}),0!=this.nonNullCount_&&(t.avg[this.field_]=this.sum_/this.nonNullCount_)}},t.WeightedAvg=function(t,e){this.field_=t,this.weightedField_=e,this.init=function(){this.sum_=0,this.weightedSum_=0},this.accumulate=function(t){var e=t[this.field_],n=t[this.weightedField_];this.isValid(e)&&this.isValid(n)&&(this.weightedSum_+=parseFloat(n),this.sum_+=parseFloat(e)*parseFloat(n))},this.storeResult=function(t){t.avg||(t.avg={}),this.sum_&&this.weightedSum_&&(t.avg[this.field_]=this.sum_/this.weightedSum_)},this.isValid=function(t){
return null!==t&&""!==t&&!isNaN(t)}},t.Min=function(t){this.field_=t,this.init=function(){this.min_=null},this.accumulate=function(t){var e=t[this.field_];null==e||""===e||isNaN(e)||(null==this.min_||e<this.min_)&&(this.min_=e)},this.storeResult=function(t){t.min||(t.min={}),t.min[this.field_]=this.min_}},t.Max=function(t){this.field_=t,this.init=function(){this.max_=null},this.accumulate=function(t){var e=t[this.field_];null==e||""===e||isNaN(e)||(null==this.max_||e>this.max_)&&(this.max_=e)},this.storeResult=function(t){t.max||(t.max={}),t.max[this.field_]=this.max_}},t.Sum=function(t){this.field_=t,this.init=function(){this.sum_=null},this.accumulate=function(t){var e=t[this.field_];null==e||""===e||isNaN(e)||(this.sum_+=parseFloat(e))},this.storeResult=function(t){t.sum||(t.sum={}),t.sum[this.field_]=this.sum_}}}(So||(So={}));var To={__proto__:null,get Aggregators(){return So},RemoteView:po};"function"==typeof jQuery&&function(t){function e(){
if(void 0===t||!t.ui||!t.ui.dialog||!t.ui.dialog.prototype)return!1;var e;t.ui.dialog.prototype._allowInteraction=function(e){return!!t(e.target).closest(".ui-dialog").length||!!t(e.target).closest(".ui-datepicker, .select2-drop, .cke, .cke_dialog, .modal, #support-modal").length},e=t.ui.dialog.prototype._focusTabbable,t.ui.dialog.prototype._focusTabbable=function(){t(document.documentElement).hasClass("mobile-device")?this.uiDialog&&this.uiDialog.focus():e.call(this)},function(e){t.ui.dialog.prototype._createTitlebar=function(){e.call(this),this.uiDialogTitlebar.find(".ui-dialog-titlebar-close").html('<i class="fa fa-times" />')}}(t.ui.dialog.prototype._createTitlebar)}var n;!e()&&void 0!==t&&t.fn&&t(e),void 0!==t&&t.fn&&(t.toJSON||(t.toJSON=JSON.stringify),t.parseJSON||(t.parseJSON=JSON.parse),t.cleanData=(n=t.cleanData,function(e){var i,r,o,a=e;for(o=0;null!=(r=a[o]);o++)try{(i=t._data(r,"events"))&&i.remove&&(a===e&&(a=Array.prototype.slice.call(e)),t(r).triggerHandler("remove"),
delete i.remove)}catch(t){}n(e)}))}(jQuery),"undefined"==typeof Promise&&("undefined"!=typeof RSVP?Promise=RSVP:"undefined"!=typeof $&&(Promise=$.Deferred,Promise.resolve=function(t){return $.Deferred().resolveWith(t)})),"function"==typeof Vue&&function(t){function e(){return void 0!==t&&(t.component("editor",{props:{type:{type:String,required:!0},id:{type:String,required:!1},name:{type:String,required:!1},placeholder:{type:String,required:!1},value:{required:!1},options:{required:!1},maxLength:{required:!1}},render:function(t){for(var e=hi.get(this.type),n=j(e,Tn,!0),i=n.length>0?n[0].value:"<input/>",r={},o=$(i)[0],a=o.attributes,l=0;l<a.length;l++){var s=a.item(l);r[s.name]=s.value}null!=this.id&&(r.id=this.id),null!=this.name&&(r.name=this.name),null!=this.placeholder&&(r.placeholder=this.placeholder);var u=t(o.tagName,{domProps:r});return this.$editorType=e,u},watch:{value:function(t){_i.setValue(this.$widget,t)}},mounted:function(){var t=this
;if(this.$widget=new this.$editorType($(this.$el),this.options),this.$widget.initialize(),this.maxLength){var e=this.$widget;e.element.is(":input")&&(this.maxLength>0?e.element.attr("maxlength",this.maxLength):e.element.removeAttr("maxlength"))}this.options&&Oi.set(this.$widget,this.options),null!=this.value&&_i.setValue(this.$widget,this.value),$(this.$el).data("select2")?this.$widget.changeSelect2((function(){t.$emit("input",_i.getValue(t.$widget))})):this.$widget.change((function(){t.$emit("input",_i.getValue(t.$widget))}))},destroyed:function(){this.$widget&&(this.$widget.destroy(),this.$widget=null)}}),!0)}!e()&&"undefined"!=typeof $&&$.fn&&$(e)}(Vue),t.Q=t.Q||{},P(t.Q,hn),t.Serenity=t.Serenity||{},P(t.Serenity,xo),t.Slick=t.Slick||{},P(t.Slick,To),t.__asyncDelegator=t.__asyncDelegator||function(t){var e,n;return e={},i("next"),i("throw",(function(t){throw t})),i("return"),e[Symbol.iterator]=function(){return this},e;function i(i,r){e[i]=t[i]?function(e){return(n=!n)?{
value:x(t[i](e)),done:"return"===i}:r?r(e):e}:r}},t.__asyncGenerator=t.__asyncGenerator||function(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(t,e||[]),o=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(t){r[t]&&(i[t]=function(e){return new Promise((function(n,i){o.push([t,e,n,i])>1||l(t,e)}))})}function l(t,e){try{(n=r[t](e)).value instanceof x?Promise.resolve(n.value.v).then(s,u):c(o[0][2],n)}catch(t){c(o[0][3],t)}var n}function s(t){l("next",t)}function u(t){l("throw",t)}function c(t,e){t(e),o.shift(),o.length&&l(o[0][0],o[0][1])}},t.__asyncValues=t.__asyncValues||function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=k(t),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(n){e[n]=t[n]&&function(e){
return new Promise((function(i,r){(function(t,e,n,i){Promise.resolve(i).then((function(e){t({value:e,done:n})}),e)})(i,r,(e=t[n](e)).done,e.value)}))}}},t.__await=t.__await||x,t.__awaiter=t.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function a(t){try{s(i.next(t))}catch(t){o(t)}}function l(t){try{s(i.throw(t))}catch(t){o(t)}}function s(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,l)}s((i=i.apply(t,e||[])).next())}))},t.__classPrivateFieldGet=t.__classPrivateFieldGet||function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)},t.__classPrivateFieldSet=t.__classPrivateFieldSet||function(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n},t.__createBinding=t.__createBinding||function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]},t.__decorate=t.__decorate||S,t.__exportStar=t.__exportStar||function(t,e){
for(var n in t)"default"===n||e.hasOwnProperty(n)||(e[n]=t[n])},t.__extends=t.__extends||_,t.__generator=t.__generator||function(t,e){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){
a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}},t.__importDefault=t.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},t.__importStar=t.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e},t.__makeTemplateObject=t.__makeTemplateObject||function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},t.__metadata=t.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},t.__param=t.__param||function(t,e){return function(n,i){e(n,i,t)}},t.__read=t.__read||I,t.__rest=t.__rest||function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i])
;if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n},t.__spread=t.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(I(arguments[e]));return t},t.__spreadArrays=t.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,l=o.length;a<l;a++,r++)i[r]=o[a];return i},t.__values=t.__values||k,Object.defineProperty(t,"__esModule",{value:!0})}(this.window=this.window||{});